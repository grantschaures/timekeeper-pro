import{pomodoroNotificationToggle,pomodoroInputs,autoStartPomodoroIntervalToggle,autoStartBreakIntervalToggle,pomodoroVolumeThumb,pomodoroVolumeThumb2,pomodoroRadios,flowmodoroNotificationToggle,flowmodoroInputs,flowmodoroVolumeThumb,flowmodoroVolumeThumb2,flowmodoroRadios,breakSuggestionToggle,suggestionMinutesInput,generalRadios,targetTimeReachedToggle,darkGrayTheme,defaultTheme,interruptionsContainer,targetHoursContainer,timekeepingContainer,progressBarContainer,popupMenu,settingsContainer,notesContainer,aboutContainer,blogContainer,emojiContainer,flowTimeAnimationToggle,chillTimeAnimationToggle,transitionClockSoundToggle}from"../modules/dom-elements.js";import{sessionState}from"../modules/state-objects.js";import{flags,timeAmount,alertVolumes,alertSounds,selectedBackgroundId,selectedBackground,flowtimeBackgrounds,chilltimeBackgrounds,selectedBackgroundIdTemp}from"../modules/index-objects.js";import{flags as notesflags}from"../modules/notes-objects.js";import{setInitialBackgroundCellSelection,setBackground,deactivateDarkTheme}from"../main/index.js";function checkUserSession(){fetch("/api/state/sessionValidation",{method:"POST",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{e.isLoggedIn&&(sessionState.loggedIn=!0,updateGUIForLoggedInUser(e.user))}).catch(e=>console.error("Error validating user session:",e))}function updateGUIForLoggedInUser(e){updateMenuContainer(e),updateAccountSettingsTab(e),updateSettings(e)}function updateMenuContainer(e){document.getElementById("loginIcon").style.display="none",document.getElementById("logoutIcon").style.display="flex",document.getElementById("logInOutBtn").innerText="Log Out"}function updateAccountSettingsTab(e){["noAccountText","accountOr1","settingsGoogleLogin","accountOr2","emailPasswordLoginMainContainer","loginBtnContainer"].forEach(e=>document.getElementById(e).style.display="none"),["userEmailContainer","logoutBtnContainer"].forEach(e=>document.getElementById(e).style.display="flex"),document.getElementById("userEmail").innerText=e.email}function updateSettings(e){updatePomodoro(e),updateChillTime(e),updateFlowTime(e),updateBackgroundsThemes(e),updateNotes(e),updateSounds(e)}function updatePomodoro(e){updatePomodoroNotificationToggle(e),updatePomodoroIntervalArr(e),updateAutoStartIntervals(e),updatePomodoroAlertVolume(e),updatePomodoroAlertSound(e)}function updatePomodoroNotificationToggle(e){e=e.settings.pomodoro.notificationToggle;flags.pomodoroNotificationToggle=e,pomodoroNotificationToggle.checked=e}function updatePomodoroIntervalArr(e){const t=e.settings.pomodoro["intervalArr"];timeAmount.pomodoroIntervalArr=t,pomodoroInputs.forEach((e,o)=>{e.value=t[o]})}function updateAutoStartIntervals(e){var{autoStartPomToggle:e,autoStartBreakToggle:o}=e.settings.pomodoro;flags.autoStartPomodoroInterval=e,autoStartPomodoroIntervalToggle.checked=e,flags.autoStartBreakInterval=o,autoStartBreakIntervalToggle.checked=o}function updatePomodoroAlertVolume(e){e=e.settings.pomodoro.alertVolume;alertVolumes.pomodoro=e,pomodoroVolumeThumb.style.left=100*e+"%",pomodoroVolumeThumb2.style.left=100*e+"%"}function updatePomodoroAlertSound(e){e=e.settings.pomodoro.alertSound;"none"===(alertSounds.pomodoro=e)?(pomodoroRadios[0].checked=!0,pomodoroRadios[3].checked=!0):"chime"===e?(pomodoroRadios[1].checked=!0,pomodoroRadios[4].checked=!0):"bell"===e&&(pomodoroRadios[2].checked=!0,pomodoroRadios[5].checked=!0)}function updateChillTime(e){updateChillTimeNotificationToggle(e),updateChillTimeIntervalArr(e),updateChillTimeAlertVolume(e),updateChillTimeAlertSound(e)}function updateChillTimeNotificationToggle(e){e=e.settings.chillTime.notificationToggle;flags.flowmodoroNotificationToggle=e,flowmodoroNotificationToggle.checked=e}function updateChillTimeIntervalArr(e){const t=e.settings.chillTime["intervalArr"];timeAmount.breakTimeSuggestionsArr=t,flowmodoroInputs.forEach((e,o)=>{e.value=t[o]})}function updateChillTimeAlertVolume(e){e=e.settings.chillTime.alertVolume;alertVolumes.flowmodoro=e,flowmodoroVolumeThumb.style.left=100*e+"%",flowmodoroVolumeThumb2.style.left=100*e+"%"}function updateChillTimeAlertSound(e){e=e.settings.chillTime.alertSound;"none"===(alertSounds.flowmodoro=e)?(flowmodoroRadios[0].checked=!0,flowmodoroRadios[3].checked=!0):"chime"===e?(flowmodoroRadios[1].checked=!0,flowmodoroRadios[4].checked=!0):"bell"===e&&(flowmodoroRadios[2].checked=!0,flowmodoroRadios[5].checked=!0)}function updateFlowTime(e){updateFlowTimeNotificationToggle(e),updateSuggestionMinutes(e),updateFlowTimeAlertVolume(e),updateFlowTimeAlertSound(e),updateTargetTimeReachedToggle(e,targetTimeReachedToggle)}function updateFlowTimeNotificationToggle(e){e=e.settings.flowTime.notificationToggle;flags.breakSuggestionToggle=e,breakSuggestionToggle.checked=e}function updateSuggestionMinutes(e){e=e.settings.flowTime.suggestionMinutes;timeAmount.suggestionMinutes=e,suggestionMinutesInput.value=e}function updateFlowTimeAlertVolume(e){e=e.settings.flowTime.alertVolume;alertVolumes.general=e,generalVolumeThumb.style.left=100*e+"%",generalVolumeThumb2.style.left=100*e+"%"}function updateFlowTimeAlertSound(e){e=e.settings.flowTime.alertSound;"none"===(alertSounds.general=e)?(generalRadios[0].checked=!0,generalRadios[3].checked=!0):"chime"===e?(generalRadios[1].checked=!0,generalRadios[4].checked=!0):"bell"===e&&(generalRadios[2].checked=!0,generalRadios[5].checked=!0)}function updateTargetTimeReachedToggle(e,o){e=e.settings.flowTime.targetTimeReachedToggle;flags.targetReachedToggle=e,o.checked=e}function updateBackgroundsThemes(e){updateBackgrounds(e),updateThemes(e),updateAnimations(e)}function updateBackgrounds(e){var{flowTimeBackground:e,chillTimeBackground:o}=e.settings.backgroundsThemes;selectedBackgroundId.flowtime=e,selectedBackground.flowtime=flowtimeBackgrounds[e],selectedBackgroundId.chilltime=o,selectedBackground.chilltime=chilltimeBackgrounds[o],setBackground(selectedBackground.flowtime),setBackground(selectedBackground.chilltime),document.getElementById("green-default").classList.remove("selected-background"),document.getElementById("blue-default").classList.remove("selected-background"),setInitialBackgroundCellSelection()}function updateThemes(e){e=e.settings.backgroundsThemes.darkThemeActivated;flags.darkThemeActivated=e,flags.darkThemeActivated||(darkGrayTheme.classList.remove("selected-background"),defaultTheme.classList.add("selected-background"),deactivateDarkTheme(interruptionsContainer,targetHoursContainer,timekeepingContainer,progressBarContainer,popupMenu,settingsContainer,notesContainer,aboutContainer,blogContainer,selectedBackgroundIdTemp,selectedBackgroundId,emojiContainer))}function updateAnimations(e){var{flowTimeAnimation:e,chillTimeAnimation:o}=e.settings.backgroundsThemes;flags.flowTimeAnimationToggle=e,flowTimeAnimationToggle.checked=e,flags.chillTimeAnimationToggle=o,chillTimeAnimationToggle.checked=o}function updateNotes(e){updateAutoSwitchToggle(e)}function updateAutoSwitchToggle(e){e=e.settings.notes.autoSwitchToggle;notesflags.transitionNotesAutoSwitchToggle=e,transitionNotesAutoSwitchToggle.checked=e}function updateSounds(e){updateTransitionClockSound(e)}function updateTransitionClockSound(e){e=e.settings.sounds.transitionClockSound;flags.transitionClockSoundToggle=e,transitionClockSoundToggle.checked=e}document.addEventListener("defaultSettingsApplied",()=>{checkUserSession()});