import{pomodoroNotificationToggle as t,pomodoroInputs as n,autoStartPomodoroIntervalToggle as o,autoStartBreakIntervalToggle as a,pomodoroVolumeThumb as s,pomodoroVolumeThumb2 as i,pomodoroRadios as l,flowmodoroNotificationToggle as c,flowmodoroInputs as d,flowmodoroVolumeThumb as r,flowmodoroVolumeThumb2 as M,flowmodoroRadios as m,breakSuggestionToggle as D,suggestionMinutesInput as U,generalRadios as g,targetTimeReachedToggle as F,darkGrayTheme as u,defaultTheme as f,interruptionsContainer as h,targetHoursContainer as k,timekeepingContainer as T,progressBarContainer as p,popupMenu as b,settingsContainer as I,notesContainer as v,aboutContainer as C,blogContainer as y,emojiContainer as E,flowTimeAnimationToggle as G,chillTimeAnimationToggle as q,transitionClockSoundToggle as H,labelSelectionRow as B,emojiImg as z,emojiImg2 as J,dynamicList as K,propagateUnfinishedTasksToggle as Q,blackFlowtimeBackground as W,blackChilltimeBackground as X}from"../modules/dom-elements.js";import{sessionState as Y}from"../modules/state-objects.js";import{flags as S,timeAmount as w,alertVolumes as A,alertSounds as L,selectedBackgroundId as j,selectedBackground as N,flowtimeBackgrounds as Z,chilltimeBackgrounds as $,selectedBackgroundIdTemp as x}from"../modules/index-objects.js";import{flags as V,counters as P,state as R,labelDict as O,notesArr as _}from"../modules/notes-objects.js";import{setInitialBackgroundCellSelection as ee,setBackground as e,deactivateDarkTheme as te,activateDarkTheme as oe}from"../main/index.js";import{appendEditRemoveContainer as ne,createCheckElements as ae,getLastNumberFromId as se}from"../main/notes.js";var ie=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);function le(){fetch("/api/state/sessionValidation",{method:"POST",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{e.isLoggedIn&&(Y.loggedIn=!0,ce(e.user,e.note))}).catch(e=>{})}function ce(e,t){de(e),re(e),me(e),De(t),Ue(t)}function de(e){document.getElementById("loginIcon").style.display="none",document.getElementById("logoutIcon").style.display="flex",document.getElementById("logInOutBtn").innerText="Log Out"}function re(e){["noAccountText","accountOr1","settingsGoogleLogin","accountOr2","emailPasswordLoginMainContainer","loginBtnContainer"].forEach(e=>document.getElementById(e).style.display="none"),["userEmailContainer","logoutBtnContainer"].forEach(e=>document.getElementById(e).style.display="flex"),document.getElementById("userEmail").innerText=e.email}function me(e){ge(e),pe(e),ye(e),Le(e),Ve(e),Oe(e)}function ge(e){ue(e),fe(e),he(e),ke(e),Te(e)}function ue(e){e=e.settings.pomodoro.notificationToggle;S.pomodoroNotificationToggle=e,t.checked=e}function fe(e){let o=e.settings.pomodoro["intervalArr"];w.pomodoroIntervalArr=o,n.forEach((e,t)=>{e.value=o[t]})}function he(e){var{autoStartPomToggle:e,autoStartBreakToggle:t}=e.settings.pomodoro;S.autoStartPomodoroInterval=e,o.checked=e,S.autoStartBreakInterval=t,a.checked=t}function ke(e){e=e.settings.pomodoro.alertVolume;A.pomodoro=e,s.style.left=100*e+"%",i.style.left=100*e+"%"}function Te(e){e=e.settings.pomodoro.alertSound;"none"===(L.pomodoro=e)?(l[0].checked=!0,l[3].checked=!0):"chime"===e?(l[1].checked=!0,l[4].checked=!0):"bell"===e&&(l[2].checked=!0,l[5].checked=!0)}function pe(e){be(e),Ie(e),ve(e),Ce(e)}function be(e){e=e.settings.chillTime.notificationToggle;S.flowmodoroNotificationToggle=e,c.checked=e}function Ie(e){let o=e.settings.chillTime["intervalArr"];w.breakTimeSuggestionsArr=o,d.forEach((e,t)=>{e.value=o[t]})}function ve(e){e=e.settings.chillTime.alertVolume;A.flowmodoro=e,r.style.left=100*e+"%",M.style.left=100*e+"%"}function Ce(e){e=e.settings.chillTime.alertSound;"none"===(L.flowmodoro=e)?(m[0].checked=!0,m[3].checked=!0):"chime"===e?(m[1].checked=!0,m[4].checked=!0):"bell"===e&&(m[2].checked=!0,m[5].checked=!0)}function ye(e){Ee(e),Be(e),Se(e),we(e),Ae(e,F)}function Ee(e){e=e.settings.flowTime.notificationToggle;S.breakSuggestionToggle=e,D.checked=e}function Be(e){e=e.settings.flowTime.suggestionMinutes;w.suggestionMinutes=e,U.value=e}function Se(e){e=e.settings.flowTime.alertVolume;A.general=e,generalVolumeThumb.style.left=100*e+"%",generalVolumeThumb2.style.left=100*e+"%"}function we(e){e=e.settings.flowTime.alertSound;"none"===(L.general=e)?(g[0].checked=!0,g[3].checked=!0):"chime"===e?(g[1].checked=!0,g[4].checked=!0):"bell"===e&&(g[2].checked=!0,g[5].checked=!0)}function Ae(e,t){e=e.settings.flowTime.targetTimeReachedToggle;S.targetReachedToggle=e,t.checked=e}function Le(e){je(e),Ne(e),xe(e)}function je(e){var{flowTimeBackground:e,chillTimeBackground:t}=e.settings.backgroundsThemes;j.flowtime=e,N.flowtime=Z[e],j.chilltime=t,N.chilltime=$[t],document.getElementById("green-default").classList.remove("selected-background"),document.getElementById("blue-default").classList.remove("selected-background"),ee()}function Ne(e){e=e.settings.backgroundsThemes.darkThemeActivated;S.darkThemeActivated=e,S.darkThemeActivated?(u.classList.add("selected-background"),f.classList.remove("selected-background"),oe(h,k,T,p,b,I,v,C,y,W,X,x,j,E)):(u.classList.remove("selected-background"),f.classList.add("selected-background"),te(h,k,T,p,b,I,v,C,y,x,j,E,ie))}function xe(e){var{flowTimeAnimation:e,chillTimeAnimation:t}=e.settings.backgroundsThemes;S.flowTimeAnimationToggle=e,G.checked=e,S.chillTimeAnimationToggle=t,q.checked=t}function Ve(e){Pe(e),Re(e)}function Pe(e){e=e.settings.notes.autoSwitchToggle;V.transitionNotesAutoSwitchToggle=e,transitionNotesAutoSwitchToggle.checked=e}function Re(e){e=e.settings.notes.propagateUnfinishedTasksToggle;V.propagateUnfinishedTasksToggle=e,Q.checked=e}function Oe(e){Me(e)}function Me(e){e=e.settings.sounds.transitionClockSound;S.transitionClockSoundToggle=e,H.checked=e}function De(e){var t,o,n=B.getElementsByClassName("selection-tag");Array.from(n).forEach(e=>{e.remove(),delete O[e.id]});for([t,o]of Object.entries(e.labels).reverse()){var a=document.createElement("div"),s=(a.id=t,a.className="tag unselectable selection-tag",document.createElement("h4"));s.className="tag-text",s.textContent=o,a.appendChild(s),B.insertBefore(a,B.firstChild),O[a.id]=s.textContent}P.lastLabelIdNum=e.lastLabelIdNum,R.lastSelectedEmojiId=e.lastSelectedEmojiId;n=document.getElementById(R.lastSelectedEmojiId).src;z.src=n,J.src=n}function Ue(e){var t=e.noteTasks;for(let e=0;e<t.length;e++){var o=document.createElement("div"),n=t[e].id,n=(o.id=n,o.setAttribute("data-testid",n),se(o.id)),a=t[e].classList;for(let e=0;e<a.length;e++)o.classList.add(a[e]);a.includes("task")&&(i=ae({lastTaskInputIdNum:n}),o.appendChild(i),i=o.querySelector("#"+("check"+n)),s=o.firstElementChild,t[e].classList.includes("completed-task"))&&(s.style.backgroundColor="#3ba43e",i.setAttribute("stroke-width","3"),i.parentElement.parentElement.style.opacity="1",o.classList.add("completed-task"));var s=document.createElement("span"),i=(s.textContent=t[e].content,"spanText"+n),n=(s.setAttribute("data-testid",i),o.appendChild(s),ne("Task",n)),n=(o.appendChild(n),K.appendChild(o),{id:o.id,classList:[...o.classList],content:s.textContent,date:t[e].date});_.push(n)}P.lastTaskInputIdNum=e.lastTaskInputIdNum}document.addEventListener("defaultSettingsApplied",()=>{le()});