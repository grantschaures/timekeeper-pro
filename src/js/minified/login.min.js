import{initializeGUI as n}from"../utility/initialize-gui.js";import{userAgent as i,userDevice as r,userTimeZone as s}from"../utility/identification.js";function a(e){"Enter"===e.key&&"passwordInput"===document.activeElement.id&&(e.preventDefault(),loginSubmitBtn.click())}function o(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("loginSubmitBtn"),t=document.getElementById("forgotPassword_h3"),n=document.getElementById("createAccount2_h3");e.addEventListener("click",async function(){var e=document.getElementById("emailInputSignin").value,t=document.getElementById("passwordInput").value;o(e)?addUser(e,t):alert("Invalid email address. Please try again.")}),n.addEventListener("click",async function(){window.location.href="/signup"}),t.addEventListener("click",function(){window.location.href="/reset-password"}),document.addEventListener("keydown",e=>a(e))}),window.addUser=function(e,t){fetch("/api/api/validateUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{email:e,password:t},userAgent:i,userDevice:r,userTimeZone:s})}).then(t=>{if(t.ok)return t.json();if(429===t.status)return t.json().then(e=>{throw alert(e.message),new Error(`HTTP error! Status: ${t.status} - `+e.message)});throw alert("Your email or password is incorrect. Please try again."),new Error("HTTP error! Status: "+t.status)}).then(e=>{!0===e.loginSuccess&&n()}).catch(e=>{})};