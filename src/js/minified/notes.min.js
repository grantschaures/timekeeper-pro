import{notesContainer,taskContainer,promptContainer,labelInputContainer,createLabelContainer,createLabelWindow,createLabelInput,createLabelDone,createLabelCancel,updateLabelContainer,updateLabelWindow,updateLabelInput,updateLabelCancel,updateLabelDone,labelSelectionWindow,labelSelectionRow,clearIcon,notesBtn,notesConsole,taskPrompt,tagIcon,tagSelection,tagSelectionDivider,addDoneContainer,selectionDoneDiv,selectionDone,addTagIcon,emojiBtn,emojiBtn2,emojiImg,emojiImg2,emojiContainer,emojiSymbols,transitionNotesAutoSwitchToggle,start_stop_btn,tutorialImgContainers,aboutIconNotes,settings_menu_container,notesBtnContainer,notesSettingsHr,addingDeletingUpdatingLabelsInfoBlock,addNoteTaskContainer,noteTaskInputContainer,noteTaskInputText,noteInputCancelBtn,noteInputSaveBtn,taskCheckbox,dynamicList,textarea,settingsContainer,aboutContainer,blogContainer,main_elements,isMobile}from"../modules/dom-elements.js";import{notesFlags,counters,state,flags,emojiMap,tutorialContainerMap,fontSizeArr,fontNumArr}from"../modules/notes-objects.js";import{sessionState}from"../modules/state-objects.js";import{updateUserSettings}from"../modules/update-settings.js";function populateTaskLabelContainer(){var t=["‚úçÔ∏è Homework","üìö Reading","üßò Meditation"];for(let e=0;e<t.length;e++){var n=document.createElement("input");n.value=t[e],createLabel(n,counters,labelSelectionRow,addDoneContainer)}}function hideEmojiContainer(e,t){e.style.display="none",e.style.opacity="0",t.emojiContainerShowing=!1}function showTagSelectionDivider(e,t,n){!1===e.tagSelection&&(t.style.display="flex",n.style.marginLeft="",e.tagSelection=!0)}function replaceEmoji(e,t,n){null!==e.lastSelectedEmojiId&&(e=document.getElementById(e.lastSelectedEmojiId).src,t.src=e,n.src=e)}function createLabel(e,t,n,a){var e="<h4 class='tag-text'>"+e.value+"</h4>",o=document.createElement("div");o.className="tag unselectable selection-tag",o.innerHTML=e,t.lastLabelIdNum+=1,o.id="tag-"+t.lastLabelIdNum,n.insertBefore(o,a)}function checkLabelIsUnique(t){let n=!0;return document.querySelectorAll(".selection-tag").forEach(e=>{e=e.firstElementChild.textContent;e===t.value.trim()&&(alert("The label '"+e+"' already exists!"),n=!1)}),n}function checkIfUpdatedLabelIsUnique(e,t){let n=!0,a=document.getElementById(e.elementToUpdateId).innerText.trim();return document.querySelectorAll(".selection-tag").forEach(e=>{e=e.firstElementChild.textContent;e===t.value.trim()&&a!==t.value.trim()&&(alert("The label '"+e+"' already exists!"),n=!1)}),n}function noteInputSave(t,n,e,a,o,i){var l=a.value;if(""===l)noteInputCancel(t,n,e,a);else{let e;t=document.createElement("div");t.classList.add("noteTask"),e=(o.checked&&(n=createCheckElements(i),t.appendChild(n)),createNote(l,t,i,e)),t.appendChild(e),dynamicList.appendChild(t)}}function addLabelInitialActions(e,t,n,a){!1===e.tagSelected&&(e.tagSelected=!0,t.style.marginLeft="5px",t.classList.add("tagToLeftSide"),n.style.width="100%",a.style.display="flex")}function addLabel(e,t){let n,a;a=("tag-text"===e.className?(n=e.parentElement.id,e.parentElement):(n=e.id,e)).innerHTML,document.getElementById(n).remove();e=document.createElement("div");e.className="tag unselectable selected-tag",e.innerHTML=a,e.id=n,e.firstElementChild.style.backgroundColor="rgba(255, 255, 255, 0.2)",t.appendChild(e)}function addLabelInputContainerTagDivider(e,t){1<e.tagsSelected&&((e=document.createElement("h4")).className="tag-divider unselectable",e.innerText="|",t.append(e))}function adjustLabelFontSize(t,n,a,e){var o=document.querySelectorAll(".selected-tag .tag-text");let i=0;for(;o.forEach(e=>{e.style.fontSize=n[i],t.currentLabelInputTagSize=a[i]}),i++,0<e.scrollWidth-e.clientWidth&&i<9;);}function deleteLabel(e,t,n,a){let o;o=("tag-text deleteJiggling"===e.className?e.parentElement:e).id,document.getElementById(o).remove(),removeTagSelectionDivider(t,n,a)}function removeTagSelectionDivider(e,t,n){e.previousElementSibling||(t.style.display="none",e.style.marginLeft="7px",n.tagSelection=!1)}function createNote(e,t,n,a){var o=document.createElement("span"),e=(o.textContent=e,"spanText"+n.lastTaskInputIdNum),e=(o.setAttribute("data-testid",e),t.appendChild(o),"taskDiv"+n.lastTaskInputIdNum);return t.id=e,t.setAttribute("data-testid",e),a=appendEditRemoveContainer("Task",n.lastTaskInputIdNum),n.lastTaskInputIdNum+=1,a}function createCheckElements(e){var t=document.createElement("div"),n=(t.classList.add("taskCircularCheck"),document.createElement("div")),a=(n.classList.add("circularCheck"),document.createElementNS("http://www.w3.org/2000/svg","svg")),o=(a.setAttribute("width","20"),a.setAttribute("height","20"),a.setAttribute("viewBox","0 0 20 20"),a.classList.add("svgCheck"),"svgCheck"+e.lastTaskInputIdNum),o=(a.id=o,a.setAttribute("data-testid",o),document.createElementNS("http://www.w3.org/2000/svg","path"));return o.classList.add("check"),o.setAttribute("class","check"),o.setAttribute("d","M4 10 L8 14 L16 6"),o.setAttribute("stroke","white"),o.setAttribute("stroke-width","2"),o.setAttribute("fill","none"),o.setAttribute("stroke-linecap","round"),o.setAttribute("stroke-linejoin","round"),o.id="check"+e.lastTaskInputIdNum,a.appendChild(o),n.appendChild(a),t.appendChild(n),t}function noteInputCancelBtnClick_editMode(e,t){document.getElementById("note-task-input-container-edit").remove(),document.getElementById(e.currentNoteTaskEditId).style.display="flex",t.noteTaskInputContainerEditShowing=!1}function noteInputSaveBtnClick_editMode(e,t){var n=document.getElementById("note-task-input-container-edit").querySelector("textarea").value;document.getElementById(e.currentNoteTaskEditId).querySelector("span").textContent=n,document.getElementById(e.currentNoteTaskEditId).style.display="flex",document.getElementById("note-task-input-container-edit").remove(),t.noteTaskInputContainerEditShowing=!1}function handleRemoveBtnClick(e){var e=getLastNumberFromId(e),t="noteDiv"+e,e="taskDiv"+e;document.getElementById(t)?document.getElementById(t).remove():document.getElementById(e)&&document.getElementById(e).remove()}function handleEditBtnClick(e,t,n,a,o){var i=getLastNumberFromId(e),l="noteDiv"+i,i="taskDiv"+i;t.noteTaskInputContainerShowing&&(n.style.display="none",a.style.display="flex"),"Note"===getTypeFromId(e)?editNoteTask("note",l,o,t):"Task"===getTypeFromId(e)&&editNoteTask("task",i,o,t)}function checkOrUncheckTask(e){var e=getLastNumberFromId(e),t=document.getElementById("taskDiv"+e),e=document.getElementById("check"+e),n=t.firstElementChild;t.classList.contains("completed-task")?(n.style.backgroundColor="",e.setAttribute("stroke-width","2"),e.parentElement.parentElement.style.opacity="",t.classList.remove("completed-task")):t.classList.contains("completed-task")||(n.style.backgroundColor="#3ba43e",e.setAttribute("stroke-width","3"),e.parentElement.parentElement.style.opacity="1",t.classList.add("completed-task"))}function getTypeFromId(e){e=e.match(/(editBtn|editIcon)(Note|Task)\d+/);return e&&e[2]?e[2]:null}function autoExpandEdit(e){e.style.height="24px",e.style.height=e.scrollHeight+"px"}function buildNoteTaskInputContainerEdit(e){var t=document.createElement("div"),n=(t.id="note-task-input-container-edit",document.createElement("div")),a=(n.id="upper-half-note-task-input-edit",document.createElement("textarea")),e=(a.id="note-task-input-text-edit",a.setAttribute("data-testid","note-task-input-text-edit"),a.placeholder="Description",a.value=e,n.appendChild(a),document.createElement("div")),a=(e.id="lower-half-note-task-input-edit",document.createElement("div")),o=(a.id="save-cancel-container-edit",document.createElement("div")),i=(o.id="note-input-save-container-edit",o.classList.add("save-cancel-task-container"),document.createElement("div")),i=(i.id="note-input-save-btn-edit",i.textContent="Save",o.appendChild(i),document.createElement("div")),l=(i.id="note-input-cancel-container-edit",i.classList.add("save-cancel-task-container"),document.createElement("div"));return l.id="note-input-cancel-btn-edit",l.textContent="Cancel",i.appendChild(l),a.appendChild(o),a.appendChild(i),e.appendChild(a),t.appendChild(n),t.appendChild(e),t}function editNoteTask(e,t,n,a){n.currentNoteTaskEditId=t;var n=document.getElementById(t),t=document.getElementById(t).querySelector("span").innerText,t=(n.style.display="none",buildNoteTaskInputContainerEdit(t)),o=(t.style.display="flex",n.previousElementSibling);o?o.parentNode.insertBefore(t,o.nextSibling):n.parentNode.insertBefore(t,n),a.noteTaskInputContainerEditShowing=!0,document.getElementById("note-task-input-text-edit").addEventListener("input",function(e){autoExpandEdit(document.getElementById("note-task-input-text-edit"))}),autoExpandEdit(document.getElementById("note-task-input-text-edit")),t.querySelector("textarea").focus()}function appendEditRemoveContainer(e,t){var n=document.createElement("div"),a=(n.classList.add("editRemoveContainer"),"editRemoveContainer"+e+t),a=(n.id=a,document.createElement("div")),o=(a.classList.add("editRemoveBtn"),a.classList.add("editBtn"),"editBtn"+e+t),o=(a.setAttribute("id",o),a.setAttribute("data-testid",o),document.createElement("img")),o=(o.id="editIcon"+e+t,o.classList.add("editIcon"),o.src="images/icons/whitepencil.png",o.draggable=!1,a.appendChild(o),document.createElement("div")),i=(o.classList.add("editRemoveBtn"),o.classList.add("removeBtn"),"removeBtn"+e+t),i=(o.setAttribute("id",i),o.setAttribute("data-testid",i),document.createElementNS("http://www.w3.org/2000/svg","svg")),l=(i.classList.add("editRemoveSvg"),i.classList.add("removeSvg"),"trashSvg"+e+t),l=(i.setAttribute("id",l),i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("width","24"),i.setAttribute("height","24"),i.setAttribute("viewBox","0 0 24 24"),i.setAttribute("fill","none"),i.setAttribute("stroke","currentColor"),i.setAttribute("stroke-width","2"),i.setAttribute("stroke-linecap","round"),i.setAttribute("stroke-linejoin","round"),"polyline"+e+t);return i.innerHTML=`<polyline id="${l}" class="removePath" points="3 6 5 6 21 6"></polyline>
                        <path id="${"path"+e+t}" class="removePath" d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        <line id="${"line1"+e+t}" class="removePath" x1="10" y1="11" x2="10" y2="17"></line>
                        <line id="${"line2"+e+t}" class="removePath" x1="14" y1="11" x2="14" y2="17"></line>`,o.appendChild(i),n.appendChild(a),n.appendChild(o),n}function getLastNumberFromId(e){e=e.match(/\d+$/);return e?parseInt(e[0],10):null}function closeNotesContainer(e,t,n,a,o){n.noteTaskInputContainerShowing&&(a.click(),n.noteTaskInputContainerShowing=!1),e.classList.remove("fullsize"),e.classList.remove("fullopacity"),o||window.scrollTo({top:0,behavior:"smooth"}),t.notesShowing=!1}function openNotesContainer(e,t){e.classList.add("fullsize"),e.classList.add("fullopacity"),window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}),t.notesShowing=!0}function noteInputCancel(e,t,n,a){e.style.display="none",t.style.display="flex",n.noteTaskInputContainerShowing=!1,a.value=""}function insertAtCaret(e,t){document.activeElement!==e&&e.focus();var n=e.selectionStart,a=e.selectionEnd,o=e.value.substring(0,n),a=e.value.substring(a,e.value.length),o=(e.value=o+t+a,n+t.length);e.setSelectionRange(o,o)}function setEmojiContainerPointLocation(e,t,n,a){let o;o=a?600:616,e<450&&(t.style.display="none",n.emojiContainerShowing=!1),e<o?(a=45+(o-1-e)/4.3+"%",t.style.setProperty("--after-left",a)):t.style.setProperty("--after-left","45%")}function containsNonSpaceChar(e){return/[^\s]/.test(e)}function backToLabelSelection(e,t,n,a,o,i,l){e.style.display="none",t.style.display="none",l.tagSelected?n.style.display="flex":n.style.display="none",a.style.display="flex",o.style.display="flex",i.style.display="block"}function deselectTags(e,t,n,a,o,i,l,s){let c,d;d=("tag-text"===e.className?(c=e.parentElement.id,e.parentElement):(c=e.id,e)).innerHTML;var e=document.getElementById(c).previousElementSibling,r=document.getElementById(c).nextElementSibling,e=(e&&"h4"===e.tagName.toLowerCase()?e.remove():r&&"h4"===r.tagName.toLowerCase()?r.remove():(t.tagSelected=!1,n.classList.add("blink"),n.style.display="block",t.clearIconClicked||(a.style.display="none")),document.getElementById(c).remove(),document.createElement("div"));e.className="tag unselectable selection-tag",e.innerHTML=d,e.id=c,e.firstElementChild.style.backgroundColor="",o.insertBefore(e,o.firstChild),i.tagsSelected--,showTagSelectionDivider(t,l,s)}function handleTaskEnter_or_n(e,t,n,a,o,i,l,s,c,d,r,u,g,m,p,b,C){"Enter"===e.key?(e.preventDefault(),document.activeElement===a?o.click():document.activeElement===i?l.click():document.activeElement===c?s.click():"note-task-input-text-edit"===document.activeElement.id&&document.getElementById("note-input-save-btn-edit").click()):"n"===e.key&&canOpenNotes(b,p,m,C)?t.notesShowing?u.noteTaskInputContainerShowing||u.noteTaskInputContainerEditShowing||!t.notesConsoleShowing||(r.click(),taskCheckbox.checked=!1,e.preventDefault()):openNotesContainer(n,t):"t"===e.key&&t.notesShowing&&t.notesConsoleShowing&&!u.noteTaskInputContainerShowing&&!u.noteTaskInputContainerEditShowing?(r.click(),taskCheckbox.checked=!0,e.preventDefault()):"Escape"===e.key&&t.notesShowing&&(document.activeElement===c?d.click():closeNotesContainer(n,t,u,d,g))}function delay(t){return new Promise(e=>setTimeout(e,t))}function canOpenNotes(e,t,n,a){var o=[e,t,n];return""===e.style.display&&""===t.style.display&&""===n.style.display||o.every(e=>"none"===e.style.display)&&"none"!==a.style.display}document.addEventListener("DOMContentLoaded",function(){function e(){textarea.style.height="24px",textarea.style.height=textarea.scrollHeight+"px"}setEmojiContainerPointLocation(window.innerWidth,emojiContainer,notesFlags,isMobile),populateTaskLabelContainer(),isMobile&&(aboutIconNotes.style.display="none",notesSettingsHr.style.display="none",addingDeletingUpdatingLabelsInfoBlock.style.display="none"),dynamicList.addEventListener("click",function(e){var e=e.target,t=e.id;"check"===e.className.baseVal||"svgCheck"===e.className.baseVal?checkOrUncheckTask(t):e.classList.contains("editRemoveBtn")||e.classList.contains("editRemoveSvg")||e.classList.contains("editIcon")||e.classList.contains("removePath")?e.classList.contains("editBtn")||e.classList.contains("editIcon")?handleEditBtnClick(t,flags,noteTaskInputContainer,addNoteTaskContainer,state):(e.classList.contains("removeBtn")||e.classList.contains("removeSvg")||e.classList.contains("removePath"))&&handleRemoveBtnClick(t):"note-input-save-btn-edit"!==t&&"note-input-cancel-btn-edit"!==t||("note-input-save-btn-edit"===t?noteInputSaveBtnClick_editMode(state,flags):"note-input-cancel-btn-edit"===t&&noteInputCancelBtnClick_editMode(state,flags))}),taskCheckbox.addEventListener("click",function(){noteTaskInputText.focus()}),noteInputSaveBtn.addEventListener("click",function(){noteInputSave(noteTaskInputContainer,addNoteTaskContainer,flags,noteTaskInputText,taskCheckbox,counters),setTimeout(()=>{notesConsole.scrollTo({top:notesConsole.scrollHeight,behavior:"smooth"})},0),noteTaskInputText.value="",noteTaskInputText.focus(),e()}),noteInputCancelBtn.addEventListener("click",function(){noteInputCancel(noteTaskInputContainer,addNoteTaskContainer,flags,noteTaskInputText),e()}),addNoteTaskContainer.addEventListener("click",function(){addNoteTaskContainer.style.display="none",noteTaskInputContainer.style.display="flex",flags.noteTaskInputContainerEditShowing&&(document.getElementById("note-task-input-container-edit").remove(),flags.noteTaskInputContainerEditShowing=!1,document.getElementById(state.currentNoteTaskEditId).style.display="flex"),noteTaskInputText.focus(),flags.noteTaskInputContainerShowing=!0,setTimeout(()=>{notesConsole.scrollTo({top:notesConsole.scrollHeight,behavior:"smooth"})},0)}),textarea.addEventListener("input",e),notesBtn.addEventListener("click",function(){!1===notesFlags.notesShowing?openNotesContainer(notesContainer,notesFlags):closeNotesContainer(notesContainer,notesFlags,flags,noteInputCancelBtn,isMobile)}),document.addEventListener("keydown",e=>handleTaskEnter_or_n(e,notesFlags,notesContainer,createLabelInput,createLabelDone,updateLabelInput,updateLabelDone,noteInputSaveBtn,noteTaskInputText,noteInputCancelBtn,addNoteTaskContainer,flags,isMobile,settingsContainer,aboutContainer,blogContainer,main_elements)),clearIcon.addEventListener("click",async function(){document.querySelectorAll(".selected-tag .tag-text").forEach(e=>{e.style.fontSize="20px"}),flags.clearIconClicked=!0,clearIcon.classList.add("resetIconRotation"),setTimeout(()=>{clearIcon.style.display="none",clearIcon.classList.remove("resetIconRotation")},500),tagIcon.style.marginLeft="",tagIcon.classList.remove("tagToLeftSide"),promptContainer.style.width="",notesFlags.notesConsoleShowing&&(notesConsole.style.display="none",labelSelectionWindow.style.display="block",notesFlags.notesConsoleShowing=!1),document.querySelectorAll(".selected-tag").forEach(e=>{deselectTags(e,flags,tagIcon,clearIcon,labelSelectionRow,counters,tagSelectionDivider,addDoneContainer)}),flags.clearIconClicked=!1,flags.tagSelected=!1,labelInputContainer.style.justifyContent="center"}),promptContainer.addEventListener("click",function(){notesFlags.isClicked=!0,taskPrompt.style.display="none",tagIcon.style.marginRight=0,tagIcon.classList.add("blink"),notesConsole.style.display="none",labelSelectionWindow.style.display="block",notesFlags.notesConsoleShowing=!1,promptContainer.style.zIndex=3}),document.addEventListener("keydown",function(e){var t=state.generalTarget;"Shift"!==e.key||flags.shiftPressed?"Alt"!==e.key||flags.altPressed||(e.preventDefault(),flags.altPressed=!0,t.classList.contains("tag-text")&&!t.parentElement.classList.contains("selected-tag")&&!t.classList.contains("create-label")&&flags.altPressed&&t!==selectionDoneDiv&&t!==selectionDone&&t!==addTagIcon&&((state.lastSelectionElement=t).style.backgroundColor="rgba(0, 255, 0, 0.2)")):(flags.shiftPressed=!0,t.classList.contains("tag-text")&&!t.classList.contains("create-label")&&!t.parentElement.classList.contains("selected-tag")&&flags.shiftPressed&&t!==selectionDoneDiv&&t!==selectionDone&&t!==addTagIcon&&(state.lastSelectionElement=t,flags.altPressed?t.style.backgroundColor="rgba(0, 255, 0, 0.2)":(t.style.backgroundColor="rgba(255, 0, 0, 0.2)",t.classList.add("deleteJiggling"))))}),document.addEventListener("keyup",function(e){"Shift"===e.key&&flags.shiftPressed?(flags.shiftPressed=!1,null!==state.lastSelectionElement&&(state.lastSelectionElement.style.backgroundColor="",state.lastSelectionElement.classList.remove("deleteJiggling"))):"Alt"===e.key&&flags.altPressed&&(flags.altPressed=!1,null!==state.lastSelectionElement)&&(state.lastSelectionElement.style.backgroundColor="")}),document.addEventListener("mouseover",function(e){e=e.target;(state.generalTarget=e).classList.contains("tag-text")&&(flags.shiftPressed||flags.altPressed)&&e!==selectionDoneDiv&&e!==selectionDone&&e!==addTagIcon||null===state.lastSelectionElement||(state.lastSelectionElement.style.backgroundColor="",state.lastSelectionElement.classList.remove("deleteJiggling"))}),labelSelectionRow.addEventListener("mouseover",function(e){e=e.target;e.classList.contains("tag-text")&&flags.shiftPressed&&!flags.altPressed&&e!==selectionDoneDiv&&e!==selectionDone&&e!==addTagIcon?(null!==state.lastSelectionElement&&(state.lastSelectionElement.style.backgroundColor="",state.lastSelectionElement.classList.remove("deleteJiggling")),(state.lastSelectionElement=e).style.backgroundColor="rgba(255, 0, 0, 0.2)",e.classList.add("deleteJiggling")):e.classList.contains("tag-text")&&flags.altPressed&&e!==selectionDoneDiv&&e!==selectionDone&&e!==addTagIcon?(null!==state.lastSelectionElement&&(state.lastSelectionElement.style.backgroundColor=""),(state.lastSelectionElement=e).style.backgroundColor="rgba(0, 255, 0, 0.2)"):null!==state.lastSelectionElement&&(state.lastSelectionElement.style.backgroundColor="",state.lastSelectionElement.classList.remove("deleteJiggling"))}),labelSelectionRow.addEventListener("click",function(t){t=t.target;if("selection-tag"===t.className||("tag-text"===t.className||"tag-text deleteJiggling"===t.className)&&"Done"!==t.innerText)if(flags.shiftPressed&&!flags.altPressed)deleteLabel(t,addDoneContainer,tagSelectionDivider,flags);else if(flags.altPressed||flags.altPressed&&flags.shiftPressed){var n=t;clearIcon.style.display="none",promptContainer.style.display="none",labelInputContainer.style.display="none",labelSelectionWindow.style.display="none",updateLabelContainer.style.display="flex",updateLabelWindow.style.display="block",flags.updateLabelWindowOpen=!0;let e;"tag-text"!==n.className&&(n.className="tag-text deleteJiggling"),e=n.parentElement.id;updateLabelInput.value=document.getElementById(e).innerText.trim(),state.elementToUpdateId=e,updateLabelInput.focus()}else 5===counters.tagsSelected?alert("You've reached your max limit of 5 labels"):(counters.tagsSelected++,addLabelInputContainerTagDivider(counters,labelInputContainer),addLabel(t,labelInputContainer),addLabelInitialActions(flags,tagIcon,promptContainer,clearIcon),removeTagSelectionDivider(addDoneContainer,tagSelectionDivider,flags),(labelInputContainer.scrollWidth>labelInputContainer.clientWidth||state.currentLabelInputTagSize<20)&&(adjustLabelFontSize(state,fontSizeArr,fontNumArr,labelInputContainer),labelInputContainer.scrollWidth>labelInputContainer.clientWidth)&&(labelInputContainer.style.justifyContent="left"));else"selection-done-div"===t.id||"selection-done"===t.id?(notesConsole.style.display="block",labelSelectionWindow.style.display="none",0===counters.tagsSelected&&(tagIcon.style.marginLeft="",tagIcon.classList.remove("tagToLeftSide"),promptContainer.style.width="",taskPrompt.style.display="block",tagIcon.style.marginRight="10px",promptContainer.style.zIndex=5),tagIcon.classList.remove("blink"),flags.transitionNotesAutoSwitchToggle&&(flags.tagSelected&&"Start"===start_stop_btn.innerText||!flags.tagSelected&&"Stop"===start_stop_btn.innerText)&&start_stop_btn.click(),flags.noteTaskInputContainerShowing&&noteTaskInputText.focus(),flags.noteTaskInputContainerEditShowing&&document.getElementById("note-task-input-text-edit").focus(),notesFlags.notesConsoleShowing=!0,notesFlags.notesConsoleShowing=!0):"add-tag-icon"===t.id&&(clearIcon.style.display="none",promptContainer.style.display="none",labelInputContainer.style.display="none",labelSelectionWindow.style.display="none",createLabelContainer.style.display="flex",createLabelWindow.style.display="block",flags.createLabelWindowOpen=!0,createLabelInput.focus())}),labelInputContainer.addEventListener("mouseover",function(e){var t=e.target;"selected-tag"!==t.className&&"tag-text"!==t.className||notesFlags.notesConsoleShowing||(t.classList.add("deleteJiggling"),setTimeout(()=>{t.classList.remove("deleteJiggling")},250))}),labelInputContainer.addEventListener("click",function(e){e=e.target;"selected-tag"!==e.className&&"tag-text"!==e.className&&"tag-text deleteJiggling"!==e.className||notesFlags.notesConsoleShowing?promptContainer.click():("tag-text deleteJiggling"===e.className&&(e.className="tag-text"),deselectTags(e,flags,tagIcon,clearIcon,labelSelectionRow,counters,tagSelectionDivider,addDoneContainer),document.querySelectorAll(".selection-tag .tag-text").forEach(e=>{e.style.fontSize="20px"}),labelInputContainer.scrollWidth<=labelInputContainer.clientWidth&&adjustLabelFontSize(state,fontSizeArr,fontNumArr,labelInputContainer),labelInputContainer.scrollWidth<=labelInputContainer.clientWidth&&(labelInputContainer.style.justifyContent="center"),flags.tagSelected||(tagIcon.style.marginLeft="",tagIcon.classList.remove("tagToLeftSide"),promptContainer.style.width=""))}),createLabelCancel.addEventListener("click",function(e){createLabelInput.value="",backToLabelSelection(createLabelContainer,createLabelWindow,clearIcon,promptContainer,labelInputContainer,labelSelectionWindow,flags),hideEmojiContainer(emojiContainer,notesFlags),flags.createLabelWindowOpen=!1}),updateLabelCancel.addEventListener("click",function(e){updateLabelInput.value="",backToLabelSelection(updateLabelContainer,updateLabelWindow,clearIcon,promptContainer,labelInputContainer,labelSelectionWindow,flags),hideEmojiContainer(emojiContainer,notesFlags),flags.updateLabelWindowOpen=!1}),createLabelDone.addEventListener("click",function(e){if(""!==createLabelInput.value&&containsNonSpaceChar(createLabelInput.value)){var t=checkLabelIsUnique(createLabelInput);if(42<createLabelInput.value.trim().length)return void alert("Oops! Your label seems a bit too long. Could you please make it 42 characters or shorter? Thank you!");t&&(createLabel(createLabelInput,counters,labelSelectionRow,addDoneContainer),replaceEmoji(state,emojiImg,emojiImg2)),flags.createLabelWindowOpen=!1}showTagSelectionDivider(flags,tagSelectionDivider,addDoneContainer),hideEmojiContainer(emojiContainer,notesFlags),createLabelInput.value="",backToLabelSelection(createLabelContainer,createLabelWindow,clearIcon,promptContainer,labelInputContainer,labelSelectionWindow,flags)}),updateLabelDone.addEventListener("click",function(e){if(""!==updateLabelInput.value&&containsNonSpaceChar(updateLabelInput.value)){if(!1===checkIfUpdatedLabelIsUnique(state,updateLabelInput))return;if(42<updateLabelInput.value.trim().length)return void alert("Oops! Your label seems a bit too long. Could you please make it 42 characters or shorter? Thank you!");document.getElementById(state.elementToUpdateId).firstElementChild.textContent=updateLabelInput.value.trim(),replaceEmoji(state,emojiImg,emojiImg2),flags.updateLabelWindowOpen=!1}showTagSelectionDivider(flags,tagSelectionDivider,addDoneContainer),hideEmojiContainer(emojiContainer,notesFlags),updateLabelInput.value="",backToLabelSelection(updateLabelContainer,updateLabelWindow,clearIcon,promptContainer,labelInputContainer,labelSelectionWindow,flags)}),emojiBtn.addEventListener("click",function(){notesFlags.emojiContainerShowing?hideEmojiContainer(emojiContainer,notesFlags):(emojiContainer.style.display="block",setTimeout(()=>{emojiContainer.classList.add("emojiPopup"),emojiContainer.style.opacity="1"},1),notesFlags.emojiContainerShowing=!0)}),emojiBtn2.addEventListener("click",function(){notesFlags.emojiContainerShowing?hideEmojiContainer(emojiContainer,notesFlags):(emojiContainer.style.display="block",setTimeout(()=>{emojiContainer.classList.add("emojiPopup"),emojiContainer.style.opacity="1"},1),notesFlags.emojiContainerShowing=!0)}),createLabelWindow.addEventListener("click",function(){createLabelInput.focus()}),updateLabelWindow.addEventListener("click",function(){updateLabelInput.focus()}),emojiContainer.addEventListener("click",function(){flags.createLabelWindowOpen?createLabelInput.focus():flags.updateLabelWindowOpen&&updateLabelInput.focus()}),emojiSymbols.forEach(a=>{a.addEventListener("click",function(){var e=a.id,t=emojiMap[e];let n;flags.createLabelWindowOpen?n=createLabelInput:flags.updateLabelWindowOpen&&(n=updateLabelInput),n&&insertAtCaret(n,t),state.lastSelectedEmojiId=e,emojiContainer.style.display="none",notesFlags.emojiContainerShowing=!1})}),document.addEventListener("click",function(e){emojiContainer.contains(e.target)||e.target===emojiImg||e.target===emojiImg2||"block"!==emojiContainer.style.display||(emojiContainer.style.display="none",notesFlags.emojiContainerShowing=!1)}),window.addEventListener("resize",function(){setEmojiContainerPointLocation(this.window.innerWidth,emojiContainer,notesFlags,isMobile)}),transitionNotesAutoSwitchToggle.addEventListener("click",async function(){transitionNotesAutoSwitchToggle.checked?flags.transitionNotesAutoSwitchToggle=!0:flags.transitionNotesAutoSwitchToggle=!1,sessionState.loggedIn&&await updateUserSettings({notes:{autoSwitchToggle:flags.transitionNotesAutoSwitchToggle}})}),tutorialImgContainers.forEach(t=>{t.addEventListener("mouseover",function(){var e=t.id,e=tutorialContainerMap[e];document.getElementById(e).classList.add("fullOpacity")}),t.addEventListener("mouseout",function(){var e=t.id,e=tutorialContainerMap[e];document.getElementById(e).classList.remove("fullOpacity")})}),aboutIconNotes.addEventListener("click",function(){settings_menu_container.click(),setTimeout(()=>{notesBtnContainer.click()},0)})});