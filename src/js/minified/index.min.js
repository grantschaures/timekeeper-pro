import{flowtimeBackgrounds as Y,chilltimeBackgrounds as z,selectedBackground as c,selectedBackgroundIdTemp as K,selectedBackgroundId as m,timeConvert as u,intervals as g,startTimes as p,recoverBreakState as f,recoverPomState as q,elapsedTime as I,alertVolumes as h,alertSounds as v,counters as y,flags as w,tempStorage as G,settingsMappings as Q,savedInterruptionsArr as J,timeAmount as T,intervalArrs as k,defaultBackgroundPath as X,progressTextMod as S}from"../modules/index-objects.js";import{chime as b,bell as P,clock_tick as Z,soundMap as oo}from"../modules/sound-map.js";import{start_stop_btn as x,submit_change_btn as eo,end_session_btn as to,report_btn as o,total_time_display as E,productivity_chill_mode as B,progressBarContainer as L,progressBar as no,progressContainer as C,display as ro,hyperChillTitle as N,subMainContainer as ao,interruptionsContainer as io,interruptionsSubContainer as so,decBtn as lo,incBtn as co,interruptionsNum as mo,suggestionBreakContainer as uo,suggestionBreak_label as go,suggestionBreak_min as M,completedPomodorosContainer as po,completedPomodoros_label as fo,completedPomodoros_min as Io,targetHoursContainer as ho,timekeepingContainer as vo,popupMenu as yo,settingsContainer as wo,notesContainer as To,aboutContainer as ko,blogContainer as So,blackFlowtimeBackground as bo,blackChilltimeBackground as Po,targetTimeReachedToggle as xo,breakSuggestionToggle as F,suggestionMinutesInput as Eo,flowmodoroNotificationToggle as A,flowmodoroNotifications as Bo,flowmodoroNotificationInfoWindow as Lo,flowTimeBreakNotification as Co,flowTimeBreakNotificationInfoWindow as No,pomodoroNotifications as Mo,pomodoroNotificationInfoWindow as Fo,notesAutoSwitch as Ao,notesAutoSwitchInfoWindow as Do,pomodoroNotificationToggle as D,autoStartPomodoroIntervalToggle as Oo,autoStartBreakIntervalToggle as Ho,defaultThemeContainer as Wo,defaultTheme as jo,darkThemeContainer as Ro,darkGrayTheme as Vo,targetTimeReachedAlert as e,transitionClockSoundToggle as _o,flowTimeAnimationToggle as $o,chillTimeAnimationToggle as Uo,pomodoroVolumeContainer as t,pomodoroVolumeBar as n,pomodoroVolumeThumb as Yo,flowmodoroVolumeContainer as r,flowmodoroVolumeBar as a,flowmodoroVolumeThumb as zo,generalVolumeContainer as i,generalVolumeBar as s,generalVolumeThumb as Ko,pomodoroVolumeContainer2 as l,pomodoroVolumeBar2 as d,pomodoroVolumeThumb2 as qo,flowmodoroVolumeContainer2 as Go,flowmodoroVolumeBar2 as Qo,flowmodoroVolumeThumb2 as Jo,generalVolumeContainer2 as Xo,generalVolumeBar2 as Zo,generalVolumeThumb2 as oe,flowmodoroRadios as ee,flowmodoroInputs as te,generalRadios as ne,pomodoroInputs as re,pomodoroRadios as ae,flowtimeBackgroundCells as ie,chilltimeBackgroundCells as se,settings_menu_container as le,registerHereText as de,backgroundVideoSource as ce,backgroundVideo as me,flowAnimation as O,chillAnimation as H,hyperChillLogoImage as ue,createLabelInput as ge,updateLabelInput as pe,emojiContainer as fe,loginEmailInput as Ie,loginPasswordInput as he,forgotPasswordContainer as ve,loginBtnContainer as ye,loginBtn as we,logoutBtn as Te,deleteAccountBtn as ke,forgotPasswordSettings as Se,propagateUnfinishedTasks as be,propagateUnfinishedTasksInfoWindow as Pe,flowtimeBackgroundWorldCells as xe,chilltimeBackgroundWorldCells as Ee,deleteAccountPopupYesBtn as Be,deleteAccountPopupNoBtn as Le,deleteAccountPopup as Ce,popupOverlay as Ne,questionIcon as Me,logoutBtn2 as Fe,backgroundContainer as Ae,deepWorkBackground as De,breakBackground as Oe,streaksContainer as He,streaksLoginSuggestionPopup as We}from"../modules/dom-elements.js";import{sessionState as W}from"../modules/state-objects.js";import{state as je,flags as Re}from"../modules/navigation-objects.js";import{initializeGUI as Ve}from"../utility/initialize-gui.js";import{updateUserSettings as j}from"../state/update-settings.js";import{updateTargetHours as _e}from"../state/update-target-hours.js";import{updateShowingTimeLeft as $e}from"../state/update-showing-time-left.js";import{userActivity as Ue}from"../state/user-activity.js";let R=new Worker("/js/web-workers/pomodoroWorker.js"),V=new Worker("/js/web-workers/suggestionWorker.js"),_=new Worker("/js/web-workers/flowmodoroWorker.js"),Ye=new Worker("/js/web-workers/displayWorker.js"),ze=new Worker("/js/web-workers/totalDisplayWorker.js"),Ke=new MutationObserver(In);function qe(o,e,t,n,r,a,i,s,l,d,c,m,u,g,p,f,I,h,v,y,w,T){o.pomodoroNotificationToggle?!o.inHyperFocus&&60*e.currentPomodoroNotification*1e3<1e3*Math.floor((Date.now()-t.local)/1e3)+1e3&&!o.modeChangeExecuted?(o.modeChangeExecuted=!0,o.autoSwitchedModes=!1,gt(o,e,n,t,r,a,s,l,d,c,m,u,g,p,f,I,h,w,T)):o.inHyperFocus&&60*e.currentPomodoroNotification*1e3<1e3*Math.floor((Date.now()-t.local)/1e3)+1e3&&!o.modeChangeExecuted&&(o.modeChangeExecuted=!0,o.autoSwitchedModes=!1,pt(o,e,n,s,t,r,i,u,g,p,f,w,T)):(o.flowmodoroNotificationToggle&&!o.inHyperFocus&&60*e.currentFlowmodoroNotification*1e3<1e3*Math.floor((Date.now()-t.local)/1e3)+1e3&&!o.sentFlowmodoroNotification&&(v.postMessage("clearInterval"),mt(s,e,t,u,g,p,f,w,T),o.sentFlowmodoroNotification=!0,r.classList.add("glowing-effect")),o.breakSuggestionToggle&&o.inHyperFocus&&60*s.suggestionMinutes*1e3<1e3*Math.floor((Date.now()-t.local)/1e3)+1e3&&!o.sentSuggestionMinutesNotification&&(y.postMessage("clearInterval"),ct(s,t,u,g,p,f,w,T),o.sentSuggestionMinutesNotification=!0,r.classList.add("glowing-effect")))}function Ge(o,e){let t;return t=0==o.currentPomodoroIntervalOrderIndex||2==o.currentPomodoroIntervalOrderIndex||4==o.currentPomodoroIntervalOrderIndex?1==e.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]?"It's been "+o.currentPomodoroNotification+" minute! Are you ready to take a short break?":"It's been "+o.currentPomodoroNotification+" minutes! Are you ready to take a short break?":6==o.currentPomodoroIntervalOrderIndex?1==e.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]?"It's been "+o.currentPomodoroNotification+" minute! Are you ready to take a long break?":"It's been "+o.currentPomodoroNotification+" minutes! Are you ready to take a long break?":1==e.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]?"It's been "+o.currentPomodoroNotification+" minute! Are you ready to start your Pomodoro Interval?":"It's been "+o.currentPomodoroNotification+" minutes! Are you ready to start your Pomodoro Interval?"}function Qe(o,e,t,n,r,a,i){let s=o["target"];Object.keys(t).forEach(o=>{s.id!==""+e+o+"Input"&&s.id!==""+e+o+"Input2"||(Mt(n,r),a[e]="NoAlert"===o?"none":o.toLowerCase(),"NoAlert"!==o?(Nt(t[o],e,i),document.getElementById(""+e+o+"Input").checked=!0,document.getElementById(""+e+o+"Input2").checked=!0):(document.getElementById(e+"NoAlertInput").checked=!0,document.getElementById(e+"NoAlertInput2").checked=!0),Je(e,o))})}async function Je(o,e){let t;t="bell"===e.toLowerCase()||"chime"===e.toLowerCase()?e.toLowerCase():"none",W.loggedIn&&("flowmodoro"===o?await j({chillTime:{alertSound:t}}):"general"===o?await j({flowTime:{alertSound:t}}):await j({pomodoro:{alertSound:t}}))}function Xe(o,e,t,n,r){o.inRecoveryBreak&&!o.autoStartPomodoroInterval?e.pomodoroNotificationSeconds=Math.round(60*t.currentPomodoroNotification-(n.displayTime/1e3-1)):e.pomodoroNotificationSeconds=60*t.currentPomodoroNotification,r.postMessage("clearInterval"),r.postMessage(e.pomodoroNotificationSeconds)}function Ze(o,e,t,n,r,a){o.inRecoveryBreak&&(setTimeout(()=>{en(e,t,n,o,r,a)},1e3),fn(o,n.hyperFocus,t)<e.targetTime)&&(a.classList.remove("glowing-effect"),o.hitTarget=!1)}function ot(o,e,t,n,r){o+=60*e.pomodoroIntervalArr[t.currentPomodoroIntervalIndex]*1e3,n.autoSwitchedModes&&(r.hyperFocus=o),e=r.hyperFocus;r.hyperFocus=1e3*Math.round(e/1e3)}function et(o,e,t,n,r,a){o.inHyperFocus?(o.breakSuggestionToggle&&(e.suggestionSeconds=60*n.suggestionMinutes,a.postMessage(e.suggestionSeconds)),o.flowmodoroNotificationToggle&&r.postMessage("clearInterval")):(o.flowmodoroNotificationToggle&&(e.flowmodoroNotificationSeconds=60*t.currentFlowmodoroNotification,r.postMessage(e.flowmodoroNotificationSeconds)),o.breakSuggestionToggle&&a.postMessage("clearInterval"))}function tt(o,e){let t;return t=1===o.currentPomodoroIntervalOrderIndex?"Short Break #1 | "+String(e.pomodoroIntervalArr[1])+" min":3===o.currentPomodoroIntervalOrderIndex?"Short Break #2 | "+String(e.pomodoroIntervalArr[1])+" min":5===o.currentPomodoroIntervalOrderIndex?"Short Break #3 | "+String(e.pomodoroIntervalArr[1])+" min":7===o.currentPomodoroIntervalOrderIndex?"Long Break | "+String(e.pomodoroIntervalArr[2])+" min":"Break Mode"}function nt(o,e,t,n,r){!o.inRecoveryPom||o.autoStartPomodoroInterval&&o.autoStartBreakInterval?e.pomodoroNotificationSeconds=60*t.currentPomodoroNotification:e.pomodoroNotificationSeconds=Math.round(60*t.currentPomodoroNotification-(n.displayTime/1e3-1)),r.postMessage("clearInterval"),r.postMessage(e.pomodoroNotificationSeconds)}function rt(o,e){let t;return t=1===o.currentPomodoroIntervalOrderIndex?"Short Break #1 | "+String(e.pomodoroIntervalArr[1])+" min":3===o.currentPomodoroIntervalOrderIndex?"Short Break #2 | "+String(e.pomodoroIntervalArr[1])+" min":5===o.currentPomodoroIntervalOrderIndex?"Short Break #3 | "+String(e.pomodoroIntervalArr[1])+" min":"Break Mode"}function at(o,e){let t;return t=0===o.currentPomodoroIntervalOrderIndex?"Pomodoro #1 | "+String(e.pomodoroIntervalArr[0])+" min":2===o.currentPomodoroIntervalOrderIndex?"Pomodoro #2 | "+String(e.pomodoroIntervalArr[0])+" min":4===o.currentPomodoroIntervalOrderIndex?"Pomodoro #3 | "+String(e.pomodoroIntervalArr[0])+" min":6===o.currentPomodoroIntervalOrderIndex?"Pomodoro #4 | "+String(e.pomodoroIntervalArr[0])+" min":"Pomodoro Mode"}function it(o,e,t){animationsFadeOut(e),o.chillTimeAnimationToggle&&animationsFadeIn(t,"flex")}function st(o,e,t,n){1<o.startStop&&animationsFadeOut(t),e.flowTimeAnimationToggle&&animationsFadeIn(n,"block")}function lt(o,e,t,n){o.inRecoveryBreak?e.local=t.localStartTime:o.inRecoveryPom?e.local=n.localStartTime:e.local=Date.now()}function dt(o,e,t){o.pomodoroNotificationToggle&&"Break"!==e.textContent&&bt(t)}function ct(o,e,t,n,r,a,i,s){let l;l=1<o.suggestionMinutes?"Need a break? You've been hard at work for "+String(o.suggestionMinutes)+" minutes!":"Need a break? You've been hard at work for "+String(o.suggestionMinutes)+" minute!",i||s||new Notification(l),e.lastBreakSuggestionNotification=Date.now(),Qt(t,n,r.general,a.general)}function mt(o,e,t,n,r,a,i,s,l){let d;d=1==o.breakTimeSuggestionsArr[e.currentFlowmodoroBreakIndex]?"It's been "+e.currentFlowmodoroNotification+" minute! Are you ready to get back into Flow Time?":"It's been "+e.currentFlowmodoroNotification+" minutes! Are you ready to get back into Flow Time?",s||l||new Notification(d),t.lastFlowmodoroNotification=Date.now(),Qt(n,r,a.flowmodoro,i.flowmodoro)}function ut(o,e,t,n,r,a,i,s,l,d){let c;0==e.currentPomodoroIntervalOrderIndex||2==e.currentPomodoroIntervalOrderIndex||4==e.currentPomodoroIntervalOrderIndex?(c=1==t.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]?"It's been "+e.currentPomodoroNotification+" minute! Are you ready to take a short break?":"It's been "+e.currentPomodoroNotification+" minutes! Are you ready to take a short break?",s.pomodoroCountIncremented||(e.pomodorosCompleted++,s.pomodoroCountIncremented=!0)):6==e.currentPomodoroIntervalOrderIndex?(c=1==t.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]?"It's been "+e.currentPomodoroNotification+" minute! Are you ready to take a long break?":"It's been "+e.currentPomodoroNotification+" minutes! Are you ready to take a long break?",s.pomodoroCountIncremented||(e.pomodorosCompleted++,s.pomodoroCountIncremented=!0)):c=1==t.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]?"It's been "+e.currentPomodoroNotification+" minute! Are you ready to start your Pomodoro Interval?":"It's been "+e.currentPomodoroNotification+" minutes! Are you ready to start your Pomodoro Interval?",l||d||new Notification(c),Qt(n,r,a.pomodoro,i.pomodoro),o.lastPomNotification=Date.now()}function gt(o,e,t,n,r,a,i,s,l,d,c,m,u,g,p,f,I,h,v){let y=Date.now()-n.local;var w=e.pomodorosCompleted,t=t.hyperFocus;let T=n.local;var k={intervalIndex:e.currentPomodoroIntervalIndex,intervalOrderIndex:e.currentPomodoroIntervalOrderIndex,notification:e.currentPomodoroNotification},S=60*i.pomodoroIntervalArr[k.intervalIndex]*1e3;o.autoStartPomodoroInterval&&Math.round(y/1e3)-60*i.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]<=2&&30<(Date.now()-n.lastPomNotification)/1e3&&ut(n,e,i,m,u,g,p,o,h,v),o.autoStartPomodoroInterval&&o.autoStartBreakInterval?(y-=S,7===k.intervalOrderIndex?k.intervalOrderIndex=0:k.intervalOrderIndex++,xt(k,i),T=Date.now(),n.hyperFocus=T,ht(a,y,w,t,T,e,o,r,S),vt(e,k)):o.autoStartPomodoroInterval?(y-=S,k.intervalOrderIndex++,xt(k,i),T=Date.now()-y,n.hyperFocus=T,ht(a,y,w,t,T,e,o,r,S),vt(e,k)):(Math.round(y/1e3)-60*i.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]<=2&&30<(Date.now()-n.lastPomNotification)/1e3&&(R.postMessage("clearInterval"),ut(n,e,i,m,u,g,p,o,h,v)),r.classList.add("glowing-effect"))}function pt(o,e,t,n,r,a,i,s,l,d,c,m,u){let g=Date.now()-r.local,p=e.pomodorosCompleted,f=t.hyperFocus,I=r.local;var t={intervalIndex:e.currentPomodoroIntervalIndex,intervalOrderIndex:e.currentPomodoroIntervalOrderIndex,notification:e.currentPomodoroNotification},h=60*n.pomodoroIntervalArr[t.intervalIndex]*1e3;o.autoStartBreakInterval&&Math.round(g/1e3)-60*n.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]<=2&&30<(Date.now()-r.lastPomNotification)/1e3&&ut(r,e,n,s,l,d,c,o,m,u),o.autoStartPomodoroInterval&&o.autoStartBreakInterval?(g-=h,o.pomodoroCountIncremented||(p++,o.pomodoroCountIncremented=!0),t.intervalOrderIndex++,xt(t,n),f-=g,I=Date.now(),It(i,g,p,f,I,e,o,a,h),vt(e,t)):o.autoStartBreakInterval?(g-=h,o.pomodoroCountIncremented||(p++,o.pomodoroCountIncremented=!0),t.intervalOrderIndex++,xt(t,n),f-=g,I=Date.now()-g,It(i,g,p,f,I,e,o,a,h),vt(e,t)):Math.round(g/1e3)-60*n.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]<=2&&30<(Date.now()-r.lastPomNotification)/1e3?(R.postMessage("clearInterval"),ut(r,e,n,s,l,d,c,o,m,u),a.classList.add("glowing-effect")):(a.classList.add("glowing-effect"),o.pomodoroCountIncremented||(e.pomodorosCompleted++,o.pomodoroCountIncremented=!0))}function ft(o,e,t,n,r){}function It(o,e,t,n,r,a,i,s,l){o.displayTime=e,o.pomodorosCompleted=t,o.hyperFocusElapsedTime=n,o.localStartTime=r,o.pomIntervalTime=l,a.pomodorosCompleted<o.pomodorosCompleted&&(a.pomodorosCompleted=o.pomodorosCompleted),i.inRecoveryBreak=!0,s.click()}function ht(o,e,t,n,r,a,i,s,l){o.displayTime=e,o.pomodorosCompleted=t,o.hyperFocusElapsedTime=n,o.localStartTime=r,o.breakIntervalTime=l,a.pomodorosCompleted=o.pomodorosCompleted,i.inRecoveryPom=!0,s.click()}function vt(o,e){o.currentPomodoroIntervalIndex=e.intervalIndex,o.currentPomodoroIntervalOrderIndex=e.intervalOrderIndex,o.currentPomodoroNotification=e.notification}function yt(o){var e=Math.floor(o/60),t=o%60,o=Math.floor(60*(o-Math.floor(o)));return String(e).padStart(2,"0")+`:${String(t).padStart(2,"0")}:`+String(o).padStart(2,"0")}function wt(o){o.currentPomodoroIntervalIndex=0,o.currentPomodoroIntervalOrderIndex=0}function Tt(o,e,t){o.textContent="Pomodoros",e.textContent=t.pomodorosCompleted}function kt(o,e,t,n){o.style.display="flex",Tt(e,t,n)}function St(o){o.style.display="none"}function bt(o){7===o.currentPomodoroIntervalOrderIndex?o.currentPomodoroIntervalOrderIndex=0:o.currentPomodoroIntervalOrderIndex++}function Pt(o,e){0===o.currentPomodoroIntervalOrderIndex||2===o.currentPomodoroIntervalOrderIndex||4===o.currentPomodoroIntervalOrderIndex||6===o.currentPomodoroIntervalOrderIndex?(o.currentPomodoroIntervalIndex=0,o.currentPomodoroNotification=e.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]):1===o.currentPomodoroIntervalOrderIndex||3===o.currentPomodoroIntervalOrderIndex||5===o.currentPomodoroIntervalOrderIndex?(o.currentPomodoroIntervalIndex=1,o.currentPomodoroNotification=e.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]):7===o.currentPomodoroIntervalOrderIndex&&(o.currentPomodoroIntervalIndex=2,o.currentPomodoroNotification=e.pomodoroIntervalArr[o.currentPomodoroIntervalIndex])}function xt(o,e){0===o.intervalOrderIndex||2===o.intervalOrderIndex||4===o.intervalOrderIndex||6===o.intervalOrderIndex?(o.intervalIndex=0,o.notification=e.pomodoroIntervalArr[o.intervalIndex]):1===o.intervalOrderIndex||3===o.intervalOrderIndex||5===o.intervalOrderIndex?(o.intervalIndex=1,o.notification=e.pomodoroIntervalArr[o.intervalIndex]):7===o.intervalOrderIndex&&(o.intervalIndex=2,o.notification=e.pomodoroIntervalArr[o.intervalIndex])}async function Et(o,e,t,n,r,a,i){"pomodoroInput"===o.target.id?(i[0]=t,e.pomodoroIntervalArr[0]=t,0===n.currentPomodoroIntervalIndex&&0!==n.startStop&&a.pomodoroNotificationToggle&&a.inHyperFocus&&(r.innerText=at(n,e))):"shortBreakInput"===o.target.id?(i[1]=t,e.pomodoroIntervalArr[1]=t,1===n.currentPomodoroIntervalIndex&&0!==n.startStop&&a.pomodoroNotificationToggle&&(r.innerText=rt(n,e))):"longBreakInput"===o.target.id&&(i[2]=t,e.pomodoroIntervalArr[2]=t,2===n.currentPomodoroIntervalIndex)&&0!==n.startStop&&a.pomodoroNotificationToggle&&(r.innerText="Long Break | "+String(e.pomodoroIntervalArr[2])+" min"),W.loggedIn&&await j({pomodoro:{intervalArr:i}})}function Bt(o,e,t){var n=t[e];n?o.classList.remove("infoWindowOpacity"):o.classList.add("infoWindowOpacity"),t[e]=!n}function Lt(o,e,t,n,r,a,i,s,l,d){o=Math.floor((Date.now()-o.hyperFocus)/1e3);e.inHyperFocus?(t.suggestionSeconds=60*n.suggestionMinutes-o,V.postMessage("clearInterval"),V.postMessage(t.suggestionSeconds)):t.suggestionSeconds=60*n.suggestionMinutes}function Ct(o){return 720<o?o=720:(o<1||isNaN(o)||void 0===o)&&(o=1),o}function Nt(o,e,t){"flowmodoro"===e?o.volume=t.flowmodoro:"general"===e?o.volume=t.general:"pomodoro"===e&&(o.volume=t.pomodoro),o.play()}function Mt(o,e){o.pause(),o.currentTime=0,e.pause(),e.currentTime=0}async function Ft(o,e,t,n,r,a,i,s){o=o.getBoundingClientRect(),i=(i.clientX-o.left)/o.width,i=Math.max(0,Math.min(1,i));t.style.left=100*i+"%",n.style.width=100*i+"%",r.style.left=100*i+"%",a.style.width=100*i+"%",s.flowmodoroThumbIsDragging||s.flowmodoroThumbIsDragging2?e.flowmodoro=i:s.generalThumbIsDragging||s.generalThumbIsDragging2?e.general=i:(s.pomodoroThumbIsDragging||s.pomodoroThumbIsDragging2)&&(e.pomodoro=i)}function $(o,e){w[e]=!0,o.preventDefault()}function At(o){"touchmove"===o.type&&(o=o.touches[0]),w.flowmodoroThumbIsDragging?Ft(r,h,zo,a,Jo,Qo,o,w):w.flowmodoroThumbIsDragging2?Ft(Go,h,zo,a,Jo,Qo,o,w):w.generalThumbIsDragging?Ft(i,h,Ko,s,oe,Zo,o,w):w.generalThumbIsDragging2?Ft(Xo,h,Ko,s,oe,Zo,o,w):w.pomodoroThumbIsDragging?Ft(t,h,Yo,n,qo,d,o,w):w.pomodoroThumbIsDragging2&&Ft(l,h,Yo,n,qo,d,o,w)}function Dt(o){"touchend"===o.type&&(o=o.changedTouches[0]),w.flowmodoroThumbIsDragging||w.flowmodoroThumbIsDragging2?Ot("flowmodoro","flowmodoroThumbIsDragging","flowmodoroThumbIsDragging2"):w.generalThumbIsDragging||w.generalThumbIsDragging2?Ot("general","generalThumbIsDragging","generalThumbIsDragging2"):w.pomodoroThumbIsDragging||w.pomodoroThumbIsDragging2?Ot("pomodoro","pomodoroThumbIsDragging","pomodoroThumbIsDragging2"):"flowmodoroAlert"!==o.target.className&&"generalAlert"!==o.target.className&&"pomodoroAlert"!==o.target.className&&"volume-thumb"!==o.target.className&&"block"===document.getElementById("settingsContainer").style.display&&Mt(P,b)}async function Ot(o,e,t){"chime"===v[o]?(Mt(P,b),Nt(b,o,h)):"bell"===v[o]&&(Mt(P,b),Nt(P,o,h)),w[e]=!1,w[t]=!1,W.loggedIn&&((e={})["pomodoro"===o?"pomodoro":"general"===o?"flowTime":"chillTime"]={alertVolume:h[o]},await j(e))}function Ht(o){for(var[e,t]of Object.entries(o))document.getElementById(t).style.display="none",document.getElementById(e).classList.remove("selected")}function Wt(o){for(var[e,t]of Object.entries(o))document.getElementById(t).style.display="block"}function jt(t,o,e){var n=window.innerWidth||document.documentElement.clientWidth;if(Rt(n,e),n<=650)Wt(t);else{for(let[o,e]of Object.entries(t))document.getElementById(o).addEventListener("click",function(){Ht(t),document.getElementById(e).style.display="block",this.classList.add("selected")});"block"===document.getElementById("settingsContainer").style.display&&document.getElementById(o.lastSettingsSelectionId).click()}}function Rt(o,e){e.innerText=o<=522?"End":"End Session"}function Vt(o,e,t,n,r,a){o.style.display="flex",_t(a,r,n),Ut(a,e,t,r)}function _t(o,e,t){90<=o.lastHyperFocusIntervalMin?e.currentFlowmodoroNotification=t.breakTimeSuggestionsArr[3]:50<=o.lastHyperFocusIntervalMin?e.currentFlowmodoroNotification=t.breakTimeSuggestionsArr[2]:25<=o.lastHyperFocusIntervalMin?e.currentFlowmodoroNotification=t.breakTimeSuggestionsArr[1]:e.currentFlowmodoroNotification=t.breakTimeSuggestionsArr[0]}async function $t(o,e,t,n,r){"flowmodoroBreakInput1"===o.target.id?(r[0]=t,e.breakTimeSuggestionsArr[0]=t,n.currentFlowmodoroBreakIndex=0):"flowmodoroBreakInput2"===o.target.id?(r[1]=t,e.breakTimeSuggestionsArr[1]=t,n.currentFlowmodoroBreakIndex=1):"flowmodoroBreakInput3"===o.target.id?(r[2]=t,e.breakTimeSuggestionsArr[2]=t,n.currentFlowmodoroBreakIndex=2):"flowmodoroBreakInput4"===o.target.id&&(r[3]=t,e.breakTimeSuggestionsArr[3]=t,n.currentFlowmodoroBreakIndex=3),W.loggedIn&&await j({chillTime:{intervalArr:r}})}function Ut(o,e,t,n){o.flowmodoroNotificationToggle?e.textContent="Break":e.textContent="Suggested Break",t.textContent=n.currentFlowmodoroNotification+" min"}function Yt(o,e){o.style.display="none"}function zt(o){o.style.display="none"}function Kt(o){o.style.display="block"}function qt(o,e,t){t.push(e.interruptions),e.interruptions=0,o.textContent=e.interruptions}function Gt(){var o=Date.now(),o=new Date(o);return(o.getHours()%12||12)+`:${String(o.getMinutes()).padStart(2,"0")} `+(12<=o.getHours()?"PM":"AM")}function Qt(o,e,t,n){Mt(e,o),"chime"===t?(o.volume=n,o.play().then(()=>{}).catch(o=>{})):"bell"===t&&(e.volume=n,e.play().then(()=>{}).catch(o=>{}))}function Jt(o,e){o.volume=0,e.volume=0,o.muted=!0,e.muted=!0,o.play().then(()=>{o.pause(),o.muted=!1,o.currentTime=0}).catch(o=>{}),e.play().then(()=>{e.pause(),e.muted=!1,e.currentTime=0}).catch(o=>{})}async function Xt(o,e,t,n){return"Notification"in window?"denied"===Notification.permission||"granted"===await Notification.requestPermission():(alert("This browser does not support push notifications"),!1)}async function Zt(o,e){o.submittedTarget=!1,document.getElementById("target-hours").remove();o=document.createElement("input");o.type="number",o.id="target-hours",o.name="hours",o.min="0",o.value="",document.getElementById("coolDiv").appendChild(o),o.focus(),document.getElementById("target-hours-submit").textContent="Submit",e.loggedIn&&await _e(0)}function on(o,e,t,n,r,a){var i=Math.round(100*parseFloat(o))/100;return!(!o||i<=0||24<i||60*i*60*1e3<=fn(r,n.hyperFocus,t))||(0!==a.startStop?r.inHyperFocus?alert("Enter a valid target time between "+Math.ceil(100*parseFloat((n.hyperFocus+(Date.now()-t.local))/e.msPerHour))/100+" hours and 24 hours"):r.inHyperFocus||alert("Enter a valid target time between "+Math.ceil(100*parseFloat(n.hyperFocus/e.msPerHour))/100+" hours and 24 hours"):0===a.startStop&&alert("Enter a valid target time between 0.01 hours and 24 hours"),!1)}function U(o,e,t,n,r){o.innerText=n,e.innerText=r,t.inHyperFocus="Stop"===n}function en(e,t,n,r,a,i){if(isNaN(e.targetTime)||null===e.targetTime||!r.submittedTarget)a.classList.contains("fullopacity1")&&(a.classList.remove("fullopacity1"),setTimeout(()=>{a.style.width="0%"},500));else{a.classList.contains("fullopacity1")||a.classList.add("fullopacity1");let o=fn(r,n.hyperFocus,t)/e.targetTime;1<o&&(o=1),0!==e.targetTime&&1<=o&&!r.hitTarget&&(r.hitTarget=!0,setTimeout(()=>{1==r.targetReachedToggle&&new Notification("Congrats! You've hit your target time!")},1),i.classList.add("glowing-effect")),a.style.width=100*o+"%"}}function tn(o){o.innerText="00:00:00"}function nn(o,e,t,n){o.beginning=Date.now(),n.sessionInProgress=!0,hn(),document.getElementById("target-hours").classList.remove("glowing-effect"),e.classList.add("hyperChillLogoRotate"),""!=document.getElementById("target-hours").value&&(""!=!document.getElementById("target-hours").value||n.submittedTarget)||(t.classList.toggle("small"),n.progressBarContainerIsSmall=!0)}function rn(o,e,t,n,r,a,i,s,l,d){Ke.disconnect(),document.title="HyperChill.io | Online Productivity Time Tracker",o.classList.remove("hyperChillLogoRotate"),an(t),cn(n),cn(r),dn(a),ln(i),ln(s),sn(e),l.splice(0,l.length),d.flowTime.splice(0,d.flowTime.length),d.chillTime.splice(0,d.chillTime.length)}function an(o){for(var e in o)null!==o[e]&&(clearInterval(o[e]),o[e]=null)}function sn(o){o.hitTarget=!1,o.inHyperFocus=!1,o.autoSwitchedModes=!1,o.inRecoveryBreak=!1,o.inRecoveryPom=!1,o.modeChangeExecuted=!1,o.sentFlowmodoroNotification=!1,o.sentSuggestionMinutesNotification=!1,o.pomodoroCountIncremented=!1,o.sessionInProgress=!1}function ln(o){for(var e in o)o.hasOwnProperty(e)&&(o[e]=0)}function dn(o){for(var e in o)o.hasOwnProperty(e)&&(o[e]=void 0)}function cn(o){for(var e in o)o.hasOwnProperty(e)&&(o[e]=null)}function mn(o,e){1==e.transitionClockSoundToggle&&(o.volume=.25,o.play())}function un(o,e,t,n,r,a){"Enter"!==o.key||a.enterKeyDown||"home"!==je.lastSelectedMode?"ArrowLeft"!==o.key&&o.key:(o.preventDefault(),a.enterKeyDown=!0,"target-hours"===document.activeElement.id?t.click():document.activeElement===he?we.click():document.activeElement!==n&&document.activeElement!==r&&"noteInput"!=document.activeElement.className&&"note-task-input-text"!=document.activeElement.id&&"note-task-input-text-edit"!==document.activeElement.id&&(a.autoSwitchedModes=!1,e.click()))}function gn(o,e){"Enter"===o.key&&e.enterKeyDown&&(e.enterKeyDown=!1)}function pn(o,e){var t=Math.floor(o/e.msPerHour),n=Math.floor((o-t*e.msPerHour)/e.msPerMin),o=Math.floor((o-t*e.msPerHour-n*e.msPerMin)/e.msPerSec);return String(t)+" hours, "+String(n)+" minutes, "+String(o)+" seconds"}function fn(o,e,t){return o.inHyperFocus?e+(Date.now()-t.local):e}function In(){document.title=document.getElementById("display").innerText}function hn(){document.title=document.getElementById("display").innerText,Ke.observe(document.getElementById("display"),{childList:!0,subtree:!0,characterData:!0})}function vn(o){var e=document.getElementById("favicon1"),t=document.getElementById("favicon2");e.href=o,t.href=o}function yn(o){var e=document.getElementById("mainContainer"),t=document.createElement("div");t.style.width="50px",t.style.height="50px",t.style.backgroundColor=o,t.style.position="absolute",t.style.innerText="Debugging Square",t.style.top="500px",t.style.left="100px",e.appendChild(t)}function wn(o){document.documentElement.style.backgroundImage=o}async function Tn(o){await Ue(o),document.dispatchEvent(new Event("updateStreak"))}function setInitialBackgroundCellSelection(){document.getElementById(m.flowtime).classList.add("selected-background"),document.getElementById(m.chilltime).classList.add("selected-background")}function setBackground(o,e){"home"===je.lastSelectedMode&&(w.inHyperFocus?(De.style.opacity=e,""===o?setTimeout(()=>{De.style.backgroundImage=o},250):(Oe.style.opacity=0,De.style.backgroundImage=o,setTimeout(()=>{"home"===je.lastSelectedMode&&(document.documentElement.style.backgroundImage=o)},250))):(Oe.style.opacity=e,""===o?setTimeout(()=>{Oe.style.backgroundImage=o},250):(Oe.style.backgroundImage=o,De.style.opacity=0,setTimeout(()=>{"home"===je.lastSelectedMode&&(document.documentElement.style.backgroundImage=o)},250))))}function deactivateDarkTheme(o,e,t,n,r,a,i,s,l,d,c,m,u,g){let p="rgba(0, 0, 0, 0.9)";var f="rgb(0, 0, 0)";[o,e,t,i,s,l,g].forEach(function(o){o.style.backgroundColor=p,o!==g&&(o.style.border=null)}),r.style.backgroundColor=u?f:p,r.style.border=null,n.style.backgroundColor="rgba(255, 255, 255, 0.25)",n.style.border="1px rgba(0, 0, 0, 0.25)",a.style.backgroundColor=f,m.style.backgroundColor="#000000",m.style.border="5px solid #FFFFFF","black-flowtime"===c.flowtime&&"black-chilltime"===c.chilltime&&(document.getElementById(d.flowtime).click(),document.getElementById(d.chilltime).click())}async function activateDarkTheme(o,e,t,n,r,a,i,s,l,d,c,m,u,g,p){r=[r,a,g];[o,e,t,n,i,s,l,p].forEach(function(o){o.style.backgroundColor="rgba(32, 32, 32, 0.9)",o.style.border="3px solid rgb(255, 255, 255)"}),r.forEach(function(o){o.style.backgroundColor="rgba(32, 32, 32, 1)"}),g.style.border="5px solid white",W.updatingState||(m.flowtime=u.flowtime,m.chilltime=u.chilltime,W.loggedIn&&await j({backgroundsThemes:{flowTimeBackgroundTemp:u.flowtime,chillTimeBackgroundTemp:u.chilltime}}),d.click(),c.click())}function replaceTargetHours(o,e,t){o=Math.round(100*parseFloat(o))/100,e.targetTime=60*o*60*1e3,document.getElementById("target-hours").remove(),e=document.createElement("h4");return e.textContent=o,e.id="target-hours",e.className="finalized-hours",e.style.backgroundColor="#5c5c5c",document.getElementById("coolDiv").appendChild(e),document.getElementById("target-hours-submit").textContent="Change",t.submittedTarget=!0,o}function totalTimeDisplay(t,n,r,a,i,s,l){var n=fn(i,n.hyperFocus,t),t=(864e5<=n&&setTimeout(()=>{to.click()},0),Math.floor(n/a.msPerHour)),d=Math.floor((n-t*a.msPerHour)/a.msPerMin),c=Math.floor((n-t*a.msPerHour-d*a.msPerMin)/a.msPerSec),t=String(t).padStart(2,"0"),d=String(d).padStart(2,"0"),c=String(c).padStart(2,"0");if(i.submittedTarget){let o=n/s.targetTime;1<o&&(o=1);var m=t+`:${d}:`+c+" ("+Math.trunc(100*o)+"%) completed",n=(l.defaultTimeStr=m,s.targetTime-n),u=Math.floor(n/a.msPerHour),g=Math.floor((n-u*a.msPerHour)/a.msPerMin),a=Math.ceil((n-u*a.msPerHour-g*a.msPerMin)/a.msPerSec),u=String(u).padStart(2,"0"),g=String(g).padStart(2,"0"),a=String(a).padStart(2,"0");let e;n=n/s.targetTime;e=i.hitTarget?"00:00:00 (0%) remaining":`${u}:${g}:${a} (${Math.ceil(100*n)}%) remaining`,l.targetTimeLeftStr=e,l.showingTimeLeft?r.textContent=e:r.textContent=m}else r.textContent=t+`:${d}:`+c}function animationsFadeIn(o,e){"home"===je.lastSelectedMode&&(o.classList.add("intoOpacityTransition"),o.style.display=e)}function animationsFadeOut(o){o.classList.remove("intoOpacityTransition"),setTimeout(()=>{o.style.display="none"},0)}document.addEventListener("DOMContentLoaded",function(){var r=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),a=(o=navigator.userAgent||window.opera,/iPad/.test(o)||1<navigator.maxTouchPoints),o=window.innerWidth||document.documentElement.clientWidth,e=[{radios:ee,type:"flowmodoro"},{radios:ne,type:"general"},{radios:ae,type:"pomodoro"}];Rt(o,to),window.scrollTo({top:0,behavior:"smooth"}),r&&(yo.style.backgroundColor="rgb(0, 0, 0)"),setInitialBackgroundCellSelection();let t=document.getElementById("threeWayToggle"),n=(!r&&504<o?(setTimeout(()=>{N.style.opacity="1",N.classList.add("hyperChillTitleAnimationTranslate")},0),setTimeout(()=>{ao.style.opacity="1",N.classList.add("hyperChillTitleAnimationScale")},1e3),setTimeout(()=>{ao.style.transition="opacity 0.5s ease-in-out",N.classList.remove("hyperChillTitleAnimationTranslate"),N.style.opacity="0",setTimeout(()=>{N.style.display="none",t.style.display="inline-flex",t.classList.add("threeWayToggleAnimation"),setTimeout(()=>{t.style.opacity="1"},100)},1e3)},2e3)):(r||o<=504)&&setTimeout(()=>{N.style.display="none",ao.style.opacity="1",ao.style.transition="opacity 0.5s ease-in-out",t.style.display="inline-flex",setTimeout(()=>{t.style.opacity="1"},100)},1e3),"url("+X+")"),i=new Image;i.src=X,i.onload=function(){document.body.classList.add("fade-out-bg"),document.documentElement.style.transition="background-image 0.25s ease-in-out"},document.addEventListener("keydown",o=>un(o,x,eo,ge,pe,w)),document.addEventListener("keyup",o=>gn(o,w)),x.addEventListener("click",function(){if(y.startStop++,mn(Z,w),tn(ro),1===y.startStop?(nn(p,ue,L,w),Jt(b,P),p.lastPomNotification=Date.now()):dt(w,B,y),lt(w,p,f,q),Ye.postMessage("clearInterval"),Ye.postMessage("startInterval"),x.classList.remove("glowing-effect"),w.pomodoroCountIncremented=!1,g.main){w.inHyperFocus=!1,w.lastHyperFocusIntervalMin=Math.floor((Date.now()-p.hyperFocus)/6e4),p.chillTime=Date.now(),y.chillTimeIntervals++,vn("/images/logo/HyperChillLogoBlue.png"),it(w,O,H),qt(mo,y,J),zt(so),setBackground(c.chilltime,1);let o;w.inRecoveryBreak?(I.hyperFocus=f.hyperFocusElapsedTime,o=f.pomIntervalTime,p.chillTime=f.localStartTime):o=Date.now()-p.hyperFocus,k.flowTime.push(o);var e=I.hyperFocus;I.hyperFocus+=Date.now()-p.hyperFocus,w.pomodoroNotificationToggle?(kt(po,fo,Io,y),ot(e,T,y,w,I),Pt(y,T),Ze(w,T,p,I,no,C),Xe(w,I,y,f,R),U(x,B,w,"Start",tt(y,T))):(Vt(uo,go,M,T,y,w),U(x,B,w,"Start","Break")),totalTimeDisplay(p,I,E,u,w,T,S),et(w,I,y,T,_,V),clearInterval(g.main),g.main=null,ze.postMessage("clearInterval")}else{w.inHyperFocus=!0,w.sentFlowmodoroNotification=!1,y.flowTimeIntervals++;let o;w.inRecoveryPom?(o=q.breakIntervalTime,p.hyperFocus=q.localStartTime):(p.hyperFocus=Date.now(),o=p.hyperFocus-p.chillTime),2<y.startStop&&k.chillTime.push(o),ze.postMessage("startInterval"),vn("/images/logo/HyperChillLogoGreen.png"),st(y,w,H,O),Yt(uo,go,M),St(po),Kt(so),Pt(y,T),setBackground(c.flowtime,1),et(w,I,y,T,_,V),g.main=setInterval(()=>en(T,p,I,w,no,C),1e3),w.pomodoroNotificationToggle?(U(x,B,w,"Stop",at(y,T)),nt(w,I,y,q,R)):U(x,B,w,"Stop","Deep Work"),1<y.startStop&&(I.chillTime+=Date.now()-p.chillTime)}w.inRecoveryBreak=!1,w.inRecoveryPom=!1,w.sentSuggestionMinutesNotification=!1,w.autoSwitchedModes=!1,setTimeout(()=>{w.modeChangeExecuted=!1},1e3)}),eo.addEventListener("click",async function(){var o;w.submittedTarget?w.submittedTarget&&(w.hitTarget&&C.classList.remove("glowing-effect"),Zt(w,W),en(T,p,I,w,no,C),totalTimeDisplay(p,I,E,u,w,T,S),0<y.startStop)&&(w.progressBarContainerIsSmall||(L.classList.toggle("small"),w.progressBarContainerIsSmall=!0)):on(o=document.getElementById("target-hours").value,u,p,I,w,y)&&(w.hitTarget&&C.classList.remove("glowing-effect"),o=replaceTargetHours(o,T,w),W.loggedIn&&await _e(o),w.progressBarContainerIsSmall&&(L.classList.toggle("small"),w.progressBarContainerIsSmall=!1),en(T,p,I,w,no,C),totalTimeDisplay(p,I,E,u,w,T,S),w.hitTarget=!1)}),Eo.addEventListener("change",async function(){var o=Eo.value,o=(T.suggestionMinutes=Math.round(parseFloat(o)),Ct(T.suggestionMinutes));Eo.value=o;let e;e=0===y.startStop?0:Math.round((Date.now()-p.hyperFocus)/1e3),w.sentSuggestionMinutesNotification=!1,w.breakSuggestionToggle&&(Lt(p,w,I,o,g,v,h,b,P,x),60*o>e?(w.sentSuggestionMinutesNotification=!1,x.classList.remove("glowing-effect")):(w.sentSuggestionMinutesNotification=!0,x.classList.add("glowing-effect"))),W.loggedIn&&await j({flowTime:{suggestionMinutes:o}})}),lo.addEventListener("click",function(){0<y.interruptions&&(y.interruptions--,mo.textContent=y.interruptions)}),co.addEventListener("click",function(){y.interruptions<1e3&&(y.interruptions++,mo.textContent=y.interruptions)});for(let[o,e]of Object.entries(Q))document.getElementById(o).addEventListener("click",function(){Ht(Q),document.getElementById(e).style.display="block",this.classList.add("selected"),G.lastSettingsSelectionId=o});function s(o,e,t,n){o.flowmodoroNotificationToggle&&1<y.startStop&&!o.inHyperFocus&&(60*e.breakTimeSuggestionsArr[y.currentFlowmodoroBreakIndex]>t?(n.classList.remove("glowing-effect"),o.sentFlowmodoroNotification=!1):(n.classList.add("glowing-effect"),o.sentFlowmodoroNotification=!0))}function l(o,e,t){e<60*o?t.classList.remove("glowing-effect"):t.classList.add("glowing-effect")}function d(){fetch("/api/state/logout",{method:"POST"}).then(()=>{W.loggedIn=!1,window.location.href="/"}).catch(o=>{})}Mo.addEventListener("click",function(){Bt(Fo,"showingPomodoroNotificationInfoWindow",w)}),Bo.addEventListener("click",function(){Bt(Lo,"showingFlowmodoroNotificationInfoWindow",w)}),Co.addEventListener("click",function(){Bt(No,"showingFlowTimeBreakNotificationInfoWindow",w)}),Ao.addEventListener("click",function(){Bt(Do,"showingNotesAutoSwitchInfoWindow",w)}),be.addEventListener("click",function(){Bt(Pe,"showingPropagateUnfinishedTasksInfoWindow",w)}),zo.addEventListener("mousedown",o=>$(o,"flowmodoroThumbIsDragging")),zo.addEventListener("touchstart",o=>$(o,"flowmodoroThumbIsDragging")),Ko.addEventListener("mousedown",o=>$(o,"generalThumbIsDragging")),Ko.addEventListener("touchstart",o=>$(o,"generalThumbIsDragging")),Yo.addEventListener("mousedown",o=>$(o,"pomodoroThumbIsDragging")),Yo.addEventListener("touchstart",o=>$(o,"pomodoroThumbIsDragging")),Jo.addEventListener("mousedown",o=>$(o,"flowmodoroThumbIsDragging2")),Jo.addEventListener("touchstart",o=>$(o,"flowmodoroThumbIsDragging2")),oe.addEventListener("mousedown",o=>$(o,"generalThumbIsDragging2")),oe.addEventListener("touchstart",o=>$(o,"generalThumbIsDragging2")),qo.addEventListener("mousedown",o=>$(o,"pomodoroThumbIsDragging2")),qo.addEventListener("touchstart",o=>$(o,"pomodoroThumbIsDragging2")),document.addEventListener("mousemove",At),document.addEventListener("touchmove",At),document.addEventListener("mouseup",Dt),document.addEventListener("touchend",Dt),te.forEach(o=>{o.addEventListener("change",function(o){var e=Ct(Math.round(o.target.value));document.getElementById(o.target.id).value=e;let t;var n=[...T.breakTimeSuggestionsArr];$t(o,T,e,y,n),_t(w,y,T),0===y.startStop||w.inHyperFocus?(I.flowmodoroNotificationSeconds=60*y.currentFlowmodoroNotification,t=0):(t=Math.round((Date.now()-p.chillTime)/1e3),I.flowmodoroNotificationSeconds=60*y.currentFlowmodoroNotification-t,_.postMessage("clearInterval"),_.postMessage(I.flowmodoroNotificationSeconds)),(0===y.currentFlowmodoroBreakIndex&&"flowmodoroBreakInput1"===o.target.id||1===y.currentFlowmodoroBreakIndex&&"flowmodoroBreakInput2"===o.target.id||2===y.currentFlowmodoroBreakIndex&&"flowmodoroBreakInput3"===o.target.id||3===y.currentFlowmodoroBreakIndex&&"flowmodoroBreakInput4"===o.target.id)&&s(w,T,t,x),M.textContent=y.currentFlowmodoroNotification+" min"})}),re.forEach(o=>{o.addEventListener("change",async function(o){var e=Ct(Math.round(o.target.value));document.getElementById(o.target.id).value=e;let t;var n=[...T.pomodoroIntervalArr];w.inHyperFocus?(t=Math.round((Date.now()-p.hyperFocus)/1e3),"pomodoroInput"===o.target.id&&(w.modeChangeExecuted=!1,l(e,t,x))):(t=Math.round((Date.now()-p.chillTime)/1e3),("shortBreakInput"===o.target.id&&1===y.currentPomodoroIntervalIndex||"longBreakInput"===o.target.id&&2===y.currentPomodoroIntervalIndex)&&(w.modeChangeExecuted=!1,l(e,t,x))),Et(o,T,e,y,B,w,n),Pt(y,T),0===y.startStop?I.pomodoroNotificationSeconds=60*y.currentPomodoroNotification:w.pomodoroNotificationToggle&&(I.pomodoroNotificationSeconds=60*y.currentPomodoroNotification-t,R.postMessage("clearInterval"),R.postMessage(I.pomodoroNotificationSeconds))})}),e.forEach(e=>{e.radios.forEach(o=>{o.addEventListener("change",o=>Qe(o,e.type,oo,P,b,v,h))})}),[...ie,...xe].forEach(o=>{o.addEventListener("click",async function(o){var e=o.target.id,t=m.flowtime;document.getElementById(t).classList.remove("selected-background"),c.flowtime=Y[e],m.flowtime=e,document.getElementById(o.target.id).classList.add("selected-background"),w.inHyperFocus&&setBackground(c.flowtime,1),W.loggedIn&&await j({backgroundsThemes:{flowTimeBackground:m.flowtime}})})}),[...se,...Ee].forEach(o=>{o.addEventListener("click",async function(o){var e=o.target.id,t=m.chilltime;document.getElementById(t).classList.remove("selected-background"),c.chilltime=z[e],m.chilltime=e,document.getElementById(o.target.id).classList.add("selected-background"),!w.inHyperFocus&&1<=y.startStop&&setBackground(c.chilltime,1),W.loggedIn&&await j({backgroundsThemes:{chillTimeBackground:m.chilltime}})})}),xo.addEventListener("click",async function(){xo.checked?w.targetReachedToggle=!0:w.targetReachedToggle=!1,W.loggedIn&&await j({flowTime:{targetTimeReachedToggle:w.targetReachedToggle}})}),F.addEventListener("click",async function(){F.checked?(Xt(F,A,D,w),w.breakSuggestionToggle=!0,w.inHyperFocus?U(x,B,w,"Stop","Deep Work"):U(x,B,w,"Start","Break"),wt(y),D.checked&&D.click(),T.suggestionMinutes=Eo.value,Lt(p,w,I,T,g,v,h,b,P,x)):(w.breakSuggestionToggle=!1,V.postMessage("clearInterval"),x.classList.remove("glowing-effect")),W.loggedIn&&await j({flowTime:{notificationToggle:w.breakSuggestionToggle}})}),A.addEventListener("click",async function(){var o;A.checked?(Xt(F,A,D,w),wt(y),D.checked&&D.click(),o=Math.floor((Date.now()-p.chillTime)/1e3),w.inHyperFocus||0===y.startStop||(I.flowmodoroNotificationSeconds=60*y.currentFlowmodoroNotification-o,_.postMessage("clearInterval"),_.postMessage(I.flowmodoroNotificationSeconds)),w.flowmodoroNotificationToggle=!0):(w.flowmodoroNotificationToggle=!1,_.postMessage("clearInterval"),x.classList.remove("glowing-effect")),W.loggedIn&&await j({chillTime:{notificationToggle:w.flowmodoroNotificationToggle}}),Ut(w,go,M,y)}),D.addEventListener("click",async function(){var o,e;D.checked?(Xt(F,A,D,w),wt(y),A.checked&&A.click(),F.checked&&F.click(),o=Math.floor((Date.now()-p.hyperFocus)/1e3),w.inHyperFocus&&(e="Pomodoro #1 | "+String(T.pomodoroIntervalArr[0])+" min",U(x,B,w,"Stop",e),I.pomodoroNotificationSeconds=60*y.currentPomodoroNotification-o,R.postMessage(I.pomodoroNotificationSeconds)),w.pomodoroNotificationToggle=!0):(w.pomodoroNotificationToggle=!1,R.postMessage("clearInterval"),x.classList.remove("glowing-effect"),w.inHyperFocus?U(x,B,w,"Stop","Deep Work"):1<y.startStop&&(U(x,B,w,"Start","Break"),St(po),Vt(uo,go,M,T,y,w))),Ut(w,go,M,y),W.loggedIn&&await j({pomodoro:{notificationToggle:w.pomodoroNotificationToggle}})}),Oo.addEventListener("click",async function(){w.autoStartPomodoroInterval?w.autoStartPomodoroInterval&&(w.autoStartPomodoroInterval=!1):(w.autoStartPomodoroInterval=!0,w.modeChangeExecuted=!1),W.loggedIn&&await j({pomodoro:{autoStartPomToggle:w.autoStartPomodoroInterval}})}),Ho.addEventListener("click",async function(){w.autoStartBreakInterval?w.autoStartBreakInterval&&(w.autoStartBreakInterval=!1):(w.autoStartBreakInterval=!0,w.modeChangeExecuted=!1),W.loggedIn&&await j({pomodoro:{autoStartBreakToggle:w.autoStartBreakInterval}})}),_o.addEventListener("click",async function(){_o.checked?w.transitionClockSoundToggle=!0:w.transitionClockSoundToggle=!1,W.loggedIn&&await j({sounds:{transitionClockSound:w.transitionClockSoundToggle}})}),$o.addEventListener("click",async function(){$o.checked?(w.flowTimeAnimationToggle=!0,w.inHyperFocus&&animationsFadeIn(O,"block")):(w.flowTimeAnimationToggle=!1,w.inHyperFocus&&animationsFadeOut(O)),W.loggedIn&&await j({backgroundsThemes:{flowTimeAnimation:w.flowTimeAnimationToggle}})}),Uo.addEventListener("click",async function(){Uo.checked?(w.chillTimeAnimationToggle=!0,!w.inHyperFocus&&1<y.startStop&&animationsFadeIn(H,"flex")):(w.chillTimeAnimationToggle=!1,w.inHyperFocus||animationsFadeOut(H)),W.loggedIn&&await j({backgroundsThemes:{chillTimeAnimation:w.chillTimeAnimationToggle}})}),Wo.addEventListener("click",async function(){Vo.classList.remove("selected-background"),jo.classList.add("selected-background"),w.darkThemeActivated=!1,deactivateDarkTheme(io,ho,vo,L,yo,wo,To,ko,So,K,m,fe,r,He),W.loggedIn&&await j({backgroundsThemes:{darkThemeActivated:w.darkThemeActivated}})}),Ro.addEventListener("click",async function(){jo.classList.remove("selected-background"),Vo.classList.add("selected-background"),w.darkThemeActivated=!0,activateDarkTheme(io,ho,vo,L,yo,wo,To,ko,So,bo,Po,K,m,fe,He),W.loggedIn&&await j({backgroundsThemes:{darkThemeActivated:w.darkThemeActivated}})}),window.addEventListener("resize",function(){jt(Q,G,to)}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState?(w.inHyperFocus?(O.style.opacity=0,O.style.display="none",O):(H.style.opacity=0,H.style.display="none",H)).classList.remove("intoOpacityTransition"):"visible"===document.visibilityState&&"home"===je.lastSelectedMode&&(w.inHyperFocus&&w.flowTimeAnimationToggle?(O.style.display="block",O.classList.add("intoOpacityTransition")):!w.inHyperFocus&&w.chillTimeAnimationToggle&&0<y.startStop&&(H.style.display="flex",H.classList.add("intoOpacityTransition")))}),le.addEventListener("click",function(){setTimeout(()=>{jt(Q,G,to)},0)}),de.addEventListener("click",function(){window.location.href="/signup"}),to.addEventListener("click",function(){if(w.sessionInProgress){var e=Intl.DateTimeFormat().resolvedOptions().timeZone,e=(W.loggedIn?Tn(e):streaksCount.innerText=1,fn(w,I.hyperFocus,p)),t=(pn(e,u),w.inHyperFocus&&J.push(y.interruptions),J.reduce((o,e)=>o+e,0)),e=e/u.msPerMin;Math.floor(100*(1-t/e/.2));let o;(w.inHyperFocus?(o=Date.now()-p.hyperFocus,k.flowTime):(o=Date.now()-p.chillTime,k.chillTime)).push(o);pn(k.flowTime.reduce((o,e)=>o+e,0)/k.flowTime.length,u);setBackground("",0),wn(n),Mt(P,b),rn(ue,w,g,f,q,p,I,y,J,k),R.postMessage("clearInterval"),V.postMessage("clearInterval"),_.postMessage("clearInterval"),Ye.postMessage("clearInterval"),ze.postMessage("clearInterval"),animationsFadeOut(H),animationsFadeOut(O),tn(ro),en(T,p,I,w,no,C),totalTimeDisplay(p,I,E,u,w,T,S),w.progressBarContainerIsSmall&&(L.classList.toggle("small"),w.progressBarContainerIsSmall=!1),U(x,B,w,"Start","Press 'Start' to begin session"),x.classList.remove("glowing-effect"),C.classList.remove("glowing-effect"),Yt(uo,go,M),St(po),Kt(so),mo.textContent=y.interruptions,vn("/images/logo/HyperChillLogo_circular_white_border.png")}}),Te.addEventListener("click",async function(){d()}),Fe.addEventListener("click",function(){d()}),we.addEventListener("click",async function(){var o,e;o=Ie.value,e=he.value,fetch("/api/api/validateUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,password:e})}).then(e=>{if(e.ok)return e.json();if(429===e.status)return e.json().then(o=>{throw alert(o.message),new Error(`HTTP error! Status: ${e.status} - `+o.message)});throw alert("Your email or password is incorrect. Please try again."),new Error("HTTP error! Status: "+e.status)}).then(o=>{!0===o.loginSuccess&&Ve()}).catch(o=>{})}),Se.addEventListener("click",function(){window.location.href="/reset-password"}),C.addEventListener("mouseover",function(){(!L.classList.contains("small")&&1<=y.startStop||0===y.startStop&&w.submittedTarget)&&(C.style.cursor="pointer")}),C.addEventListener("mouseout",function(){(!L.classList.contains("small")&&1<=y.startStop||0===y.startStop&&w.submittedTarget)&&(C.style.cursor="default")}),C.addEventListener("click",async function(){(!L.classList.contains("small")&&1<=y.startStop||0===y.startStop&&w.submittedTarget)&&(S.showingTimeLeft?(S.showingTimeLeft=!1,E.textContent=S.defaultTimeStr):(S.showingTimeLeft=!0,E.textContent=S.targetTimeLeftStr),W.loggedIn)&&await $e(S.showingTimeLeft)}),He.addEventListener("mouseover",function(){W.loggedIn||Re.popupQuestionWindowShowing||(He.style.cursor="pointer",We.style.opacity=1)}),He.addEventListener("mouseout",function(){W.loggedIn||Re.popupQuestionWindowShowing||(We.style.opacity=0)}),He.addEventListener("click",function(){W.loggedIn||Re.popupQuestionWindowShowing||(window.location.href="/login")}),R.onmessage=function(o){w.modeChangeExecuted||(w.modeChangeExecuted=!0,r||a||new Notification(Ge(y,T)),Qt(b,P,v.pomodoro,h.pomodoro),0!==y.currentPomodoroIntervalIndex||w.pomodoroCountIncremented||(y.pomodorosCompleted++,w.pomodoroCountIncremented=!0),p.lastPomNotification=Date.now(),w.inHyperFocus&&w.autoStartBreakInterval||!w.inHyperFocus&&w.autoStartPomodoroInterval?setTimeout(()=>{w.autoSwitchedModes=!0,x.click()},0):x.classList.add("glowing-effect"))},V.onmessage=function(o){w.sentSuggestionMinutesNotification||(ct(T,p,b,P,v,h,r,a),w.sentSuggestionMinutesNotification=!0,x.classList.add("glowing-effect"))},_.onmessage=function(o){w.sentFlowmodoroNotification||(mt(T,y,p,b,P,v,h,r,a),w.sentFlowmodoroNotification=!0,x.classList.add("glowing-effect"))},Ye.onmessage=function(o){var e=Date.now()-p.local,t=Math.floor(e/u.msPerHour),n=Math.floor((e-t*u.msPerHour)/u.msPerMin),e=Math.floor((e-t*u.msPerHour-n*u.msPerMin)/u.msPerSec),t=String(t).padStart(2,"0"),n=String(n).padStart(2,"0"),e=String(e).padStart(2,"0");ro.textContent=t+`:${n}:`+e,qe(w,y,p,I,x,q,f,T,E,u,no,C,b,P,v,h,fo,Io,_,V,r,a)},ze.onmessage=function(o){totalTimeDisplay(p,I,E,u,w,T,S)},document.dispatchEvent(new Event("updateState"))});export{setInitialBackgroundCellSelection,setBackground,deactivateDarkTheme,activateDarkTheme,replaceTargetHours,totalTimeDisplay,animationsFadeIn,animationsFadeOut};