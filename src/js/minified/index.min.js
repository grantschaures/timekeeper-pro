import{flowtimeBackgrounds as H,chilltimeBackgrounds as O,selectedBackground as l,selectedBackgroundIdTemp as t,selectedBackgroundId as d,timeConvert as c,intervals as W,startTimes as u,recoverBreakState as j,recoverPomState as V,elapsedTime as m,alertVolumes as g,alertSounds as f,counters as p,flags as h,tempStorage as _,settingsMappings as R,savedInterruptionsArr as Z,timeAmount as I,intervalArrs as y,progressTextMod as w,times as z,perHourData as n,catIds as v,lightHtmlBackground as r,darkHtmlBackground as i,tempCounters as $}from"../modules/index-objects.js";import{chimePath as U,bellPath as Y,clock_tick as K,soundMap as T}from"../modules/sound-map.js";import{start_stop_btn as k,submit_change_btn as Q,end_session_btn as q,total_time_display as S,productivity_chill_mode as b,progressBarContainer as E,progressBar as G,progressContainer as P,display as J,hyperChillTitle as B,subMainContainer as X,interruptionsContainer as a,interruptionsSubContainer as ee,decBtn as oe,incBtn as te,interruptionsNum as ne,suggestionBreakContainer as re,suggestionBreak_label as ie,suggestionBreak_min as L,completedPomodorosContainer as ae,completedPomodoros_label as se,completedPomodoros_min as le,targetHoursContainer as s,timekeepingContainer as de,popupMenu as ce,settingsContainer as ue,notesContainer as me,aboutContainer as ge,blogContainer as fe,blackFlowtimeBackground as pe,blackChilltimeBackground as he,targetTimeReachedToggle as Ie,breakSuggestionToggle as ye,suggestionMinutesInput as we,flowmodoroNotificationToggle as ve,flowmodoroNotifications as Te,flowmodoroNotificationInfoWindow as ke,flowTimeBreakNotification as Se,flowTimeBreakNotificationInfoWindow as be,pomodoroNotifications as Ee,pomodoroNotificationInfoWindow as Pe,notesAutoSwitch as Be,notesAutoSwitchInfoWindow as Le,pomodoroNotificationToggle as x,autoStartPomodoroIntervalToggle as xe,autoStartBreakIntervalToggle as Ne,defaultThemeContainer as Ce,defaultTheme as Me,darkThemeContainer as Ae,darkGrayTheme as Fe,transitionClockSoundToggle as De,flowTimeAnimationToggle as He,chillTimeAnimationToggle as Oe,pomodoroVolumeContainer as We,pomodoroVolumeBar as je,pomodoroVolumeThumb as Ve,flowmodoroVolumeContainer as _e,flowmodoroVolumeBar as Re,flowmodoroVolumeThumb as Ze,generalVolumeContainer as ze,generalVolumeBar as $e,generalVolumeThumb as Ue,pomodoroVolumeContainer2 as Ye,pomodoroVolumeBar2 as Ke,pomodoroVolumeThumb2 as Qe,flowmodoroVolumeContainer2 as qe,flowmodoroVolumeBar2 as Ge,flowmodoroVolumeThumb2 as Je,generalVolumeContainer2 as Xe,generalVolumeBar2 as eo,generalVolumeThumb2 as oo,flowmodoroRadios as to,flowmodoroInputs as no,generalRadios as ro,pomodoroInputs as io,pomodoroRadios as ao,flowtimeBackgroundCells as so,chilltimeBackgroundCells as lo,settings_menu_container as co,registerHereText as uo,flowAnimation as mo,chillAnimation as N,createLabelInput as go,updateLabelInput as fo,emojiContainer as po,loginEmailInput as ho,loginPasswordInput as Io,loginBtn as yo,logoutBtn as wo,forgotPasswordSettings as vo,propagateUnfinishedTasks as To,propagateUnfinishedTasksInfoWindow as ko,flowtimeBackgroundWorldCells as So,chilltimeBackgroundWorldCells as bo,popupOverlay as Eo,logoutBtn2 as Po,deepWorkBackground as Bo,breakBackground as Lo,streaksContainer as C,streaksLoginSuggestionPopup as xo,previousSessionStartedOkBtn as No,previousSessionStartedPopup as Co,invalidatePreviousSessionInput as Mo,quitCurrentSessionInput as Ao,toggleIntervalTime as Fo,intervalTimeInfoWindow as Do,toggleTotalTime as Ho,totalTimeInfoWindow as Oo,intervalTimeToggle as Wo,totalTimeToggle as jo,stopwatch as e,muffinInfoWindow as Vo,toggleMuffin as _o,cats as Ro,zzz as Zo,darkContainer as zo,lightContainer as $o,flowmodoroBtnContainer as Uo,popupQuestionMenu as Yo}from"../modules/dom-elements.js";import{sessionState as M}from"../modules/state-objects.js";import{state as Ko,flags as Qo}from"../modules/navigation-objects.js";import{labelFlags as qo,labelArrs as Go}from"../modules/notes-objects.js";import{initializeGUI as Jo}from"../utility/initialize-gui.js";import{userAgent as Xo,userDevice as et,userTimeZone as ot}from"../utility/identification.js";import{updateUserSettings as A}from"../state/update-settings.js";import{updateTargetHours as tt}from"../state/update-target-hours.js";import{updateShowingTimeLeft as nt}from"../state/update-showing-time-left.js";import{lastIntervalSwitch as rt}from"../state/last-interval-switch.js";import{checkSession as it}from"../state/check-session.js";import{updateInvaliDate as at}from"../state/update-invaliDate.js";import{initialVisualReset as st,sessionReset as lt}from"./end-session.js";let pomodoroWorker=new Worker("/js/web-workers/pomodoroWorker.js"),suggestionWorker=new Worker("/js/web-workers/suggestionWorker.js"),flowmodoroWorker=new Worker("/js/web-workers/flowmodoroWorker.js"),displayWorker=new Worker("/js/web-workers/displayWorker.js"),totalDisplayWorker=new Worker("/js/web-workers/totalDisplayWorker.js"),observer=new MutationObserver(yn);async function dt(e){Fe.classList.remove("selected-background"),Me.classList.add("selected-background"),h.darkThemeActivated=!1,deactivateDarkTheme(a,s,de,E,ce,ue,me,ge,fe,t,d,po,e,C,r),$o.style.display="none",zo.style.display="flex",M.loggedIn&&await A({backgroundsThemes:{darkThemeActivated:h.darkThemeActivated}})}async function ct(e){Fe.classList.add("selected-background"),Me.classList.remove("selected-background"),h.darkThemeActivated=!0,activateDarkTheme(a,s,de,E,ce,ue,me,ge,fe,pe,he,t,d,po,C,i),zo.style.display="none",$o.style.display="flex",M.loggedIn&&await A({backgroundsThemes:{darkThemeActivated:h.darkThemeActivated}})}function hideCat(e,o){h.muffinToggle&&(ut(e,o),mt(o))}function ut(e,o){document.getElementById([e[o.catIdsArrIndex]]).style.display="none",document.getElementById([e[o.catIdsArrIndex]]).style.opacity="0"}function mt(e){7===e.catIdsArrIndex?e.catIdsArrIndex=0:e.catIdsArrIndex++}function gt(e,o){h.muffinToggle&&(document.getElementById([e[o.catIdsArrIndex]]).style.display="block",setTimeout(()=>{document.getElementById([e[o.catIdsArrIndex]]).style.opacity="1"},0))}function ft(o){for(let e=o.length-1;0<e;e--){var t=Math.floor(Math.random()*(e+1));[o[e],o[t]]=[o[t],o[e]]}return o}function totalTimeToggleGUIUpdate(){jo.checked?(h.totalTimeToggle=!0,S.style.display="block"):(h.totalTimeToggle=!1,S.style.display="none")}function intervalTimeToggleGUIUpdate(){Wo.checked?(h.intervalTimeToggle=!0,de.style.height="350px",e.style.display="block"):(h.intervalTimeToggle=!1,de.style.height="150px",e.style.display="none")}function pt(e,o){h.modeChangeExecuted||(h.modeChangeExecuted=!0,e||o||new Notification(kt(p,I)),cn(T.Chime,T.Bell,f.pomodoro,g.pomodoro),0!==p.currentPomodoroIntervalIndex||h.pomodoroCountIncremented||(p.pomodorosCompleted++,h.pomodoroCountIncremented=!0),u.lastPomNotification=Date.now(),h.inHyperFocus&&h.autoStartBreakInterval||!h.inHyperFocus&&h.autoStartPomodoroInterval?setTimeout(()=>{k.click()},0):k.classList.add("glowing-effect"))}function ht(){var e=Date.now(),o=new Date(e),t=new Date(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours()),o=new Date(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours()-1);It(e,t)&&updateDataPerHour(y,t,o,n)}function It(e,o){return e-o.getTime()<=1e3}function updateDataPerHour(o,t,n,r){if(!(t<=new Date(u.beginning)||r[n.toISOString()])){var i=yt(o.transitionTime,t,n),t=wt(o.interruptionTime,t,n);let e;t={inDeepWork:e=0<i,distractions:t,deepWorkTime:i},i=(r[n.toISOString()]=t,n),t=new Date(n);t.setHours(t.getHours()-1),updateDataPerHour(o,i,t,r)}}function yt(e,o,t){let n=!1;var r=[],i=o.getTime(),a=t.getTime();let s=0;for(;e[s]<i&&s<e.length;)e[s]>=a&&(s%2==1?n?(r.push(e[s]-e[s-1]),n=!1):r.push(e[s]-a):n=!0),s++;o=e.length-1,e[o]<i&&o%2==0&&(e[o]<a?r.push(i-a):r.push(i-e[e.length-1])),t=r.reduce((e,o)=>e+o,0);return t}function wt(e,o,t){var n=o.getTime(),r=t.getTime();let i=0,a=0;for(;e[a]<n&&a<e.length;)e[a]>=r&&i++,a++;return i}async function vt(){M.loggedIn&&(1===p.startStop&&await it(),await Tn(p.startStop,z.start))}function updateLabelArrs(e,o,t){for(var n in o)t[n]||(t[n]=[]),o[n]&&t[n].push(e)}function Tt(e,o,t,n,r,i,a,flowmodoroWorker,suggestionWorker,s,l){e.pomodoroNotificationToggle?60*o.currentPomodoroNotification*1e3<1e3*Math.floor((Date.now()-t.local)/1e3)+1e3&&!e.modeChangeExecuted&&Wt(s,l):(e.flowmodoroNotificationToggle&&!e.inHyperFocus&&60*o.currentFlowmodoroNotification*1e3<1e3*Math.floor((Date.now()-t.local)/1e3)+1e3&&!e.sentFlowmodoroNotification&&(flowmodoroWorker.postMessage("clearInterval"),Ht(r,o,t,i,a,s,l),e.sentFlowmodoroNotification=!0,n.classList.add("glowing-effect")),e.breakSuggestionToggle&&e.inHyperFocus&&60*r.suggestionMinutes*1e3<1e3*Math.floor((Date.now()-t.local)/1e3)+1e3&&!e.sentSuggestionMinutesNotification&&(suggestionWorker.postMessage("clearInterval"),Dt(r,t,i,a,s,l),e.sentSuggestionMinutesNotification=!0,n.classList.add("glowing-effect")))}function kt(e,o){let t;return t=h.inHyperFocus&&6!==e.currentPomodoroIntervalOrderIndex?1==o.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]?"It's been "+e.currentPomodoroNotification+" minute! Are you ready to take a short break?":"It's been "+e.currentPomodoroNotification+" minutes! Are you ready to take a short break?":6==e.currentPomodoroIntervalOrderIndex?1==o.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]?"It's been "+e.currentPomodoroNotification+" minute! Are you ready to take a long break?":"It's been "+e.currentPomodoroNotification+" minutes! Are you ready to take a long break?":1==o.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]?"It's been "+e.currentPomodoroNotification+" minute! Are you ready to start your Pomodoro Interval?":"It's been "+e.currentPomodoroNotification+" minutes! Are you ready to start your Pomodoro Interval?"}function St(e,o,t,n,r){let i=e["target"];Object.keys(t).forEach(e=>{i.id!==""+o+e+"Input"&&i.id!==""+o+e+"Input2"||(pauseAndResetAlertSounds(t.Bell,t.Chime),n[o]="NoAlert"===e?"none":e.toLowerCase(),"NoAlert"!==e?(Yt(t[e],o,r),document.getElementById(""+o+e+"Input").checked=!0,document.getElementById(""+o+e+"Input2").checked=!0):(document.getElementById(o+"NoAlertInput").checked=!0,document.getElementById(o+"NoAlertInput2").checked=!0),bt(o,e))})}async function bt(e,o){let t;t="bell"===o.toLowerCase()||"chime"===o.toLowerCase()?o.toLowerCase():"none",M.loggedIn&&("flowmodoro"===e?await A({chillTime:{alertSound:t}}):"general"===e?await A({flowTime:{alertSound:t}}):await A({pomodoro:{alertSound:t}}))}function Et(e,o,t,n,pomodoroWorker){o.pomodoroNotificationSeconds=60*t.currentPomodoroNotification,pomodoroWorker.postMessage("clearInterval"),pomodoroWorker.postMessage(o.pomodoroNotificationSeconds)}function Pt(e,o,t,n,flowmodoroWorker,suggestionWorker){e.inHyperFocus?(e.breakSuggestionToggle&&(o.suggestionSeconds=60*n.suggestionMinutes,suggestionWorker.postMessage(o.suggestionSeconds)),e.flowmodoroNotificationToggle&&flowmodoroWorker.postMessage("clearInterval")):(e.flowmodoroNotificationToggle&&(o.flowmodoroNotificationSeconds=60*t.currentFlowmodoroNotification,flowmodoroWorker.postMessage(o.flowmodoroNotificationSeconds)),e.breakSuggestionToggle&&suggestionWorker.postMessage("clearInterval"))}function Bt(e,o){let t;return t=1===e.currentPomodoroIntervalOrderIndex?"Short Break #1 | "+String(o.pomodoroIntervalArr[1])+" min":3===e.currentPomodoroIntervalOrderIndex?"Short Break #2 | "+String(o.pomodoroIntervalArr[1])+" min":5===e.currentPomodoroIntervalOrderIndex?"Short Break #3 | "+String(o.pomodoroIntervalArr[1])+" min":7===e.currentPomodoroIntervalOrderIndex?"Long Break | "+String(o.pomodoroIntervalArr[2])+" min":"Break Mode"}function Lt(e,o,t,n,pomodoroWorker){o.pomodoroNotificationSeconds=60*t.currentPomodoroNotification,pomodoroWorker.postMessage("clearInterval"),pomodoroWorker.postMessage(o.pomodoroNotificationSeconds)}function xt(e,o){let t;return t=1===e.currentPomodoroIntervalOrderIndex?"Short Break #1 | "+String(o.pomodoroIntervalArr[1])+" min":3===e.currentPomodoroIntervalOrderIndex?"Short Break #2 | "+String(o.pomodoroIntervalArr[1])+" min":5===e.currentPomodoroIntervalOrderIndex?"Short Break #3 | "+String(o.pomodoroIntervalArr[1])+" min":"Break Mode"}function Nt(e,o){let t;return t=0===e.currentPomodoroIntervalOrderIndex?"Pomodoro #1 | "+String(o.pomodoroIntervalArr[0])+" min":2===e.currentPomodoroIntervalOrderIndex?"Pomodoro #2 | "+String(o.pomodoroIntervalArr[0])+" min":4===e.currentPomodoroIntervalOrderIndex?"Pomodoro #3 | "+String(o.pomodoroIntervalArr[0])+" min":6===e.currentPomodoroIntervalOrderIndex?"Pomodoro #4 | "+String(o.pomodoroIntervalArr[0])+" min":"Pomodoro Mode"}function Ct(e,o,t){animationsFadeOut(o),e.chillTimeAnimationToggle&&animationsFadeIn(t,"flex")}function Mt(e,o,t,n){1<e.startStop&&animationsFadeOut(t),o.flowTimeAnimationToggle&&animationsFadeIn(n,"block")}function At(e,o,t,n){o.local=Date.now()}function Ft(e,o,t){e.pomodoroNotificationToggle&&"Break"!==o.textContent&&Rt(t)}function Dt(e,o,t,n,r,i){let a;a=1<e.suggestionMinutes?"Need a break? You've been hard at work for "+String(e.suggestionMinutes)+" minutes!":"Need a break? You've been hard at work for "+String(e.suggestionMinutes)+" minute!",r||i||new Notification(a),o.lastBreakSuggestionNotification=Date.now(),cn(T.Chime,T.Bell,t.general,n.general)}function Ht(e,o,t,n,r,i,a){let s;s=1==e.breakTimeSuggestionsArr[o.currentFlowmodoroBreakIndex]?"It's been "+o.currentFlowmodoroNotification+" minute! Are you ready to get back into Flow Time?":"It's been "+o.currentFlowmodoroNotification+" minutes! Are you ready to get back into Flow Time?",i||a||new Notification(s),t.lastFlowmodoroNotification=Date.now(),cn(T.Chime,T.Bell,n.flowmodoro,r.flowmodoro)}function Ot(e,o,t,n,r,i,a,s){let l;0==o.currentPomodoroIntervalOrderIndex||2==o.currentPomodoroIntervalOrderIndex||4==o.currentPomodoroIntervalOrderIndex?(l=1==t.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]?"It's been "+o.currentPomodoroNotification+" minute! Are you ready to take a short break?":"It's been "+o.currentPomodoroNotification+" minutes! Are you ready to take a short break?",i.pomodoroCountIncremented||(o.pomodorosCompleted++,i.pomodoroCountIncremented=!0)):6==o.currentPomodoroIntervalOrderIndex?(l=1==t.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]?"It's been "+o.currentPomodoroNotification+" minute! Are you ready to take a long break?":"It's been "+o.currentPomodoroNotification+" minutes! Are you ready to take a long break?",i.pomodoroCountIncremented||(o.pomodorosCompleted++,i.pomodoroCountIncremented=!0)):l=1==t.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]?"It's been "+o.currentPomodoroNotification+" minute! Are you ready to start your Pomodoro Interval?":"It's been "+o.currentPomodoroNotification+" minutes! Are you ready to start your Pomodoro Interval?",a||s||new Notification(l),cn(T.Chime,T.Bell,n.pomodoro,r.pomodoro),e.lastPomNotification=Date.now()}function Wt(e,o){pt(e,o),pomodoroWorker.postMessage("clearInterval")}function jt(e){e.currentPomodoroIntervalIndex=0,e.currentPomodoroIntervalOrderIndex=0}function Vt(e,o,t){e.textContent="Pomodoros",o.textContent=t.pomodorosCompleted}function _t(e,o,t,n){e.style.display="flex",Vt(o,t,n)}function hidePomodorosCompletedContainer(e){e.style.display="none"}function Rt(e){7===e.currentPomodoroIntervalOrderIndex?e.currentPomodoroIntervalOrderIndex=0:e.currentPomodoroIntervalOrderIndex++}function Zt(e,o){0===e.currentPomodoroIntervalOrderIndex||2===e.currentPomodoroIntervalOrderIndex||4===e.currentPomodoroIntervalOrderIndex||6===e.currentPomodoroIntervalOrderIndex?(e.currentPomodoroIntervalIndex=0,e.currentPomodoroNotification=o.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]):1===e.currentPomodoroIntervalOrderIndex||3===e.currentPomodoroIntervalOrderIndex||5===e.currentPomodoroIntervalOrderIndex?(e.currentPomodoroIntervalIndex=1,e.currentPomodoroNotification=o.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]):7===e.currentPomodoroIntervalOrderIndex&&(e.currentPomodoroIntervalIndex=2,e.currentPomodoroNotification=o.pomodoroIntervalArr[e.currentPomodoroIntervalIndex])}async function zt(e,o,t,n,r,i,a){"pomodoroInput"===e.target.id?(a[0]=t,o.pomodoroIntervalArr[0]=t,0===n.currentPomodoroIntervalIndex&&0!==n.startStop&&i.pomodoroNotificationToggle&&i.inHyperFocus&&(r.innerText=Nt(n,o))):"shortBreakInput"===e.target.id?(a[1]=t,o.pomodoroIntervalArr[1]=t,1===n.currentPomodoroIntervalIndex&&0!==n.startStop&&i.pomodoroNotificationToggle&&(r.innerText=xt(n,o))):"longBreakInput"===e.target.id&&(a[2]=t,o.pomodoroIntervalArr[2]=t,2===n.currentPomodoroIntervalIndex)&&0!==n.startStop&&i.pomodoroNotificationToggle&&(r.innerText="Long Break | "+String(o.pomodoroIntervalArr[2])+" min"),M.loggedIn&&await A({pomodoro:{intervalArr:a}})}function F(e,o,t){var n=t[o];n?e.classList.remove("infoWindowOpacity"):e.classList.add("infoWindowOpacity"),t[o]=!n}function $t(e,o,t,n){e=Math.floor((Date.now()-e.hyperFocus)/1e3);o.inHyperFocus?(t.suggestionSeconds=60*n.suggestionMinutes-e,suggestionWorker.postMessage("clearInterval"),suggestionWorker.postMessage(t.suggestionSeconds)):t.suggestionSeconds=60*n.suggestionMinutes}function Ut(e){return 720<e?e=720:(e<1||isNaN(e)||void 0===e)&&(e=1),e}function Yt(e,o,t){"flowmodoro"===o?e.volume=t.flowmodoro:"general"===o?e.volume=t.general:"pomodoro"===o&&(e.volume=t.pomodoro),e.play()}function pauseAndResetAlertSounds(e,o){e.pause(),e.currentTime=0,o.pause(),o.currentTime=0}async function o(e,o,t,n,r,i,a,s){e=e.getBoundingClientRect(),a=(a.clientX-e.left)/e.width,a=Math.max(0,Math.min(1,a));t.style.left=100*a+"%",n.style.width=100*a+"%",r.style.left=100*a+"%",i.style.width=100*a+"%",s.flowmodoroThumbIsDragging||s.flowmodoroThumbIsDragging2?o.flowmodoro=a:s.generalThumbIsDragging||s.generalThumbIsDragging2?o.general=a:(s.pomodoroThumbIsDragging||s.pomodoroThumbIsDragging2)&&(o.pomodoro=a)}function D(e,o){h[o]=!0,e.preventDefault()}function Kt(e){"touchmove"===e.type&&(e=e.touches[0]),h.flowmodoroThumbIsDragging?o(_e,g,Ze,Re,Je,Ge,e,h):h.flowmodoroThumbIsDragging2?o(qe,g,Ze,Re,Je,Ge,e,h):h.generalThumbIsDragging?o(ze,g,Ue,$e,oo,eo,e,h):h.generalThumbIsDragging2?o(Xe,g,Ue,$e,oo,eo,e,h):h.pomodoroThumbIsDragging?o(We,g,Ve,je,Qe,Ke,e,h):h.pomodoroThumbIsDragging2&&o(Ye,g,Ve,je,Qe,Ke,e,h)}function Qt(e){"touchend"===e.type&&(e=e.changedTouches[0]),h.flowmodoroThumbIsDragging||h.flowmodoroThumbIsDragging2?qt("flowmodoro","flowmodoroThumbIsDragging","flowmodoroThumbIsDragging2"):h.generalThumbIsDragging||h.generalThumbIsDragging2?qt("general","generalThumbIsDragging","generalThumbIsDragging2"):h.pomodoroThumbIsDragging||h.pomodoroThumbIsDragging2?qt("pomodoro","pomodoroThumbIsDragging","pomodoroThumbIsDragging2"):"flowmodoroAlert"!==e.target.className&&"generalAlert"!==e.target.className&&"pomodoroAlert"!==e.target.className&&"volume-thumb"!==e.target.className&&"block"===document.getElementById("settingsContainer").style.display&&pauseAndResetAlertSounds(T.Bell,T.Chime)}async function qt(e,o,t){"chime"===f[e]?(pauseAndResetAlertSounds(T.Bell,T.Chime),Yt(T.Chime,e,g)):"bell"===f[e]&&(pauseAndResetAlertSounds(T.Bell,T.Chime),Yt(T.Bell,e,g)),h[o]=!1,h[t]=!1,M.loggedIn&&((o={})["pomodoro"===e?"pomodoro":"general"===e?"flowTime":"chillTime"]={alertVolume:g[e]},await A(o))}function Gt(e){for(var[o,t]of Object.entries(e))document.getElementById(t).style.display="none",document.getElementById(o).classList.remove("selected")}function Jt(e){for(var[o,t]of Object.entries(e))document.getElementById(t).style.display="block"}function Xt(t,e,o){var n=window.innerWidth||document.documentElement.clientWidth;if(en(n,o),n<=650)Jt(t);else{for(let[e,o]of Object.entries(t))document.getElementById(e).addEventListener("click",function(){Gt(t),document.getElementById(o).style.display="block",this.classList.add("selected")});"block"===document.getElementById("settingsContainer").style.display&&document.getElementById(e.lastSettingsSelectionId).click()}}function en(e,o){o.innerText=e<=536?"End":"End Session"}function on(e,o,t,n,r,i){e.style.display="flex",tn(i,r,n),rn(i,o,t,r)}function tn(e,o,t){90<=e.lastHyperFocusIntervalMin?o.currentFlowmodoroNotification=t.breakTimeSuggestionsArr[3]:50<=e.lastHyperFocusIntervalMin?o.currentFlowmodoroNotification=t.breakTimeSuggestionsArr[2]:25<=e.lastHyperFocusIntervalMin?o.currentFlowmodoroNotification=t.breakTimeSuggestionsArr[1]:o.currentFlowmodoroNotification=t.breakTimeSuggestionsArr[0]}async function nn(e,o,t,n,r){"flowmodoroBreakInput1"===e.target.id?(r[0]=t,o.breakTimeSuggestionsArr[0]=t,n.currentFlowmodoroBreakIndex=0):"flowmodoroBreakInput2"===e.target.id?(r[1]=t,o.breakTimeSuggestionsArr[1]=t,n.currentFlowmodoroBreakIndex=1):"flowmodoroBreakInput3"===e.target.id?(r[2]=t,o.breakTimeSuggestionsArr[2]=t,n.currentFlowmodoroBreakIndex=2):"flowmodoroBreakInput4"===e.target.id&&(r[3]=t,o.breakTimeSuggestionsArr[3]=t,n.currentFlowmodoroBreakIndex=3),M.loggedIn&&await A({chillTime:{intervalArr:r}})}function rn(e,o,t,n){e.flowmodoroNotificationToggle?o.textContent="🔔 Break":o.textContent="Suggested Break",t.textContent=n.currentFlowmodoroNotification+" min"}function hideSuggestionBreakContainer(e,o){e.style.display="none"}function an(e){e.style.display="none"}function showInterruptionsSubContainer(e){e.style.display="block"}function sn(e,o,t){t.push(o.interruptions),ln(o,e)}function ln(e,o){e.interruptions=0,o.textContent=e.interruptions}function dn(){var e=Date.now(),e=new Date(e);return(e.getHours()%12||12)+`:${String(e.getMinutes()).padStart(2,"0")} `+(12<=e.getHours()?"PM":"AM")}function cn(e,o,t,n){pauseAndResetAlertSounds(T.Bell,T.Chime),"chime"===t?(e.volume=n,e.play().then(()=>{}).catch(e=>{})):"bell"===t&&(o.volume=n,o.play().then(()=>{}).catch(e=>{}))}async function un(){return"Notification"in window?"denied"===Notification.permission||"granted"===await Notification.requestPermission():(alert("This browser does not support push notifications"),!1)}async function mn(e,o,t){e.submittedTarget=!1,t.targetTime=null,document.getElementById("target-hours").remove();e=document.createElement("input");e.type="number",e.id="target-hours",e.name="hours",e.min="0",e.value="",document.getElementById("coolDiv").appendChild(e),e.focus(),document.getElementById("target-hours-submit").textContent="Submit",o.loggedIn&&await tt(0)}function gn(e,o,t,n,r,i){var a=Math.round(100*parseFloat(e))/100;return!(!e||a<=0||24<a||60*a*60*1e3<=getTotalElapsed(r,n.hyperFocus,t))||(0!==i.startStop?r.inHyperFocus?alert("Enter a valid target time between "+Math.ceil(100*parseFloat((n.hyperFocus+(Date.now()-t.local))/o.msPerHour))/100+" hours and 24 hours"):r.inHyperFocus||alert("Enter a valid target time between "+Math.ceil(100*parseFloat(n.hyperFocus/o.msPerHour))/100+" hours and 24 hours"):0===i.startStop&&alert("Enter a valid target time between 0.01 hours and 24 hours"),!1)}function setButtonTextAndMode(e,o,t,n){e.innerText=t,o.innerText=n}function updateProgressBar(o,t,n,r,i,a){if(isNaN(o.targetTime)||null===o.targetTime||!r.submittedTarget)i.classList.contains("fullopacity1")&&(i.classList.remove("fullopacity1"),setTimeout(()=>{i.style.width="0%"},500));else{i.classList.contains("fullopacity1")||i.classList.add("fullopacity1");let e=getTotalElapsed(r,n.hyperFocus,t)/o.targetTime;1<e&&(e=1),0!==o.targetTime&&1<=e&&!r.hitTarget&&(r.hitTarget=!0,setTimeout(()=>{1==r.targetReachedToggle&&new Notification("Congrats! You've hit your target time!")},1),a.classList.add("glowing-effect")),i.style.width=100*e+"%"}}function resetDisplay(e){e.innerText="00:00:00"}function fn(e,o,t,n,r){var i=Date.now();ln(n,r),e.beginning=i,t.start=i,o.sessionInProgress=!0,wn(),document.getElementById("target-hours").classList.remove("glowing-effect")}function pn(e,o){1==o.transitionClockSoundToggle&&(e.volume=.25,e.play())}function hn(e,o,t,n,r,i){"Enter"!==e.key||i.enterKeyDown||"home"!==Ko.lastSelectedMode?"ArrowLeft"!==e.key&&e.key:(e.preventDefault(),i.enterKeyDown=!0,"target-hours"===document.activeElement.id?t.click():document.activeElement===Io?yo.click():document.activeElement===n||document.activeElement===r||"noteInput"==document.activeElement.className||"note-task-input-text"==document.activeElement.id||"note-task-input-text-edit"===document.activeElement.id||Qo.sessionSummaryPopupShowing||Qo.sessionSummarySignupPromptPopupShowing||o.click())}function In(e,o){"Enter"===e.key&&o.enterKeyDown&&(o.enterKeyDown=!1)}function returnTotalTimeString(e,o){var t=Math.floor(e/o.msPerHour),n=Math.floor((e-t*o.msPerHour)/o.msPerMin),e=Math.floor((e-t*o.msPerHour-n*o.msPerMin)/o.msPerSec);return String(t)+" hours, "+String(n)+" minutes, "+String(e)+" seconds"}function getTotalElapsed(e,o,t){return e.inHyperFocus?o+(Date.now()-t.local):o}function yn(){document.title=document.getElementById("display").innerText}function wn(){document.title=document.getElementById("display").innerText,observer.observe(document.getElementById("display"),{childList:!0,subtree:!0,characterData:!0})}function setFavicon(e){var o=document.getElementById("favicon1"),t=document.getElementById("favicon2");o.href=e,t.href=e}function vn(e){var o=document.getElementById("mainContainer"),t=document.createElement("div");t.style.width="50px",t.style.height="50px",t.style.backgroundColor=e,t.style.position="absolute",t.style.innerText="Debugging Square",t.style.top="500px",t.style.left="100px",o.appendChild(t)}async function Tn(e,o){await rt(e,o)}function triggerSilentAlertAudioMobile(e,o,t,n,r){r.triggeredSilentAudio||(e.volume=0,o.volume=0,e.muted=!0,o.muted=!0,e.play().then(()=>{e.pause(),e.muted=!1,e.currentTime=0}).catch(e=>{}),o.play().then(()=>{o.pause(),o.muted=!1,o.currentTime=0}).catch(e=>{}),t=new Audio(t),n=new Audio(n),T.Chime=t,T.Bell=n,r.triggeredSilentAudio=!0)}function setInitialBackgroundCellSelection(){document.getElementById(d.flowtime).classList.add("selected-background"),document.getElementById(d.chilltime).classList.add("selected-background")}function setBackground(e,o){""===e?(Bo.style.opacity=0,Lo.style.opacity=0):h.inHyperFocus?(Lo.style.opacity=0,Bo.style.backgroundImage=e,Bo.style.opacity=o):(Lo.style.backgroundImage=e,Lo.style.opacity=1)}function deactivateDarkTheme(e,o,t,n,r,i,a,s,l,d,c,u,m,g,f){let p="rgba(0, 0, 0, 0.9)";var h="rgb(0, 0, 0)";[e,o,t,a,s,l,g].forEach(function(e){e.style.backgroundColor=p,e!==g&&(e.style.border=null)}),r.style.backgroundColor=m?h:p,r.style.border=null,a.style.marginTop="0px",n.style.backgroundColor="rgba(255, 255, 255, 0.25)",n.style.border="1px rgba(0, 0, 0, 0.25)",i.style.backgroundColor=h,u.style.backgroundColor="#000000",u.style.border="5px solid #FFFFFF",document.documentElement.style.backgroundImage=f,"black-flowtime"===c.flowtime&&"black-chilltime"===c.chilltime&&(document.getElementById(d.flowtime).click(),document.getElementById(d.chilltime).click())}async function activateDarkTheme(e,o,t,n,r,i,a,s,l,d,c,u,m,g,f,p){r=[r,i,g];[e,o,t,n,a,s,l,f].forEach(function(e){e.style.backgroundColor="rgba(32, 32, 32, 0.9)",e.style.border="3px solid rgb(255, 255, 255)"}),r.forEach(function(e){e.style.backgroundColor="rgba(32, 32, 32, 1)"}),g.style.border="5px solid white",a.style.marginTop="-3px",document.documentElement.style.backgroundImage=p,M.updatingState||(u.flowtime=m.flowtime,u.chilltime=m.chilltime,M.loggedIn&&await A({backgroundsThemes:{flowTimeBackgroundTemp:m.flowtime,chillTimeBackgroundTemp:m.chilltime}}),d.click(),c.click())}function replaceTargetHours(e,o,t){e=Math.round(100*parseFloat(e))/100,o.targetTime=60*e*60*1e3,document.getElementById("target-hours").remove(),o=document.createElement("h4");return o.textContent=e,o.id="target-hours",o.className="finalized-hours",o.style.backgroundColor="#5c5c5c",document.getElementById("coolDiv").appendChild(o),document.getElementById("target-hours-submit").textContent="Change",t.submittedTarget=!0,e}function totalTimeDisplay(t,n,r,i,a,s,l){var n=1e3*Math.round(getTotalElapsed(a,n.hyperFocus,t)/1e3),t=(864e5<=n&&setTimeout(()=>{q.click()},0),Math.floor(n/i.msPerHour)),d=Math.floor((n-t*i.msPerHour)/i.msPerMin),c=Math.floor((n-t*i.msPerHour-d*i.msPerMin)/i.msPerSec),t=String(t).padStart(2,"0"),d=String(d).padStart(2,"0"),c=String(c).padStart(2,"0");if(a.submittedTarget){let e=n/s.targetTime;1<e&&(e=1);var u=t+`:${d}:`+c+" ("+Math.trunc(100*e)+"%) completed",n=(l.defaultTimeStr=u,s.targetTime-n),m=Math.floor(n/i.msPerHour),g=Math.floor((n-m*i.msPerHour)/i.msPerMin),i=Math.ceil((n-m*i.msPerHour-g*i.msPerMin)/i.msPerSec),m=String(m).padStart(2,"0"),g=String(g).padStart(2,"0"),i=String(i).padStart(2,"0");let o;n=n/s.targetTime;o=a.hitTarget?"00:00:00 (0%) remaining":`${m}:${g}:${i} (${Math.ceil(100*n)}%) remaining`,l.targetTimeLeftStr=o,l.showingTimeLeft?r.textContent=o:r.textContent=u}else r.textContent=t+`:${d}:`+c}async function animationsFadeIn(e,o){"home"===Ko.lastSelectedMode&&(e.classList.add("intoOpacityTransition"),e.style.display=o)}function animationsFadeOut(e){e.classList.remove("intoOpacityTransition"),setTimeout(()=>{e.style.display="none"},0)}document.addEventListener("click",function(e){e.target.classList.contains("finalized-hours")&&Q.click()}),document.addEventListener("stateUpdated",function(){var r=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),i=(e=navigator.userAgent||window.opera,/iPad/.test(e)||1<navigator.maxTouchPoints),e=window.innerWidth||document.documentElement.clientWidth,o=[{radios:to,type:"flowmodoro"},{radios:ro,type:"general"},{radios:ao,type:"pomodoro"}];i&&(Yo.style.background="rgb(50, 50, 50)",accountPopup.style.background="rgb(50, 50, 50)",deleteAccountPopup.style.background="rgb(50, 50, 50)",shortcutsPopup.style.background="rgb(50, 50, 50)"),en(e,q),window.scrollTo({top:0,behavior:"smooth"}),r&&(ce.style.backgroundColor="rgb(0, 0, 0)"),setInitialBackgroundCellSelection();let t=document.getElementById("threeWayToggle");!r&&504<e?(setTimeout(()=>{B.style.opacity="1",B.classList.add("hyperChillTitleAnimationTranslate")},0),setTimeout(()=>{X.style.opacity="1",B.classList.add("hyperChillTitleAnimationScale")},1e3),setTimeout(()=>{X.style.transition="opacity 0.5s ease-in-out",B.classList.remove("hyperChillTitleAnimationTranslate"),B.style.opacity="0",setTimeout(()=>{B.style.display="none",t.style.display="inline-flex",t.classList.add("threeWayToggleAnimation"),setTimeout(()=>{t.style.opacity="1"},100)},1e3)},2e3)):(r||e<=504)&&setTimeout(()=>{B.style.display="none",X.style.opacity="1",X.style.transition="opacity 0.5s ease-in-out",t.style.display="inline-flex",setTimeout(()=>{t.style.opacity="1"},100)},1e3),setTimeout(()=>{0===p.startStop&&animationsFadeIn(N,"flex")},3e3),document.addEventListener("keydown",e=>hn(e,k,Q,go,fo,h)),document.addEventListener("keyup",e=>In(e,h)),k.addEventListener("click",function(){var e=Date.now();p.startStop++,pn(K,h),resetDisplay(J),updateLabelArrs(e,qo,Go),1===p.startStop?(fn(u,h,z,p,ne),triggerSilentAlertAudioMobile(T.Chime,T.Bell,U,Y,h),animationsFadeOut(N),u.lastPomNotification=Date.now(),ft(v),setTimeout(()=>{document.documentElement.style.backgroundSize="100%",h.canEndSession=!0},1e3)):Ft(h,b,p),vt(),At(h,u,j,V),displayWorker.postMessage("clearInterval"),displayWorker.postMessage("startInterval"),k.classList.remove("glowing-effect"),h.pomodoroCountIncremented=!1,y.transitionTime.push(e),W.main?(h.inHyperFocus=!1,h.lastHyperFocusIntervalMin=Math.floor((Date.now()-u.hyperFocus)/6e4),u.chillTime=Date.now(),p.chillTimeIntervals++,setFavicon("/images/logo/HyperChillLogoBlue.png"),Ct(h,mo,N),gt(v,p),sn(ne,p,Z),an(ee),setBackground(l.chilltime,1),e=Date.now()-u.hyperFocus,y.flowTime.push(e),m.hyperFocus,m.hyperFocus+=Date.now()-u.hyperFocus,h.autoStartBreakInterval||pauseAndResetAlertSounds(T.Bell,T.Chime),h.pomodoroNotificationToggle?(_t(ae,se,le,p),Zt(p,I),Et(h,m,p,j,pomodoroWorker),setButtonTextAndMode(k,b,"Switch",Bt(p,I))):(on(re,ie,L,I,p,h),setButtonTextAndMode(k,b,"Switch","Break")),totalTimeDisplay(u,m,S,c,h,I,w),Pt(h,m,p,I,flowmodoroWorker,suggestionWorker),clearInterval(W.main),W.main=null,totalDisplayWorker.postMessage("clearInterval")):(h.inHyperFocus=!0,h.sentFlowmodoroNotification=!1,p.flowTimeIntervals++,u.hyperFocus=Date.now(),e=u.hyperFocus-u.chillTime,2<p.startStop&&y.chillTime.push(e),totalDisplayWorker.postMessage("startInterval"),setFavicon("/images/logo/HyperChillLogoGreen.png"),Mt(p,h,N,mo),hideSuggestionBreakContainer(re,ie,L),hidePomodorosCompletedContainer(ae),showInterruptionsSubContainer(ee),Zt(p,I),setBackground(l.flowtime,1),Pt(h,m,p,I,flowmodoroWorker,suggestionWorker),W.main=setInterval(()=>updateProgressBar(I,u,m,h,G,P),1e3),h.autoStartPomodoroInterval||pauseAndResetAlertSounds(T.Bell,T.Chime),h.pomodoroNotificationToggle?(setButtonTextAndMode(k,b,"Switch",Nt(p,I)),Lt(h,m,p,V,pomodoroWorker)):setButtonTextAndMode(k,b,"Switch","Deep Work"),1<p.startStop&&(m.chillTime+=Date.now()-u.chillTime,hideCat(v,p))),h.sentSuggestionMinutesNotification=!1,setTimeout(()=>{h.modeChangeExecuted=!1},1e3)}),Q.addEventListener("click",async function(){var e;h.submittedTarget?h.submittedTarget&&(h.hitTarget&&P.classList.remove("glowing-effect"),mn(h,M,I),updateProgressBar(I,u,m,h,G,P),totalTimeDisplay(u,m,S,c,h,I,w),h.progressBarContainerIsSmall||(E.classList.toggle("small"),h.progressBarContainerIsSmall=!0)):gn(e=document.getElementById("target-hours").value,c,u,m,h,p)&&(h.hitTarget&&P.classList.remove("glowing-effect"),e=replaceTargetHours(e,I,h),M.loggedIn&&await tt(e),h.progressBarContainerIsSmall&&(E.classList.toggle("small"),h.progressBarContainerIsSmall=!1),updateProgressBar(I,u,m,h,G,P),totalTimeDisplay(u,m,S,c,h,I,w),h.hitTarget=!1)}),we.addEventListener("change",async function(){var e=we.value,e=Ut(Math.round(parseFloat(e)));we.value=e,I.suggestionMinutes=e;let o;o=0===p.startStop?0:Math.round((Date.now()-u.hyperFocus)/1e3),h.sentSuggestionMinutesNotification=!1,h.breakSuggestionToggle&&($t(u,h,m,I),60*e>o?(h.sentSuggestionMinutesNotification=!1,k.classList.remove("glowing-effect")):(h.sentSuggestionMinutesNotification=!0,k.classList.add("glowing-effect"))),M.loggedIn&&await A({flowTime:{suggestionMinutes:e}})}),oe.addEventListener("click",function(){0<p.interruptions&&(p.interruptions--,ne.textContent=p.interruptions,h.sessionInProgress)&&y.interruptionTime.pop()}),te.addEventListener("click",function(){var e;p.interruptions<1e3&&(p.interruptions++,ne.textContent=p.interruptions,h.sessionInProgress)&&(e=Date.now(),y.interruptionTime.push(e))});for(let[e,o]of Object.entries(R))document.getElementById(e).addEventListener("click",function(){Gt(R),document.getElementById(o).style.display="block",this.classList.add("selected"),_.lastSettingsSelectionId=e});function a(e,o,t,n){e.flowmodoroNotificationToggle&&1<p.startStop&&!e.inHyperFocus&&(60*o.breakTimeSuggestionsArr[p.currentFlowmodoroBreakIndex]>t?(n.classList.remove("glowing-effect"),e.sentFlowmodoroNotification=!1):(n.classList.add("glowing-effect"),e.sentFlowmodoroNotification=!0))}function s(e,o,t){o<60*e?t.classList.remove("glowing-effect"):t.classList.add("glowing-effect")}function n(){fetch("/api/state/logout",{method:"POST"}).then(()=>{M.loggedIn=!1,window.location.href="/"}).catch(e=>{})}Ee.addEventListener("click",function(){F(Pe,"showingPomodoroNotificationInfoWindow",h)}),Te.addEventListener("click",function(){F(ke,"showingFlowmodoroNotificationInfoWindow",h)}),Se.addEventListener("click",function(){F(be,"showingFlowTimeBreakNotificationInfoWindow",h)}),Fo.addEventListener("click",function(){F(Do,"showingIntervalTimeInfoWindow",h)}),Ho.addEventListener("click",function(){F(Oo,"showingTotalTimeInfoWindow",h)}),_o.addEventListener("click",function(){F(Vo,"showingMuffinInfoWindow",h)}),Be.addEventListener("click",function(){F(Le,"showingNotesAutoSwitchInfoWindow",h)}),To.addEventListener("click",function(){F(ko,"showingPropagateUnfinishedTasksInfoWindow",h)}),Ze.addEventListener("mousedown",e=>D(e,"flowmodoroThumbIsDragging")),Ze.addEventListener("touchstart",e=>D(e,"flowmodoroThumbIsDragging")),Ue.addEventListener("mousedown",e=>D(e,"generalThumbIsDragging")),Ue.addEventListener("touchstart",e=>D(e,"generalThumbIsDragging")),Ve.addEventListener("mousedown",e=>D(e,"pomodoroThumbIsDragging")),Ve.addEventListener("touchstart",e=>D(e,"pomodoroThumbIsDragging")),Je.addEventListener("mousedown",e=>D(e,"flowmodoroThumbIsDragging2")),Je.addEventListener("touchstart",e=>D(e,"flowmodoroThumbIsDragging2")),oo.addEventListener("mousedown",e=>D(e,"generalThumbIsDragging2")),oo.addEventListener("touchstart",e=>D(e,"generalThumbIsDragging2")),Qe.addEventListener("mousedown",e=>D(e,"pomodoroThumbIsDragging2")),Qe.addEventListener("touchstart",e=>D(e,"pomodoroThumbIsDragging2")),document.addEventListener("mousemove",Kt),document.addEventListener("touchmove",Kt),document.addEventListener("mouseup",Qt),document.addEventListener("touchend",Qt),no.forEach(e=>{e.addEventListener("change",function(e){var o=Ut(Math.round(e.target.value));document.getElementById(e.target.id).value=o;let t;var n=[...I.breakTimeSuggestionsArr];nn(e,I,o,p,n),tn(h,p,I),0===p.startStop||h.inHyperFocus?(m.flowmodoroNotificationSeconds=60*p.currentFlowmodoroNotification,t=0):(t=Math.round((Date.now()-u.chillTime)/1e3),m.flowmodoroNotificationSeconds=60*p.currentFlowmodoroNotification-t,flowmodoroWorker.postMessage("clearInterval"),flowmodoroWorker.postMessage(m.flowmodoroNotificationSeconds)),(0===p.currentFlowmodoroBreakIndex&&"flowmodoroBreakInput1"===e.target.id||1===p.currentFlowmodoroBreakIndex&&"flowmodoroBreakInput2"===e.target.id||2===p.currentFlowmodoroBreakIndex&&"flowmodoroBreakInput3"===e.target.id||3===p.currentFlowmodoroBreakIndex&&"flowmodoroBreakInput4"===e.target.id)&&a(h,I,t,k),L.textContent=p.currentFlowmodoroNotification+" min"})}),io.forEach(e=>{e.addEventListener("change",async function(e){var o=Ut(Math.round(e.target.value));document.getElementById(e.target.id).value=o;let t;var n=[...I.pomodoroIntervalArr];h.inHyperFocus?(t=Math.round((Date.now()-u.hyperFocus)/1e3),"pomodoroInput"===e.target.id&&(h.modeChangeExecuted=!1,s(o,t,k))):(t=Math.round((Date.now()-u.chillTime)/1e3),("shortBreakInput"===e.target.id&&1===p.currentPomodoroIntervalIndex||"longBreakInput"===e.target.id&&2===p.currentPomodoroIntervalIndex)&&(h.modeChangeExecuted=!1,s(o,t,k))),zt(e,I,o,p,b,h,n),Zt(p,I),0===p.startStop?m.pomodoroNotificationSeconds=60*p.currentPomodoroNotification:h.pomodoroNotificationToggle&&(m.pomodoroNotificationSeconds=60*p.currentPomodoroNotification-t,pomodoroWorker.postMessage("clearInterval"),pomodoroWorker.postMessage(m.pomodoroNotificationSeconds))})}),o.forEach(o=>{o.radios.forEach(e=>{e.addEventListener("change",e=>St(e,o.type,T,f,g))})}),[...so,...So].forEach(e=>{e.addEventListener("click",async function(e){var o=e.target.id,t=d.flowtime;document.getElementById(t).classList.remove("selected-background"),l.flowtime=H[o],d.flowtime=o,document.getElementById(e.target.id).classList.add("selected-background"),h.inHyperFocus&&setBackground(l.flowtime,1),M.loggedIn&&await A({backgroundsThemes:{flowTimeBackground:d.flowtime}})})}),[...lo,...bo].forEach(e=>{e.addEventListener("click",async function(e){var o=e.target.id,t=d.chilltime;document.getElementById(t).classList.remove("selected-background"),l.chilltime=O[o],d.chilltime=o,document.getElementById(e.target.id).classList.add("selected-background"),!h.inHyperFocus&&1<=p.startStop&&setBackground(l.chilltime,1),M.loggedIn&&await A({backgroundsThemes:{chillTimeBackground:d.chilltime}})})}),Ie.addEventListener("click",async function(){Ie.checked?(un(),h.targetReachedToggle=!0):h.targetReachedToggle=!1,M.loggedIn&&await A({flowTime:{targetTimeReachedToggle:h.targetReachedToggle}})}),ye.addEventListener("click",async function(){ye.checked?(un(),h.breakSuggestionToggle=!0,h.inHyperFocus?setButtonTextAndMode(k,b,"Switch","Deep Work"):setButtonTextAndMode(k,b,"Switch","Break"),jt(p),x.checked&&x.click(),I.suggestionMinutes=we.value,$t(u,h,m,I)):(h.breakSuggestionToggle=!1,suggestionWorker.postMessage("clearInterval"),k.classList.remove("glowing-effect")),M.loggedIn&&await A({flowTime:{notificationToggle:h.breakSuggestionToggle}})}),ve.addEventListener("click",async function(){var e;ve.checked?(un(),jt(p),x.checked&&x.click(),e=Math.floor((Date.now()-u.chillTime)/1e3),h.inHyperFocus||0===p.startStop||(m.flowmodoroNotificationSeconds=60*p.currentFlowmodoroNotification-e,flowmodoroWorker.postMessage("clearInterval"),flowmodoroWorker.postMessage(m.flowmodoroNotificationSeconds)),h.flowmodoroNotificationToggle=!0):(h.flowmodoroNotificationToggle=!1,flowmodoroWorker.postMessage("clearInterval"),k.classList.remove("glowing-effect")),M.loggedIn&&await A({chillTime:{notificationToggle:h.flowmodoroNotificationToggle}}),rn(h,ie,L,p)}),x.addEventListener("click",async function(){var e,o;x.checked?(un(),jt(p),ve.checked&&ve.click(),ye.checked&&ye.click(),e=Math.floor((Date.now()-u.hyperFocus)/1e3),h.inHyperFocus&&(o="Pomodoro #1 | "+String(I.pomodoroIntervalArr[0])+" min",setButtonTextAndMode(k,b,"Switch",o),m.pomodoroNotificationSeconds=60*p.currentPomodoroNotification-e,pomodoroWorker.postMessage(m.pomodoroNotificationSeconds)),h.pomodoroNotificationToggle=!0):(h.pomodoroNotificationToggle=!1,pomodoroWorker.postMessage("clearInterval"),k.classList.remove("glowing-effect"),h.inHyperFocus?setButtonTextAndMode(k,b,"Switch","Deep Work"):1<p.startStop&&(setButtonTextAndMode(k,b,"Switch","Break"),hidePomodorosCompletedContainer(ae),on(re,ie,L,I,p,h))),rn(h,ie,L,p),M.loggedIn&&await A({pomodoro:{notificationToggle:h.pomodoroNotificationToggle}})}),xe.addEventListener("click",async function(){h.autoStartPomodoroInterval?h.autoStartPomodoroInterval&&(h.autoStartPomodoroInterval=!1):(h.autoStartPomodoroInterval=!0,h.modeChangeExecuted=!1),M.loggedIn&&await A({pomodoro:{autoStartPomToggle:h.autoStartPomodoroInterval}})}),Ne.addEventListener("click",async function(){h.autoStartBreakInterval?h.autoStartBreakInterval&&(h.autoStartBreakInterval=!1):(h.autoStartBreakInterval=!0,h.modeChangeExecuted=!1),M.loggedIn&&await A({pomodoro:{autoStartBreakToggle:h.autoStartBreakInterval}})}),De.addEventListener("click",async function(){De.checked?h.transitionClockSoundToggle=!0:h.transitionClockSoundToggle=!1,M.loggedIn&&await A({sounds:{transitionClockSound:h.transitionClockSoundToggle}})}),He.addEventListener("click",async function(){He.checked?(h.flowTimeAnimationToggle=!0,h.inHyperFocus&&animationsFadeIn(mo,"block")):(h.flowTimeAnimationToggle=!1,h.inHyperFocus&&animationsFadeOut(mo)),M.loggedIn&&await A({backgroundsThemes:{flowTimeAnimation:h.flowTimeAnimationToggle}})}),Oe.addEventListener("click",async function(){Oe.checked?(h.chillTimeAnimationToggle=!0,!h.inHyperFocus&&1<p.startStop&&animationsFadeIn(N,"flex")):(h.chillTimeAnimationToggle=!1,h.inHyperFocus||animationsFadeOut(N)),M.loggedIn&&await A({backgroundsThemes:{chillTimeAnimation:h.chillTimeAnimationToggle}})}),Ce.addEventListener("click",async function(){dt(r)}),Ae.addEventListener("click",async function(){ct(r)}),zo.addEventListener("click",async function(){ct(r)}),$o.addEventListener("click",async function(){dt(r)}),window.addEventListener("resize",function(){Xt(R,_,q)}),co.addEventListener("click",function(){setTimeout(()=>{Xt(R,_,q)},0)}),uo.addEventListener("click",function(){window.location.href="/signup"}),wo.addEventListener("click",async function(){n()}),Po.addEventListener("click",function(){n()}),yo.addEventListener("click",async function(){var e,o;o=ho.value,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)?(ho.value,Io.value,o=ho.value,e=Io.value,fetch("/api/api/validateUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{email:o,password:e},userAgent:Xo,userDevice:et,userTimeZone:ot})}).then(o=>{if(o.ok)return o.json();if(429===o.status)return o.json().then(e=>{throw alert(e.message),new Error(`HTTP error! Status: ${o.status} - `+e.message)});throw alert("Your email or password is incorrect. Please try again."),new Error("HTTP error! Status: "+o.status)}).then(e=>{!0===e.loginSuccess&&Jo()}).catch(e=>{})):alert("Invalid email address. Please try again.")}),vo.addEventListener("click",function(){window.location.href="/reset-password"}),P.addEventListener("mouseover",function(){(!E.classList.contains("small")&&1<=p.startStop||0===p.startStop&&h.submittedTarget)&&(P.style.cursor="pointer")}),P.addEventListener("mouseout",function(){(!E.classList.contains("small")&&1<=p.startStop||0===p.startStop&&h.submittedTarget)&&(P.style.cursor="default")}),P.addEventListener("click",async function(){(!E.classList.contains("small")&&1<=p.startStop||0===p.startStop&&h.submittedTarget)&&h.totalTimeToggle&&(w.showingTimeLeft?(w.showingTimeLeft=!1,S.textContent=w.defaultTimeStr):(w.showingTimeLeft=!0,S.textContent=w.targetTimeLeftStr),M.loggedIn)&&await nt(w.showingTimeLeft)}),C.addEventListener("mouseover",function(){M.loggedIn||Qo.popupQuestionWindowShowing||(C.style.cursor="pointer",xo.style.opacity=1,xo.style.zIndex=35)}),C.addEventListener("mouseout",function(){M.loggedIn||Qo.popupQuestionWindowShowing||(xo.style.opacity=0,xo.style.zIndex=0)}),C.addEventListener("click",function(){M.loggedIn||Qo.popupQuestionWindowShowing||(window.location.href="/login")}),No.addEventListener("click",function(){Eo.style.display="none",Co.style.display="none",Co.style.opacity="0",Mo.checked?at(u.beginning):(st($),lt(!1),Ao.checked=!1,Mo.checked=!0)}),Wo.addEventListener("click",async function(){intervalTimeToggleGUIUpdate(),M.loggedIn&&await A({display:{intervalTime:h.intervalTimeToggle}})}),jo.addEventListener("click",async function(){totalTimeToggleGUIUpdate(),M.loggedIn&&await A({display:{totalTime:h.totalTimeToggle}})}),muffinToggle.addEventListener("click",async function(){muffinToggle.checked?(h.muffinToggle=!0,h.inHyperFocus||gt(v,p)):(h.muffinToggle=!1,h.inHyperFocus||ut(v,p)),M.loggedIn&&await A({display:{muffinToggle:h.muffinToggle}})}),Ro.forEach(e=>{e.addEventListener("click",function(){var e;h.canTriggerZZZ&&(h.canTriggerZZZ=!1,e=`rotateZ(-${Math.floor(30*Math.random())}deg)`,Zo.style.transform=e,Zo.style.display="block",setTimeout(()=>{Zo.style.opacity=1,setTimeout(()=>{Zo.style.opacity=0,setTimeout(()=>{Zo.style.display="none",h.canTriggerZZZ=!0},250)},1e3)},0))})}),L.addEventListener("click",function(){co.click(),setTimeout(()=>{Uo.click()},0)}),pomodoroWorker.onmessage=function(e){pt(r,i)},suggestionWorker.onmessage=function(e){h.sentSuggestionMinutesNotification||(Dt(I,u,f,g,r,i),h.sentSuggestionMinutesNotification=!0,k.classList.add("glowing-effect"))},flowmodoroWorker.onmessage=function(e){h.sentFlowmodoroNotification||(Ht(I,p,u,f,g,r,i),h.sentFlowmodoroNotification=!0,k.classList.add("glowing-effect"))},displayWorker.onmessage=function(e){var o=1e3*Math.round((Date.now()-u.local)/1e3),t=Math.floor(o/c.msPerHour),n=Math.floor((o-t*c.msPerHour)/c.msPerMin),o=Math.floor((o-t*c.msPerHour-n*c.msPerMin)/c.msPerSec),t=String(t).padStart(2,"0"),n=String(n).padStart(2,"0"),o=String(o).padStart(2,"0");J.textContent=t+`:${n}:`+o,ht(),Tt(h,p,u,k,I,f,g,flowmodoroWorker,suggestionWorker,r,i)},totalDisplayWorker.onmessage=function(e){totalTimeDisplay(u,m,S,c,h,I,w)}});export{pomodoroWorker,suggestionWorker,flowmodoroWorker,displayWorker,totalDisplayWorker,observer,hideCat,totalTimeToggleGUIUpdate,intervalTimeToggleGUIUpdate,updateDataPerHour,updateLabelArrs,hidePomodorosCompletedContainer,pauseAndResetAlertSounds,hideSuggestionBreakContainer,showInterruptionsSubContainer,setButtonTextAndMode,updateProgressBar,resetDisplay,returnTotalTimeString,getTotalElapsed,setFavicon,triggerSilentAlertAudioMobile,setInitialBackgroundCellSelection,setBackground,deactivateDarkTheme,activateDarkTheme,replaceTargetHours,totalTimeDisplay,animationsFadeIn,animationsFadeOut};