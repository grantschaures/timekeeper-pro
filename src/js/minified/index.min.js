import{flowtimeBackgrounds,chilltimeBackgrounds,selectedBackground,selectedBackgroundIdTemp,selectedBackgroundId,timeConvert,intervals,startTimes,recoverBreakState,recoverPomState,elapsedTime,alertVolumes,alertSounds,counters,flags,tempStorage,settingsMappings,savedInterruptionsArr,timeAmount}from"../modules/index-objects.js";import{chime,bell,clock_tick,soundMap}from"../modules/sound-map.js";import{start_stop_btn,submit_change_btn,end_session_btn,report_btn,total_time_display,productivity_chill_mode,progressBarContainer,progressBar,progressContainer,display,hyperChillTitle,subMainContainer,interruptionsContainer,interruptionsSubContainer,decBtn,incBtn,interruptionsNum,suggestionBreakContainer,suggestionBreak_label,suggestionBreak_min,completedPomodorosContainer,completedPomodoros_label,completedPomodoros_min,targetHoursContainer,timekeepingContainer,popupMenu,settingsContainer,notesContainer,aboutContainer,blogContainer,blackFlowtimeBackground,blackChilltimeBackground,targetTimeReachedToggle,breakSuggestionToggle,suggestionMinutesInput,flowmodoroNotificationToggle,flowmodoroNotifications,flowmodoroNotificationInfoWindow,flowTimeBreakNotification,flowTimeBreakNotificationInfoWindow,pomodoroNotifications,pomodoroNotificationInfoWindow,notesAutoSwitch,notesAutoSwitchInfoWindow,pomodoroNotificationToggle,autoStartPomodoroIntervalToggle,autoStartBreakIntervalToggle,defaultThemeContainer,defaultTheme,darkThemeContainer,darkGrayTheme,targetTimeReachedAlert,transitionClockSoundToggle,flowTimeAnimationToggle,chillTimeAnimationToggle,pomodoroVolumeContainer,pomodoroVolumeBar,pomodoroVolumeThumb,flowmodoroVolumeContainer,flowmodoroVolumeBar,flowmodoroVolumeThumb,generalVolumeContainer,generalVolumeBar,generalVolumeThumb,pomodoroVolumeContainer2,pomodoroVolumeBar2,pomodoroVolumeThumb2,flowmodoroVolumeContainer2,flowmodoroVolumeBar2,flowmodoroVolumeThumb2,generalVolumeContainer2,generalVolumeBar2,generalVolumeThumb2,flowmodoroRadios,flowmodoroInputs,generalRadios,pomodoroInputs,pomodoroRadios,flowtimeBackgroundCells,chilltimeBackgroundCells,settings_menu_container,registerHereText,backgroundVideoSource,backgroundVideo,flowAnimation,chillAnimation,hyperChillLogoImage,createLabelInput,updateLabelInput,emojiContainer,loginEmailInput,loginPasswordInput,forgotPasswordContainer,loginBtnContainer,loginBtn,logoutBtn,forgotPasswordSettings}from"../modules/dom-elements.js";import{initializeGUI}from"../utility/initialize_gui.js";import{sessionState}from"../modules/state-objects.js";import{updateUserSettings}from"../modules/update-settings.js";const pomodoroWorker=new Worker("/js/displayWorkers/pomodoroWorker.js"),suggestionWorker=new Worker("/js/displayWorkers/suggestionWorker.js"),flowmodoroWorker=new Worker("/js/displayWorkers/flowmodoroWorker.js"),displayWorker=new Worker("/js/displayWorkers/displayWorker.js"),totalDisplayWorker=new Worker("/js/displayWorkers/totalDisplayWorker.js");function timeRecovery(o,e,t,n,r,a,i,s,l,d,m,c,u,g,f,p,I,h,T,v){o.pomodoroNotificationToggle?!o.inHyperFocus&&60*e.currentPomodoroNotification*1e3<1e3*Math.floor((Date.now()-t.local)/1e3)+1e3&&!o.modeChangeExecuted?(o.modeChangeExecuted=!0,o.autoSwitchedModes=!1,chillTimeRecovery(o,e,n,t,r,a,s,l,d,m,c,u,g,f,p,I,h)):o.inHyperFocus&&60*e.currentPomodoroNotification*1e3<1e3*Math.floor((Date.now()-t.local)/1e3)+1e3&&!o.modeChangeExecuted&&(o.modeChangeExecuted=!0,o.autoSwitchedModes=!1,flowTimeRecovery(o,e,n,s,t,r,i,u,g,f,p)):(o.flowmodoroNotificationToggle&&!o.inHyperFocus&&60*e.currentFlowmodoroNotification*1e3<1e3*Math.floor((Date.now()-t.local)/1e3)+1e3&&!o.sentFlowmodoroNotification&&(T.postMessage("clearInterval"),sendFlowmodoroNotification(s,e,t,u,g,f,p),o.sentFlowmodoroNotification=!0,r.classList.add("glowing-effect")),o.breakSuggestionToggle&&o.inHyperFocus&&60*s.suggestionMinutes*1e3<1e3*Math.floor((Date.now()-t.local)/1e3)+1e3&&!o.sentSuggestionMinutesNotification&&(v.postMessage("clearInterval"),sendSuggestionBreakNotification(s,t,u,g,f,p),o.sentSuggestionMinutesNotification=!0,r.classList.add("glowing-effect")))}function getPomodoroNotificationString(o,e){let t;return t=0==o.currentPomodoroIntervalOrderIndex||2==o.currentPomodoroIntervalOrderIndex||4==o.currentPomodoroIntervalOrderIndex?1==e.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]?"It's been "+o.currentPomodoroNotification+" minute! Are you ready to take a short break?":"It's been "+o.currentPomodoroNotification+" minutes! Are you ready to take a short break?":6==o.currentPomodoroIntervalOrderIndex?1==e.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]?"It's been "+o.currentPomodoroNotification+" minute! Are you ready to take a long break?":"It's been "+o.currentPomodoroNotification+" minutes! Are you ready to take a long break?":1==e.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]?"It's been "+o.currentPomodoroNotification+" minute! Are you ready to start your Pomodoro Interval?":"It's been "+o.currentPomodoroNotification+" minutes! Are you ready to start your Pomodoro Interval?"}function handleRadioChange(o,e,t,n,r,a,i){const s=o["target"];Object.keys(t).forEach(o=>{s.id!==""+e+o+"Input"&&s.id!==""+e+o+"Input2"||(pauseAndResetAlertSounds(n,r),a[e]="NoAlert"===o?"none":o.toLowerCase(),"NoAlert"!==o?(playAlertSound(t[o],e,i),document.getElementById(""+e+o+"Input").checked=!0,document.getElementById(""+e+o+"Input2").checked=!0):(document.getElementById(e+"NoAlertInput").checked=!0,document.getElementById(e+"NoAlertInput2").checked=!0),setUserAlertSound(e,o))})}async function setUserAlertSound(o,e){let t;t="bell"===e.toLowerCase()||"chime"===e.toLowerCase()?e.toLowerCase():"none",sessionState.loggedIn&&("flowmodoro"===o?await updateUserSettings({chillTime:{alertSound:t}}):"general"===o?await updateUserSettings({flowTime:{alertSound:t}}):await updateUserSettings({pomodoro:{alertSound:t}}))}function setPomodoroNotificationSeconds(o,e,t,n,r){o.inRecoveryBreak&&!o.autoStartPomodoroInterval?e.pomodoroNotificationSeconds=Math.round(60*t.currentPomodoroNotification-(n.displayTime/1e3-1)):e.pomodoroNotificationSeconds=60*t.currentPomodoroNotification,r.postMessage("clearInterval"),r.postMessage(e.pomodoroNotificationSeconds)}function recoverToBreakUpdateProgressBarAndTotalElapsed(o,e,t,n,r,a){o.inRecoveryBreak&&(setTimeout(()=>{updateProgressBar(e,t,n,o,r,a)},1e3),getTotalElapsed(o,n.hyperFocus,t)<e.targetTime)&&(a.classList.remove("glowing-effect"),o.hitTarget=!1)}function setHyperFocusElapsedTime(o,e,t,n,r){o+=60*e.pomodoroIntervalArr[t.currentPomodoroIntervalIndex]*1e3,n.autoSwitchedModes&&(r.hyperFocus=o),e=r.hyperFocus;r.hyperFocus=1e3*Math.round(e/1e3)}function flowmodoroAndBreakSuggestionActions(o,e,t,n,r,a){o.inHyperFocus?(o.breakSuggestionToggle&&(e.suggestionSeconds=60*n.suggestionMinutes,a.postMessage(e.suggestionSeconds)),o.flowmodoroNotificationToggle&&r.postMessage("clearInterval")):(o.flowmodoroNotificationToggle&&(e.flowmodoroNotificationSeconds=60*t.currentFlowmodoroNotification,r.postMessage(e.flowmodoroNotificationSeconds)),o.breakSuggestionToggle&&a.postMessage("clearInterval"))}function setBothBreakIntervalText(o,e){let t;return t=1===o.currentPomodoroIntervalOrderIndex?"Short Break #1 | "+e.pomodoroIntervalArr[1].toString()+" min":3===o.currentPomodoroIntervalOrderIndex?"Short Break #2 | "+e.pomodoroIntervalArr[1].toString()+" min":5===o.currentPomodoroIntervalOrderIndex?"Short Break #3 | "+e.pomodoroIntervalArr[1].toString()+" min":7===o.currentPomodoroIntervalOrderIndex?"Long Break | "+e.pomodoroIntervalArr[2].toString()+" min":"Break Mode"}function setPomodoroWorker(o,e,t,n,r){!o.inRecoveryPom||o.autoStartPomodoroInterval&&o.autoStartBreakInterval?e.pomodoroNotificationSeconds=60*t.currentPomodoroNotification:e.pomodoroNotificationSeconds=Math.round(60*t.currentPomodoroNotification-(n.displayTime/1e3-1)),r.postMessage("clearInterval"),r.postMessage(e.pomodoroNotificationSeconds)}function setBreakIntervalText(o,e){let t;return t=1===o.currentPomodoroIntervalOrderIndex?"Short Break #1 | "+e.pomodoroIntervalArr[1].toString()+" min":3===o.currentPomodoroIntervalOrderIndex?"Short Break #2 | "+e.pomodoroIntervalArr[1].toString()+" min":5===o.currentPomodoroIntervalOrderIndex?"Short Break #3 | "+e.pomodoroIntervalArr[1].toString()+" min":"Break Mode"}function setPomodoroIntervalText(o,e){let t;return t=0===o.currentPomodoroIntervalOrderIndex?"Pomodoro #1 | "+e.pomodoroIntervalArr[0].toString()+" min":2===o.currentPomodoroIntervalOrderIndex?"Pomodoro #2 | "+e.pomodoroIntervalArr[0].toString()+" min":4===o.currentPomodoroIntervalOrderIndex?"Pomodoro #3 | "+e.pomodoroIntervalArr[0].toString()+" min":6===o.currentPomodoroIntervalOrderIndex?"Pomodoro #4 | "+e.pomodoroIntervalArr[0].toString()+" min":"Pomodoro Mode"}function chillTimeAnimationActions(o,e,t){animationsFadeOut(e),o.chillTimeAnimationToggle&&animationsFadeIn(t,"flex")}function flowTimeAnimationActions(o,e,t,n){1<o.startStop&&animationsFadeOut(t),e.flowTimeAnimationToggle&&animationsFadeIn(n,"block")}function setLocalStartTime(o,e,t,n){o.inRecoveryBreak?e.local=t.localStartTime:o.inRecoveryPom?e.local=n.localStartTime:e.local=Date.now()}function chillTimeToFirstPomodoro(o,e,t){o.pomodoroNotificationToggle&&"Chill Time"!==e.textContent&&iterateCurrentPomodoroIntervalOrderIndex(t)}function activateDarkTheme(o,e,t,n,r,a,i,s,l,d,m,c,u,g){r=[r,a,g];[o,e,t,n,i,s,l].forEach(function(o){o.style.backgroundColor="rgba(32, 32, 32, 0.9)",o.style.border="3px solid rgb(255, 255, 255)"}),r.forEach(function(o){o.style.backgroundColor="rgba(32, 32, 32, 1)"}),g.style.border="5px solid white",c.flowtime=u.flowtime,c.chilltime=u.chilltime,d.click(),m.click()}function sendSuggestionBreakNotification(o,e,t,n,r,a){let i;i=1<o.suggestionMinutes?"Need a break? You've been hard at work for "+o.suggestionMinutes.toString()+" minutes!":"Need a break? You've been hard at work for "+o.suggestionMinutes.toString()+" minute!",new Notification(i),e.lastBreakSuggestionNotification=Date.now(),playAlertSoundCountdown(t,n,r.general,a.general)}function sendFlowmodoroNotification(o,e,t,n,r,a,i){let s;s=1==o.breakTimeSuggestionsArr[e.currentFlowmodoroBreakIndex]?"It's been "+e.currentFlowmodoroNotification+" minute! Are you ready to get back into Flow Time?":"It's been "+e.currentFlowmodoroNotification+" minutes! Are you ready to get back into Flow Time?",new Notification(s),t.lastFlowmodoroNotification=Date.now(),playAlertSoundCountdown(n,r,a.flowmodoro,i.flowmodoro)}function sendPomodoroDelayNotification(o,e,t,n,r,a,i,s){let l;0==e.currentPomodoroIntervalOrderIndex||2==e.currentPomodoroIntervalOrderIndex||4==e.currentPomodoroIntervalOrderIndex?(l=1==t.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]?"It's been "+e.currentPomodoroNotification+" minute! Are you ready to take a short break?":"It's been "+e.currentPomodoroNotification+" minutes! Are you ready to take a short break?",s.pomodoroCountIncremented||(e.pomodorosCompleted++,s.pomodoroCountIncremented=!0)):6==e.currentPomodoroIntervalOrderIndex?(l=1==t.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]?"It's been "+e.currentPomodoroNotification+" minute! Are you ready to take a long break?":"It's been "+e.currentPomodoroNotification+" minutes! Are you ready to take a long break?",s.pomodoroCountIncremented||(e.pomodorosCompleted++,s.pomodoroCountIncremented=!0)):l=1==t.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]?"It's been "+e.currentPomodoroNotification+" minute! Are you ready to start your Pomodoro Interval?":"It's been "+e.currentPomodoroNotification+" minutes! Are you ready to start your Pomodoro Interval?",new Notification(l),playAlertSoundCountdown(n,r,a.pomodoro,i.pomodoro),o.lastPomNotification=Date.now()}function chillTimeRecovery(o,e,t,n,r,a,i,s,l,d,m,c,u,g,f,p,I){let h=Date.now()-n.local;var T={intervalIndex:e.currentPomodoroIntervalIndex,intervalOrderIndex:e.currentPomodoroIntervalOrderIndex,notification:e.currentPomodoroNotification},v=e.pomodorosCompleted,t=t.hyperFocus;let y=n.local;o.autoStartPomodoroInterval&&Math.round(h/1e3)-60*i.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]<=2&&30<(Date.now()-n.lastPomNotification)/1e3&&sendPomodoroDelayNotification(n,e,i,c,u,g,f,o),o.autoStartPomodoroInterval&&o.autoStartBreakInterval?(h-=60*i.pomodoroIntervalArr[T.intervalIndex]*1e3,7===T.intervalOrderIndex?T.intervalOrderIndex=0:T.intervalOrderIndex++,setCurrentPomodoroNotificationRecovery(T,i),y=Date.now(),n.hyperFocus=y,setRecoverPomState(a,h,v,t,y,e,o,r),setPomodoroIndexes(e,T)):o.autoStartPomodoroInterval?(h-=60*i.pomodoroIntervalArr[T.intervalIndex]*1e3,T.intervalOrderIndex++,setCurrentPomodoroNotificationRecovery(T,i),y=Date.now()-h,n.hyperFocus=y,setRecoverPomState(a,h,v,t,y,e,o,r),setPomodoroIndexes(e,T)):(Math.round(h/1e3)-60*i.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]<=2&&30<(Date.now()-n.lastPomNotification)/1e3&&(pomodoroWorker.postMessage("clearInterval"),sendPomodoroDelayNotification(n,e,i,c,u,g,f,o)),r.classList.add("glowing-effect"))}function flowTimeRecovery(o,e,t,n,r,a,i,s,l,d,m){let c=Date.now()-r.local;var u={intervalIndex:e.currentPomodoroIntervalIndex,intervalOrderIndex:e.currentPomodoroIntervalOrderIndex,notification:e.currentPomodoroNotification};let g=e.pomodorosCompleted,f=t.hyperFocus,p=r.local;o.autoStartBreakInterval&&Math.round(c/1e3)-60*n.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]<=2&&30<(Date.now()-r.lastPomNotification)/1e3&&sendPomodoroDelayNotification(r,e,n,s,l,d,m,o),o.autoStartPomodoroInterval&&o.autoStartBreakInterval?(c-=60*n.pomodoroIntervalArr[u.intervalIndex]*1e3,o.pomodoroCountIncremented||(g++,o.pomodoroCountIncremented=!0),u.intervalOrderIndex++,setCurrentPomodoroNotificationRecovery(u,n),f-=c,p=Date.now(),setRecoverBreakState(i,c,g,f,p,e,o,a),setPomodoroIndexes(e,u)):o.autoStartBreakInterval?(c-=60*n.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]*1e3,o.pomodoroCountIncremented||(g++,o.pomodoroCountIncremented=!0),u.intervalOrderIndex++,setCurrentPomodoroNotificationRecovery(u,n),f-=c,p=Date.now()-c,setRecoverBreakState(i,c,g,f,p,e,o,a),setPomodoroIndexes(e,u)):Math.round(c/1e3)-60*n.pomodoroIntervalArr[e.currentPomodoroIntervalIndex]<=2&&30<(Date.now()-r.lastPomNotification)/1e3?(pomodoroWorker.postMessage("clearInterval"),sendPomodoroDelayNotification(r,e,n,s,l,d,m,o),a.classList.add("glowing-effect")):(a.classList.add("glowing-effect"),o.pomodoroCountIncremented||(e.pomodorosCompleted++,o.pomodoroCountIncremented=!0))}function recoveryDebuggingOutput(o,e,t,n,r){console.log(getCurrentTime()),console.log("Display Time (in seconds): "+Math.round(o/1e3)),console.log("Current Pomodoro Interval Index: "+e.intervalIndex),console.log("Current Pomodoro Interval Order Index: "+e.intervalOrderIndex),console.log("Pomodoros Completed: "+t),console.log("Elapsed Time In Hyper Focus: "+n),console.log("Local Start Time: "+r),console.log("")}function setRecoverBreakState(o,e,t,n,r,a,i,s){o.displayTime=e,o.pomodorosCompleted=t,o.hyperFocusElapsedTime=n,o.localStartTime=r,a.pomodorosCompleted<o.pomodorosCompleted&&(a.pomodorosCompleted=o.pomodorosCompleted),i.inRecoveryBreak=!0,s.click()}function setRecoverPomState(o,e,t,n,r,a,i,s){o.displayTime=e,o.pomodorosCompleted=t,o.hyperFocusElapsedTime=n,o.localStartTime=r,a.pomodorosCompleted=o.pomodorosCompleted,i.inRecoveryPom=!0,s.click()}function setPomodoroIndexes(o,e){o.currentPomodoroIntervalIndex=e.intervalIndex,o.currentPomodoroIntervalOrderIndex=e.intervalOrderIndex,o.currentPomodoroNotification=e.notification}function convertMinutesToTimeFormat(o){var e=Math.floor(o/60),t=o%60,o=Math.floor(60*(o-Math.floor(o)));return String(e).padStart(2,"0")+`:${String(t).padStart(2,"0")}:`+String(o).padStart(2,"0")}function resetPomodoroCounters(o){o.currentPomodoroIntervalIndex=0,o.currentPomodoroIntervalOrderIndex=0}function changeCompletedPomodorosContainerHeader(o,e,t){o.textContent="Pomodoros",e.textContent=t.pomodorosCompleted}function showPomodorosCompletedContainer(o,e,t,n){o.style.display="flex",changeCompletedPomodorosContainerHeader(e,t,n)}function hidePomodorosCompletedContainer(o){o.style.display="none"}function iterateCurrentPomodoroIntervalOrderIndex(o){7===o.currentPomodoroIntervalOrderIndex?o.currentPomodoroIntervalOrderIndex=0:o.currentPomodoroIntervalOrderIndex++}function setCurrentPomodoroNotification(o,e){0===o.currentPomodoroIntervalOrderIndex||2===o.currentPomodoroIntervalOrderIndex||4===o.currentPomodoroIntervalOrderIndex||6===o.currentPomodoroIntervalOrderIndex?(o.currentPomodoroIntervalIndex=0,o.currentPomodoroNotification=e.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]):1===o.currentPomodoroIntervalOrderIndex||3===o.currentPomodoroIntervalOrderIndex||5===o.currentPomodoroIntervalOrderIndex?(o.currentPomodoroIntervalIndex=1,o.currentPomodoroNotification=e.pomodoroIntervalArr[o.currentPomodoroIntervalIndex]):7===o.currentPomodoroIntervalOrderIndex&&(o.currentPomodoroIntervalIndex=2,o.currentPomodoroNotification=e.pomodoroIntervalArr[o.currentPomodoroIntervalIndex])}function setCurrentPomodoroNotificationRecovery(o,e){0===o.intervalOrderIndex||2===o.intervalOrderIndex||4===o.intervalOrderIndex||6===o.intervalOrderIndex?(o.intervalIndex=0,o.notification=e.pomodoroIntervalArr[o.intervalIndex]):1===o.intervalOrderIndex||3===o.intervalOrderIndex||5===o.intervalOrderIndex?(o.intervalIndex=1,o.notification=e.pomodoroIntervalArr[o.intervalIndex]):7===o.intervalOrderIndex&&(o.intervalIndex=2,o.notification=e.pomodoroIntervalArr[o.intervalIndex])}async function setPomodoroIntervalArr(o,e,t,n,r,a,i){"pomodoroInput"===o.target.id?(i[0]=t,e.pomodoroIntervalArr[0]=t,0===n.currentPomodoroIntervalIndex&&0!==n.startStop&&a.pomodoroNotificationToggle&&a.inHyperFocus&&(r.innerText=setPomodoroIntervalText(n,e))):"shortBreakInput"===o.target.id?(i[1]=t,e.pomodoroIntervalArr[1]=t,1===n.currentPomodoroIntervalIndex&&0!==n.startStop&&a.pomodoroNotificationToggle&&(r.innerText=setBreakIntervalText(n,e))):"longBreakInput"===o.target.id&&(i[2]=t,e.pomodoroIntervalArr[2]=t,2===n.currentPomodoroIntervalIndex)&&0!==n.startStop&&a.pomodoroNotificationToggle&&(r.innerText="Long Break | "+e.pomodoroIntervalArr[2].toString()+" min"),sessionState.loggedIn&&await updateUserSettings({pomodoro:{intervalArr:i}})}function animationsFadeIn(o,e){o.classList.add("intoOpacityTransition"),o.style.display=e}function animationsFadeOut(o){o.classList.remove("intoOpacityTransition"),setTimeout(()=>{o.style.display="none"},0)}function toggleInfoWindow(o,e,t){var n=t[e];n?o.classList.remove("infoWindowOpacity"):o.classList.add("infoWindowOpacity"),t[e]=!n}function setSuggestionMinutes(o,e,t,n,r,a,i,s,l,d){o=Math.floor((Date.now()-o.hyperFocus)/1e3);e.inHyperFocus?(t.suggestionSeconds=60*n.suggestionMinutes-o,suggestionWorker.postMessage("clearInterval"),suggestionWorker.postMessage(t.suggestionSeconds)):t.suggestionSeconds=60*n.suggestionMinutes}function validateAndSetNotificationInput(o){return 720<o?o=720:(o<1||isNaN(o)||void 0===o)&&(o=1),o}function playAlertSound(o,e,t){"flowmodoro"===e?o.volume=t.flowmodoro:"general"===e?o.volume=t.general:"pomodoro"===e&&(o.volume=t.pomodoro),o.play()}function pauseAndResetAlertSounds(o,e){o.pause(),o.currentTime=0,e.pause(),e.currentTime=0}async function alertVolumeChange(o,e,t,n,r,a,i,s){o=o.getBoundingClientRect(),i=(i.clientX-o.left)/o.width,i=Math.max(0,Math.min(1,i));t.style.left=100*i+"%",n.style.width=100*i+"%",r.style.left=100*i+"%",a.style.width=100*i+"%",s.flowmodoroThumbIsDragging||s.flowmodoroThumbIsDragging2?e.flowmodoro=i:s.generalThumbIsDragging||s.generalThumbIsDragging2?e.general=i:(s.pomodoroThumbIsDragging||s.pomodoroThumbIsDragging2)&&(e.pomodoro=i)}function hideAllSettingsContainers(o){for(var[e,t]of Object.entries(o))document.getElementById(t).style.display="none",document.getElementById(e).classList.remove("selected")}function showAllSettingsContainers(o){for(var[e,t]of Object.entries(o))document.getElementById(t).style.display="block"}function setInitialEndSessionBtnText(o,e){e.innerText=o<=504?"End":"End Session"}function handleViewportWidthChange(o,e,t){var n=window.innerWidth||document.documentElement.clientWidth,r=document.getElementById("end-session");if(r.innerText=n<=504?"End":"End Session",n<=650)showAllSettingsContainers(o);else{for(const[a,i]of Object.entries(o))document.getElementById(a).addEventListener("click",function(){hideAllSettingsContainers(o),document.getElementById(i).style.display="block",this.classList.add("selected")});"block"===document.getElementById("settingsContainer").style.display&&document.getElementById(e.lastSettingsSelectionId).click()}t&&(document.getElementById("pomodoroSettingsContainer").style.display="none",document.getElementById("flowmodoroSettingsContainer").style.display="none",document.getElementById("generalSettingsContainer").style.display="none")}function showSuggestionBreakContainer(o,e,t,n,r,a){o.style.display="flex",setCurrentFlowmodoroNotification(a,r,n),changeSuggestionBreakContainerHeader(a,e,t,r)}function setCurrentFlowmodoroNotification(o,e,t){90<=o.lastHyperFocusIntervalMin?e.currentFlowmodoroNotification=t.breakTimeSuggestionsArr[3]:50<=o.lastHyperFocusIntervalMin?e.currentFlowmodoroNotification=t.breakTimeSuggestionsArr[2]:25<=o.lastHyperFocusIntervalMin?e.currentFlowmodoroNotification=t.breakTimeSuggestionsArr[1]:e.currentFlowmodoroNotification=t.breakTimeSuggestionsArr[0]}async function setBreakTimeSuggestionsArr(o,e,t,n,r){"flowmodoroBreakInput1"===o.target.id?(r[0]=t,e.breakTimeSuggestionsArr[0]=t,n.currentFlowmodoroBreakIndex=0):"flowmodoroBreakInput2"===o.target.id?(r[1]=t,e.breakTimeSuggestionsArr[1]=t,n.currentFlowmodoroBreakIndex=1):"flowmodoroBreakInput3"===o.target.id?(r[2]=t,e.breakTimeSuggestionsArr[2]=t,n.currentFlowmodoroBreakIndex=2):"flowmodoroBreakInput4"===o.target.id&&(r[3]=t,e.breakTimeSuggestionsArr[3]=t,n.currentFlowmodoroBreakIndex=3),sessionState.loggedIn&&await updateUserSettings({chillTime:{intervalArr:r}})}function changeSuggestionBreakContainerHeader(o,e,t,n){o.flowmodoroNotificationToggle?e.textContent="Break":e.textContent="Suggested Break",t.textContent=n.currentFlowmodoroNotification+" min"}function hideSuggestionBreakContainer(o,e){o.style.display="none"}function hideInterruptionsSubContainer(o){o.style.display="none"}function showInterruptionsSubContainer(o){o.style.display="block"}function saveResetInterruptions(o,e,t){t.push(e.interruptions),e.interruptions=0,o.textContent=e.interruptions}function getCurrentTime(){var o=Date.now(),o=new Date(o);return(o.getHours()%12||12)+`:${o.getMinutes().toString().padStart(2,"0")} `+(12<=o.getHours()?"PM":"AM")}function playAlertSoundCountdown(o,e,t,n){"chime"===t?(o.volume=n,o.play()):"bell"===t&&(e.volume=n,e.play())}function detectBrowser(){var o=navigator.userAgent;return-1<o.indexOf("Firefox")?"Firefox":-1<o.indexOf("Safari")&&-1==o.indexOf("Chrome")?"Safari":-1<o.indexOf("Edg")?"Chromium-Edge":-1<o.indexOf("Edge")?"Legacy Edge":-1<o.indexOf("Chrome")?"Chrome":"Another browser"}async function enableNotifications(o,e,t,n){return"Notification"in window?"denied"===Notification.permission||"granted"===await Notification.requestPermission():(alert("This browser does not support desktop notifications or auto start functionality"),!1)}function changeTargetHours(o){document.getElementById("target-hours").remove();var e=document.createElement("input");e.type="number",e.id="target-hours",e.name="hours",e.min="0",e.value="",document.getElementById("coolDiv").appendChild(e),e.focus(),document.getElementById("target-hours-submit").textContent="Submit",o.submittedTarget=!1}function replaceTargetHours(o,e,t){var o=Math.round(100*parseFloat(o))/100,n=(e.targetTime=60*o*60*1e3,document.getElementById("target-hours").remove(),document.createElement("h4"));return n.textContent=o,n.id="target-hours",n.className="finalized-hours",n.style.backgroundColor="#5c5c5c",document.getElementById("coolDiv").appendChild(n),document.getElementById("target-hours-submit").textContent="Change",t.submittedTarget=!0,e.targetTime}function targetHoursValidate(o,e,t,n,r,a){var i=Math.round(100*parseFloat(o))/100;return!(!o||i<=0||24<i||60*i*60*1e3<=getTotalElapsed(r,n.hyperFocus,t))||(0!==a.startStop?r.inHyperFocus?alert("Enter a valid target time between "+Math.ceil(100*parseFloat((n.hyperFocus+(Date.now()-t.local))/e.msPerHour))/100+" hours and 24 hours"):r.inHyperFocus||alert("Enter a valid target time between "+Math.ceil(100*parseFloat(n.hyperFocus/e.msPerHour))/100+" hours and 24 hours"):0===a.startStop&&alert("Enter a valid target time between 0.01 hours and 24 hours"),!1)}function setButtonTextAndMode(o,e,t,n,r){o.innerText=n,e.innerText=r,t.inHyperFocus="Stop"===n}function updateProgressBar(e,t,n,r,a,i){if(isNaN(e.targetTime)||null===e.targetTime||!r.submittedTarget)a.classList.contains("fullopacity1")&&(a.classList.remove("fullopacity1"),setTimeout(()=>{a.style.width="0%"},500));else{a.classList.contains("fullopacity1")||a.classList.add("fullopacity1");let o=getTotalElapsed(r,n.hyperFocus,t)/e.targetTime;1<o&&(o=1),0!==e.targetTime&&1<=o&&!r.hitTarget&&(r.hitTarget=!0,setTimeout(()=>{1==r.targetReachedToggle&&new Notification("Congrats! You've hit your target time!")},1),i.classList.add("glowing-effect")),a.style.width=100*o+"%"}}function resetDisplay(o){o.innerText="00:00:00"}function veryStartActions(o,e,t,n){o.beginning=Date.now(),setBrowserTabTitle(),document.getElementById("target-hours").classList.remove("glowing-effect"),e.classList.add("hyperChillLogoRotate"),""!=document.getElementById("target-hours").value&&(""!=!document.getElementById("target-hours").value||n.submittedTarget)||(t.classList.toggle("small"),n.progressBarContainerIsSmall=!0)}function playClick(o,e){1==e.transitionClockSoundToggle&&(o.volume=.25,o.play())}function handleEnter(o,e,t,n,r,a){"Enter"!==o.key||a.enterKeyDown||(o.preventDefault(),a.enterKeyDown=!0,"target-hours"===document.activeElement.id?t.click():document.activeElement!==n&&document.activeElement!==r&&"noteInput"!=document.activeElement.className&&"note-task-input-text"!=document.activeElement.id&&"note-task-input-text-edit"!==document.activeElement.id&&(a.autoSwitchedModes=!1,e.click()))}function handleKeyUp(o,e){"Enter"===o.key&&e.enterKeyDown&&(e.enterKeyDown=!1)}function totalTimeDisplay(o,e,t,n,r,a){e=getTotalElapsed(r,e.hyperFocus,o);let i=Math.floor(e/n.msPerHour),s=Math.floor((e-i*n.msPerHour)/n.msPerMin),l=Math.floor((e-i*n.msPerHour-s*n.msPerMin)/n.msPerSec);if(i=i.toString().padStart(2,"0"),s=s.toString().padStart(2,"0"),l=l.toString().padStart(2,"0"),r.submittedTarget){let o=e/a.targetTime;1<o&&(o=1),t.textContent=`${i}:${s}:`+l+" ("+Math.trunc(100*o)+"%)"}else t.textContent=`${i}:${s}:`+l}function getTotalElapsed(o,e,t){return o.inHyperFocus?e+(Date.now()-t.local):e}function setBrowserTabTitle(){document.title=document.getElementById("display").innerText,new MutationObserver(function(){document.title=document.getElementById("display").innerText}).observe(document.getElementById("display"),{childList:!0,subtree:!0,characterData:!0})}function setFavicon(o){var e=document.getElementById("favicon1"),t=document.getElementById("favicon2");e.href=o,t.href=o}function setInitialBackgroundCellSelection(){document.getElementById(selectedBackgroundId.flowtime).classList.add("selected-background"),document.getElementById(selectedBackgroundId.chilltime).classList.add("selected-background")}function setBackground(o){document.body.style.backgroundImage=o,document.documentElement.style.backgroundImage=o}function deactivateDarkTheme(o,e,t,n,r,a,i,s,l,d,m,c){r=[r,a];[o,e,t,i,s,l].forEach(function(o){o.style.backgroundColor="rgba(0, 0, 0, 0.35)",o.style.border=null}),n.style.backgroundColor="rgba(255, 255, 255, 0.25)",n.style.border="1px rgba(0, 0, 0, 0.25)",r.forEach(function(o){o.style.backgroundColor="rgb(0, 0, 0)"}),c.style.backgroundColor="#f9f9f9",c.style.border="5px solid #cccccc","black-flowtime"===m.flowtime&&"black-chilltime"===m.chilltime&&(document.getElementById(d.flowtime).click(),document.getElementById(d.chilltime).click())}document.addEventListener("DOMContentLoaded",function(){var o=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),e=window.innerWidth||document.documentElement.clientWidth,t=[{radios:flowmodoroRadios,type:"flowmodoro"},{radios:generalRadios,type:"general"},{radios:pomodoroRadios,type:"pomodoro"}];setInitialEndSessionBtnText(e,end_session_btn),window.scrollTo({top:0,behavior:"smooth"}),setInitialBackgroundCellSelection(),activateDarkTheme(interruptionsContainer,targetHoursContainer,timekeepingContainer,progressBarContainer,popupMenu,settingsContainer,notesContainer,aboutContainer,blogContainer,blackFlowtimeBackground,blackChilltimeBackground,selectedBackgroundIdTemp,selectedBackgroundId,emojiContainer),setTimeout(()=>{hyperChillTitle.style.opacity="1",hyperChillTitle.classList.add("hyperChillTitleAnimation")},0);const n=document.getElementById("threeWayToggle");setTimeout(()=>{subMainContainer.style.opacity="1"},1e3),setTimeout(()=>{hyperChillTitle.classList.remove("hyperChillTitleAnimation"),hyperChillTitle.style.opacity="0",setTimeout(()=>{hyperChillTitle.style.display="none",n.style.display="inline-flex",n.classList.add("threeWayToggleAnimation"),setTimeout(()=>{n.style.opacity="1"},100)},1e3)},2e3),document.addEventListener("keydown",o=>handleEnter(o,start_stop_btn,submit_change_btn,createLabelInput,updateLabelInput,flags)),document.addEventListener("keyup",o=>handleKeyUp(o,flags)),start_stop_btn.addEventListener("click",function(){var o;counters.startStop++,playClick(clock_tick,flags),resetDisplay(display),1===counters.startStop?(veryStartActions(startTimes,hyperChillLogoImage,progressBarContainer,flags),startTimes.lastPomNotification=Date.now()):chillTimeToFirstPomodoro(flags,productivity_chill_mode,counters),setLocalStartTime(flags,startTimes,recoverBreakState,recoverPomState),displayWorker.postMessage("clearInterval"),displayWorker.postMessage("startInterval"),start_stop_btn.classList.remove("glowing-effect"),flags.pomodoroCountIncremented=!1,intervals.main?(flags.inHyperFocus=!1,flags.lastHyperFocusIntervalMin=Math.floor((Date.now()-startTimes.hyperFocus)/6e4),startTimes.chillTime=Date.now(),setFavicon("/images/logo/HyperChillLogoBlue.png"),chillTimeAnimationActions(flags,flowAnimation,chillAnimation),saveResetInterruptions(interruptionsNum,counters,savedInterruptionsArr),hideInterruptionsSubContainer(interruptionsSubContainer),setBackground(selectedBackground.chilltime),flags.inRecoveryBreak&&(elapsedTime.hyperFocus=recoverBreakState.hyperFocusElapsedTime),o=elapsedTime.hyperFocus,elapsedTime.hyperFocus+=Date.now()-startTimes.hyperFocus,flags.pomodoroNotificationToggle?(showPomodorosCompletedContainer(completedPomodorosContainer,completedPomodoros_label,completedPomodoros_min,counters),setHyperFocusElapsedTime(o,timeAmount,counters,flags,elapsedTime),setCurrentPomodoroNotification(counters,timeAmount),recoverToBreakUpdateProgressBarAndTotalElapsed(flags,timeAmount,startTimes,elapsedTime,progressBar,progressContainer),setPomodoroNotificationSeconds(flags,elapsedTime,counters,recoverBreakState,pomodoroWorker),setButtonTextAndMode(start_stop_btn,productivity_chill_mode,flags,"Start",setBothBreakIntervalText(counters,timeAmount))):(showSuggestionBreakContainer(suggestionBreakContainer,suggestionBreak_label,suggestionBreak_min,timeAmount,counters,flags),setButtonTextAndMode(start_stop_btn,productivity_chill_mode,flags,"Start","Chill Time")),totalTimeDisplay(startTimes,elapsedTime,total_time_display,timeConvert,flags,timeAmount),flowmodoroAndBreakSuggestionActions(flags,elapsedTime,counters,timeAmount,flowmodoroWorker,suggestionWorker),clearInterval(intervals.main),intervals.main=null,totalDisplayWorker.postMessage("clearInterval")):(flags.inHyperFocus=!0,flags.sentFlowmodoroNotification=!1,flags.inRecoveryPom||(startTimes.hyperFocus=Date.now()),totalDisplayWorker.postMessage("startInterval"),setFavicon("/images/logo/HyperChillLogoGreen.png"),flowTimeAnimationActions(counters,flags,chillAnimation,flowAnimation),hideSuggestionBreakContainer(suggestionBreakContainer,suggestionBreak_label,suggestionBreak_min),hidePomodorosCompletedContainer(completedPomodorosContainer),showInterruptionsSubContainer(interruptionsSubContainer),setCurrentPomodoroNotification(counters,timeAmount),setBackground(selectedBackground.flowtime),flowmodoroAndBreakSuggestionActions(flags,elapsedTime,counters,timeAmount,flowmodoroWorker,suggestionWorker),intervals.main=setInterval(()=>updateProgressBar(timeAmount,startTimes,elapsedTime,flags,progressBar,progressContainer),1e3),flags.pomodoroNotificationToggle?(setButtonTextAndMode(start_stop_btn,productivity_chill_mode,flags,"Stop",setPomodoroIntervalText(counters,timeAmount)),setPomodoroWorker(flags,elapsedTime,counters,recoverPomState,pomodoroWorker)):setButtonTextAndMode(start_stop_btn,productivity_chill_mode,flags,"Stop","Flow Time"),1<counters.startStop&&(elapsedTime.chillTime+=Date.now()-startTimes.chillTime)),flags.inRecoveryBreak=!1,flags.inRecoveryPom=!1,flags.sentSuggestionMinutesNotification=!1,flags.autoSwitchedModes=!1,setTimeout(()=>{flags.modeChangeExecuted=!1},1e3)}),submit_change_btn.addEventListener("click",function(){var o;flags.submittedTarget?flags.submittedTarget&&(flags.hitTarget&&progressContainer.classList.remove("glowing-effect"),changeTargetHours(flags),updateProgressBar(timeAmount,startTimes,elapsedTime,flags,progressBar,progressContainer),totalTimeDisplay(startTimes,elapsedTime,total_time_display,timeConvert,flags,timeAmount),0<counters.startStop)&&(flags.progressBarContainerIsSmall||(progressBarContainer.classList.toggle("small"),flags.progressBarContainerIsSmall=!0)):targetHoursValidate(o=document.getElementById("target-hours").value,timeConvert,startTimes,elapsedTime,flags,counters)&&(flags.hitTarget&&progressContainer.classList.remove("glowing-effect"),timeAmount.targetTime=replaceTargetHours(o,timeAmount,flags),flags.progressBarContainerIsSmall&&(progressBarContainer.classList.toggle("small"),flags.progressBarContainerIsSmall=!1),updateProgressBar(timeAmount,startTimes,elapsedTime,flags,progressBar,progressContainer),totalTimeDisplay(startTimes,elapsedTime,total_time_display,timeConvert,flags,timeAmount),flags.hitTarget=!1)}),suggestionMinutesInput.addEventListener("change",async function(){var o=suggestionMinutesInput.value,o=(timeAmount.suggestionMinutes=Math.round(parseFloat(o)),validateAndSetNotificationInput(timeAmount.suggestionMinutes));suggestionMinutesInput.value=o;let e;e=0===counters.startStop?0:Math.round((Date.now()-startTimes.hyperFocus)/1e3),flags.sentSuggestionMinutesNotification=!1,flags.breakSuggestionToggle&&(setSuggestionMinutes(startTimes,flags,elapsedTime,o,intervals,alertSounds,alertVolumes,chime,bell,start_stop_btn),60*o>e?(flags.sentSuggestionMinutesNotification=!1,start_stop_btn.classList.remove("glowing-effect")):(flags.sentSuggestionMinutesNotification=!0,start_stop_btn.classList.add("glowing-effect"))),sessionState.loggedIn&&await updateUserSettings({flowTime:{suggestionMinutes:o}})}),decBtn.addEventListener("click",function(){0<counters.interruptions&&(counters.interruptions--,interruptionsNum.textContent=counters.interruptions)}),incBtn.addEventListener("click",function(){counters.interruptions<1e3&&(counters.interruptions++,interruptionsNum.textContent=counters.interruptions)});for(const[i,s]of Object.entries(settingsMappings))document.getElementById(i).addEventListener("click",function(){hideAllSettingsContainers(settingsMappings),document.getElementById(s).style.display="block",this.classList.add("selected"),tempStorage.lastSettingsSelectionId=i});function r(o,e,t,n){o.flowmodoroNotificationToggle&&1<counters.startStop&&!o.inHyperFocus&&(60*e.breakTimeSuggestionsArr[counters.currentFlowmodoroBreakIndex]>t?(n.classList.remove("glowing-effect"),o.sentFlowmodoroNotification=!1):(n.classList.add("glowing-effect"),o.sentFlowmodoroNotification=!0))}function a(o,e,t){e<60*o?t.classList.remove("glowing-effect"):t.classList.add("glowing-effect")}o&&(document.getElementById("notificationsHeaderContainer").style.display="none",document.getElementById("pomodoroBtnContainer").style.display="none",document.getElementById("flowmodoroBtnContainer").style.display="none",document.getElementById("generalBtnContainer").style.display="none",document.getElementById("pomodoroSettingsContainer").style.display="none",document.getElementById("flowmodoroSettingsContainer").style.display="none",document.getElementById("generalSettingsContainer").style.display="none",document.getElementById("pomodoroAlertSoundBlock2").style.display="none",document.getElementById("flowmodoroAlertSoundBlock2").style.display="none",document.getElementById("generalAlertSoundBlock2").style.display="none",tempStorage.lastSettingsSelectionId="backgroundsBtnContainer"),pomodoroNotifications.addEventListener("click",function(){toggleInfoWindow(pomodoroNotificationInfoWindow,"showingPomodoroNotificationInfoWindow",flags)}),flowmodoroNotifications.addEventListener("click",function(){toggleInfoWindow(flowmodoroNotificationInfoWindow,"showingFlowmodoroNotificationInfoWindow",flags)}),flowTimeBreakNotification.addEventListener("click",function(){toggleInfoWindow(flowTimeBreakNotificationInfoWindow,"showingFlowTimeBreakNotificationInfoWindow",flags)}),notesAutoSwitch.addEventListener("click",function(){toggleInfoWindow(notesAutoSwitchInfoWindow,"showingNotesAutoSwitchInfoWindow",flags)}),flowmodoroVolumeThumb.addEventListener("mousedown",o=>{flags.flowmodoroThumbIsDragging=!0,o.preventDefault()}),generalVolumeThumb.addEventListener("mousedown",o=>{flags.generalThumbIsDragging=!0,o.preventDefault()}),pomodoroVolumeThumb.addEventListener("mousedown",o=>{flags.pomodoroThumbIsDragging=!0,o.preventDefault()}),flowmodoroVolumeThumb2.addEventListener("mousedown",o=>{flags.flowmodoroThumbIsDragging2=!0,o.preventDefault()}),generalVolumeThumb2.addEventListener("mousedown",o=>{flags.generalThumbIsDragging2=!0,o.preventDefault()}),pomodoroVolumeThumb2.addEventListener("mousedown",o=>{flags.pomodoroThumbIsDragging2=!0,o.preventDefault()}),document.addEventListener("mousemove",o=>{flags.flowmodoroThumbIsDragging?alertVolumeChange(flowmodoroVolumeContainer,alertVolumes,flowmodoroVolumeThumb,flowmodoroVolumeBar,flowmodoroVolumeThumb2,flowmodoroVolumeBar2,o,flags):flags.flowmodoroThumbIsDragging2?alertVolumeChange(flowmodoroVolumeContainer2,alertVolumes,flowmodoroVolumeThumb,flowmodoroVolumeBar,flowmodoroVolumeThumb2,flowmodoroVolumeBar2,o,flags):flags.generalThumbIsDragging?alertVolumeChange(generalVolumeContainer,alertVolumes,generalVolumeThumb,generalVolumeBar,generalVolumeThumb2,generalVolumeBar2,o,flags):flags.generalThumbIsDragging2?alertVolumeChange(generalVolumeContainer2,alertVolumes,generalVolumeThumb,generalVolumeBar,generalVolumeThumb2,generalVolumeBar2,o,flags):flags.pomodoroThumbIsDragging?alertVolumeChange(pomodoroVolumeContainer,alertVolumes,pomodoroVolumeThumb,pomodoroVolumeBar,pomodoroVolumeThumb2,pomodoroVolumeBar2,o,flags):flags.pomodoroThumbIsDragging2&&alertVolumeChange(pomodoroVolumeContainer2,alertVolumes,pomodoroVolumeThumb,pomodoroVolumeBar,pomodoroVolumeThumb2,pomodoroVolumeBar2,o,flags)}),document.addEventListener("mouseup",async o=>{flags.flowmodoroThumbIsDragging||flags.flowmodoroThumbIsDragging2?("chime"===alertSounds.flowmodoro?(pauseAndResetAlertSounds(bell,chime),playAlertSound(chime,"flowmodoro",alertVolumes)):"bell"===alertSounds.flowmodoro&&(pauseAndResetAlertSounds(bell,chime),playAlertSound(bell,"flowmodoro",alertVolumes)),flags.flowmodoroThumbIsDragging=!1,flags.flowmodoroThumbIsDragging2=!1,sessionState.loggedIn&&await updateUserSettings({chillTime:{alertVolume:alertVolumes.flowmodoro}})):flags.generalThumbIsDragging||flags.generalThumbIsDragging2?("chime"===alertSounds.general?(pauseAndResetAlertSounds(bell,chime),playAlertSound(chime,"general",alertVolumes)):"bell"===alertSounds.general&&(pauseAndResetAlertSounds(bell,chime),playAlertSound(bell,"general",alertVolumes)),flags.generalThumbIsDragging=!1,flags.generalThumbIsDragging2=!1,sessionState.loggedIn&&await updateUserSettings({flowTime:{alertVolume:alertVolumes.general}})):flags.pomodoroThumbIsDragging||flags.pomodoroThumbIsDragging2?("chime"===alertSounds.pomodoro?(pauseAndResetAlertSounds(bell,chime),playAlertSound(chime,"pomodoro",alertVolumes)):"bell"===alertSounds.pomodoro&&(pauseAndResetAlertSounds(bell,chime),playAlertSound(bell,"pomodoro",alertVolumes)),flags.pomodoroThumbIsDragging=!1,flags.pomodoroThumbIsDragging2=!1,sessionState.loggedIn&&await updateUserSettings({pomodoro:{alertVolume:alertVolumes.pomodoro}})):"flowmodoroAlert"!==o.target.className&&"generalAlert"!==o.target.className&&"pomodoroAlert"!==o.target.className&&"volume-thumb"!==o.target.className&&"block"===document.getElementById("settingsContainer").style.display&&pauseAndResetAlertSounds(bell,chime)}),flowmodoroInputs.forEach(o=>{o.addEventListener("change",function(o){var e=validateAndSetNotificationInput(Math.round(o.target.value));document.getElementById(o.target.id).value=e;let t;var n=[...timeAmount.breakTimeSuggestionsArr];setBreakTimeSuggestionsArr(o,timeAmount,e,counters,n),setCurrentFlowmodoroNotification(flags,counters,timeAmount),0===counters.startStop||flags.inHyperFocus?(elapsedTime.flowmodoroNotificationSeconds=60*counters.currentFlowmodoroNotification,t=0):(t=Math.round((Date.now()-startTimes.chillTime)/1e3),elapsedTime.flowmodoroNotificationSeconds=60*counters.currentFlowmodoroNotification-t,flowmodoroWorker.postMessage("clearInterval"),flowmodoroWorker.postMessage(elapsedTime.flowmodoroNotificationSeconds)),(0===counters.currentFlowmodoroBreakIndex&&"flowmodoroBreakInput1"===o.target.id||1===counters.currentFlowmodoroBreakIndex&&"flowmodoroBreakInput2"===o.target.id||2===counters.currentFlowmodoroBreakIndex&&"flowmodoroBreakInput3"===o.target.id||3===counters.currentFlowmodoroBreakIndex&&"flowmodoroBreakInput4"===o.target.id)&&r(flags,timeAmount,t,start_stop_btn),suggestionBreak_min.textContent=counters.currentFlowmodoroNotification+" min"})}),pomodoroInputs.forEach(o=>{o.addEventListener("change",async function(o){var e=validateAndSetNotificationInput(Math.round(o.target.value));document.getElementById(o.target.id).value=e;let t;var n=[...timeAmount.pomodoroIntervalArr];flags.inHyperFocus?(t=Math.round((Date.now()-startTimes.hyperFocus)/1e3),"pomodoroInput"===o.target.id&&(flags.modeChangeExecuted=!1,a(e,t,start_stop_btn))):(t=Math.round((Date.now()-startTimes.chillTime)/1e3),("shortBreakInput"===o.target.id&&1===counters.currentPomodoroIntervalIndex||"longBreakInput"===o.target.id&&2===counters.currentPomodoroIntervalIndex)&&(flags.modeChangeExecuted=!1,a(e,t,start_stop_btn))),setPomodoroIntervalArr(o,timeAmount,e,counters,productivity_chill_mode,flags,n),setCurrentPomodoroNotification(counters,timeAmount),0===counters.startStop?elapsedTime.pomodoroNotificationSeconds=60*counters.currentPomodoroNotification:flags.pomodoroNotificationToggle&&(elapsedTime.pomodoroNotificationSeconds=60*counters.currentPomodoroNotification-t,pomodoroWorker.postMessage("clearInterval"),pomodoroWorker.postMessage(elapsedTime.pomodoroNotificationSeconds))})}),t.forEach(e=>{e.radios.forEach(o=>{o.addEventListener("change",o=>handleRadioChange(o,e.type,soundMap,bell,chime,alertSounds,alertVolumes))})}),flowtimeBackgroundCells.forEach(o=>{o.addEventListener("click",async function(o){var e=o.target.id,t=selectedBackgroundId.flowtime;document.getElementById(t).classList.remove("selected-background"),selectedBackground.flowtime=flowtimeBackgrounds[e],selectedBackgroundId.flowtime=e,document.getElementById(o.target.id).classList.add("selected-background"),flags.inHyperFocus&&setBackground(selectedBackground.flowtime),sessionState.loggedIn&&await updateUserSettings({backgroundsThemes:{flowTimeBackground:selectedBackgroundId.flowtime}})})}),chilltimeBackgroundCells.forEach(o=>{o.addEventListener("click",async function(o){var e=o.target.id,t=selectedBackgroundId.chilltime;document.getElementById(t).classList.remove("selected-background"),selectedBackground.chilltime=chilltimeBackgrounds[e],selectedBackgroundId.chilltime=e,document.getElementById(o.target.id).classList.add("selected-background"),flags.inHyperFocus||setBackground(selectedBackground.chilltime),sessionState.loggedIn&&await updateUserSettings({backgroundsThemes:{chillTimeBackground:selectedBackgroundId.chilltime}})})}),targetTimeReachedToggle.addEventListener("click",async function(){targetTimeReachedToggle.checked?flags.targetReachedToggle=!0:flags.targetReachedToggle=!1,sessionState.loggedIn&&await updateUserSettings({flowTime:{targetTimeReachedToggle:flags.targetReachedToggle}})}),breakSuggestionToggle.addEventListener("click",async function(){breakSuggestionToggle.checked?(enableNotifications(breakSuggestionToggle,flowmodoroNotificationToggle,pomodoroNotificationToggle,flags),flags.breakSuggestionToggle=!0,flags.inHyperFocus?setButtonTextAndMode(start_stop_btn,productivity_chill_mode,flags,"Stop","Flow Time"):setButtonTextAndMode(start_stop_btn,productivity_chill_mode,flags,"Start","Chill Time"),resetPomodoroCounters(counters),pomodoroNotificationToggle.checked&&pomodoroNotificationToggle.click(),timeAmount.suggestionMinutes=suggestionMinutesInput.value,setSuggestionMinutes(startTimes,flags,elapsedTime,timeAmount,intervals,alertSounds,alertVolumes,chime,bell,start_stop_btn)):(flags.breakSuggestionToggle=!1,suggestionWorker.postMessage("clearInterval"),start_stop_btn.classList.remove("glowing-effect")),sessionState.loggedIn&&await updateUserSettings({flowTime:{notificationToggle:flags.breakSuggestionToggle}})}),flowmodoroNotificationToggle.addEventListener("click",async function(){var o;flowmodoroNotificationToggle.checked?(enableNotifications(breakSuggestionToggle,flowmodoroNotificationToggle,pomodoroNotificationToggle,flags),resetPomodoroCounters(counters),pomodoroNotificationToggle.checked&&pomodoroNotificationToggle.click(),o=Math.floor((Date.now()-startTimes.chillTime)/1e3),flags.inHyperFocus||0===counters.startStop||(elapsedTime.flowmodoroNotificationSeconds=60*counters.currentFlowmodoroNotification-o,flowmodoroWorker.postMessage("clearInterval"),flowmodoroWorker.postMessage(elapsedTime.flowmodoroNotificationSeconds)),flags.flowmodoroNotificationToggle=!0):(flags.flowmodoroNotificationToggle=!1,flowmodoroWorker.postMessage("clearInterval"),start_stop_btn.classList.remove("glowing-effect")),sessionState.loggedIn&&await updateUserSettings({chillTime:{notificationToggle:flags.flowmodoroNotificationToggle}}),changeSuggestionBreakContainerHeader(flags,suggestionBreak_label,suggestionBreak_min,counters)}),pomodoroNotificationToggle.addEventListener("click",async function(){var o,e;pomodoroNotificationToggle.checked?(enableNotifications(breakSuggestionToggle,flowmodoroNotificationToggle,pomodoroNotificationToggle,flags),resetPomodoroCounters(counters),flowmodoroNotificationToggle.checked&&flowmodoroNotificationToggle.click(),breakSuggestionToggle.checked&&breakSuggestionToggle.click(),o=Math.floor((Date.now()-startTimes.hyperFocus)/1e3),flags.inHyperFocus&&(e="Pomodoro #1 | "+timeAmount.pomodoroIntervalArr[0].toString()+" min",setButtonTextAndMode(start_stop_btn,productivity_chill_mode,flags,"Stop",e),elapsedTime.pomodoroNotificationSeconds=60*counters.currentPomodoroNotification-o,pomodoroWorker.postMessage(elapsedTime.pomodoroNotificationSeconds)),flags.pomodoroNotificationToggle=!0):(flags.pomodoroNotificationToggle=!1,pomodoroWorker.postMessage("clearInterval"),start_stop_btn.classList.remove("glowing-effect"),flags.inHyperFocus?setButtonTextAndMode(start_stop_btn,productivity_chill_mode,flags,"Stop","Flow Time"):1<counters.startStop&&(setButtonTextAndMode(start_stop_btn,productivity_chill_mode,flags,"Start","Chill Time"),hidePomodorosCompletedContainer(completedPomodorosContainer),showSuggestionBreakContainer(suggestionBreakContainer,suggestionBreak_label,suggestionBreak_min,timeAmount,counters,flags))),changeSuggestionBreakContainerHeader(flags,suggestionBreak_label,suggestionBreak_min,counters),sessionState.loggedIn&&await updateUserSettings({pomodoro:{notificationToggle:flags.pomodoroNotificationToggle}})}),autoStartPomodoroIntervalToggle.addEventListener("click",async function(){flags.autoStartPomodoroInterval?flags.autoStartPomodoroInterval&&(flags.autoStartPomodoroInterval=!1):(flags.autoStartPomodoroInterval=!0,flags.modeChangeExecuted=!1),sessionState.loggedIn&&await updateUserSettings({pomodoro:{autoStartPomToggle:flags.autoStartPomodoroInterval}})}),autoStartBreakIntervalToggle.addEventListener("click",async function(){flags.autoStartBreakInterval?flags.autoStartBreakInterval&&(flags.autoStartBreakInterval=!1):(flags.autoStartBreakInterval=!0,flags.modeChangeExecuted=!1),sessionState.loggedIn&&await updateUserSettings({pomodoro:{autoStartBreakToggle:flags.autoStartBreakInterval}})}),transitionClockSoundToggle.addEventListener("click",async function(){transitionClockSoundToggle.checked?flags.transitionClockSoundToggle=!0:flags.transitionClockSoundToggle=!1,sessionState.loggedIn&&await updateUserSettings({sounds:{transitionClockSound:flags.transitionClockSoundToggle}})}),flowTimeAnimationToggle.addEventListener("click",async function(){flowTimeAnimationToggle.checked?(flags.flowTimeAnimationToggle=!0,flags.inHyperFocus&&animationsFadeIn(flowAnimation,"block")):(flags.flowTimeAnimationToggle=!1,flags.inHyperFocus&&animationsFadeOut(flowAnimation)),sessionState.loggedIn&&await updateUserSettings({backgroundsThemes:{flowTimeAnimation:flags.flowTimeAnimationToggle}})}),chillTimeAnimationToggle.addEventListener("click",async function(){chillTimeAnimationToggle.checked?(flags.chillTimeAnimationToggle=!0,flags.inHyperFocus||animationsFadeIn(chillAnimation,"flex")):(flags.chillTimeAnimationToggle=!1,flags.inHyperFocus||animationsFadeOut(chillAnimation)),sessionState.loggedIn&&await updateUserSettings({backgroundsThemes:{chillTimeAnimation:flags.chillTimeAnimationToggle}})}),defaultThemeContainer.addEventListener("click",async function(){darkGrayTheme.classList.remove("selected-background"),defaultTheme.classList.add("selected-background"),flags.darkThemeActivated=!1,deactivateDarkTheme(interruptionsContainer,targetHoursContainer,timekeepingContainer,progressBarContainer,popupMenu,settingsContainer,notesContainer,aboutContainer,blogContainer,selectedBackgroundIdTemp,selectedBackgroundId,emojiContainer),sessionState.loggedIn&&await updateUserSettings({backgroundsThemes:{darkThemeActivated:flags.darkThemeActivated}})}),darkThemeContainer.addEventListener("click",async function(){defaultTheme.classList.remove("selected-background"),darkGrayTheme.classList.add("selected-background"),flags.darkThemeActivated=!0,activateDarkTheme(interruptionsContainer,targetHoursContainer,timekeepingContainer,progressBarContainer,popupMenu,settingsContainer,notesContainer,aboutContainer,blogContainer,blackFlowtimeBackground,blackChilltimeBackground,selectedBackgroundIdTemp,selectedBackgroundId,emojiContainer),sessionState.loggedIn&&await updateUserSettings({backgroundsThemes:{darkThemeActivated:flags.darkThemeActivated}})}),window.addEventListener("resize",function(){handleViewportWidthChange(settingsMappings,tempStorage,o)}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState?flags.inHyperFocus?(flowAnimation.classList.remove("intoOpacityTransition"),flowAnimation.style.display="none"):(chillAnimation.classList.remove("intoOpacityTransition"),chillAnimation.style.display="none"):"visible"===document.visibilityState&&(flags.inHyperFocus&&flags.flowTimeAnimationToggle?setTimeout(()=>{flowAnimation.style.display="block",flowAnimation.classList.add("intoOpacityTransition")},500):!flags.inHyperFocus&&flags.chillTimeAnimationToggle&&0<counters.startStop&&setTimeout(()=>{chillAnimation.style.display="flex",chillAnimation.classList.add("intoOpacityTransition")},500))}),settings_menu_container.addEventListener("click",function(){setTimeout(()=>{handleViewportWidthChange(settingsMappings,tempStorage,o)},0)}),registerHereText.addEventListener("click",function(){window.location.href="/signup"}),end_session_btn.addEventListener("click",function(){location.reload()}),logoutBtn.addEventListener("click",async function(){fetch("/api/state/logout",{method:"POST"}).then(()=>{sessionState.loggedIn=!1,window.location.href="/",console.log("Logged out successfully.")}).catch(o=>console.error("Logout failed",o))}),loginBtn.addEventListener("click",async function(){var o,e;o=loginEmailInput.value,e=loginPasswordInput.value,o={email:o,password:e},fetch("/api/api/validateUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then(o=>{if(o.ok)return o.json();throw alert("Your email or password is incorrect. Please try again."),new Error("HTTP error! Status: "+o.status)}).then(o=>{!0===o.loginSuccess&&(console.log("Login was successful"),initializeGUI())}).catch(o=>{console.error(o)})}),forgotPasswordSettings.addEventListener("click",function(){window.location.href="/reset-password"}),pomodoroWorker.onmessage=function(o){flags.modeChangeExecuted||(flags.modeChangeExecuted=!0,new Notification(getPomodoroNotificationString(counters,timeAmount)),playAlertSoundCountdown(chime,bell,alertSounds.pomodoro,alertVolumes.pomodoro),0!==counters.currentPomodoroIntervalIndex||flags.pomodoroCountIncremented||(counters.pomodorosCompleted++,flags.pomodoroCountIncremented=!0),startTimes.lastPomNotification=Date.now(),flags.inHyperFocus&&flags.autoStartBreakInterval||!flags.inHyperFocus&&flags.autoStartPomodoroInterval?setTimeout(()=>{flags.autoSwitchedModes=!0,start_stop_btn.click()},0):start_stop_btn.classList.add("glowing-effect"))},suggestionWorker.onmessage=function(o){flags.sentSuggestionMinutesNotification||(sendSuggestionBreakNotification(timeAmount,startTimes,chime,bell,alertSounds,alertVolumes),flags.sentSuggestionMinutesNotification=!0,start_stop_btn.classList.add("glowing-effect"))},flowmodoroWorker.onmessage=function(o){flags.sentFlowmodoroNotification||(sendFlowmodoroNotification(timeAmount,counters,startTimes,chime,bell,alertSounds,alertVolumes),flags.sentFlowmodoroNotification=!0,start_stop_btn.classList.add("glowing-effect"))},displayWorker.onmessage=function(o){var e=Date.now()-startTimes.local;let t=Math.floor(e/timeConvert.msPerHour),n=Math.floor((e-t*timeConvert.msPerHour)/timeConvert.msPerMin),r=Math.floor((e-t*timeConvert.msPerHour-n*timeConvert.msPerMin)/timeConvert.msPerSec);t=t.toString().padStart(2,"0"),n=n.toString().padStart(2,"0"),r=r.toString().padStart(2,"0"),display.textContent=`${t}:${n}:`+r,timeRecovery(flags,counters,startTimes,elapsedTime,start_stop_btn,recoverPomState,recoverBreakState,timeAmount,total_time_display,timeConvert,progressBar,progressContainer,chime,bell,alertSounds,alertVolumes,completedPomodoros_label,completedPomodoros_min,flowmodoroWorker,suggestionWorker)},totalDisplayWorker.onmessage=function(o){totalTimeDisplay(startTimes,elapsedTime,total_time_display,timeConvert,flags,timeAmount)},document.dispatchEvent(new Event("defaultSettingsApplied"))});export{setInitialBackgroundCellSelection,setBackground,deactivateDarkTheme};