import{tempStorage as s,charts as u}from"../modules/summary-stats.js";function getFocusQuality(e){return Math.floor(100*e)}function b(e){return e/36e5}function m(e){let t;return t=null!==e?e/36e5:0}function g(e,t,r,a,o){let n;r+="%";n=a?o+"s":e+`h ${t}m`,document.getElementById("deepWorkTime").innerHTML=`<b>${n}</b>`,document.getElementById("focusPercentage").innerHTML=`<b>${r}</b>`}document.addEventListener("triggerSessionSummaryChartAnimation",function(){var e=document.getElementById("sessionSummaryChart").getContext("2d");let t=getFocusQuality(s.focusQuality);var r=100-t;let a=b(s.deepWork),o=m(s.targetHours)-a,n=(o<0&&(o=0),Math.floor(a)),l=Math.floor(60*(a-n)),d=!1,i;s.deepWork<6e4&&(d=!0,i=Math.floor(s.deepWork/1e3)),g(n,l,t,d,i),0===a&&(a=1e-16);r={type:"doughnut",data:{datasets:[{label:"Focus Quality",data:[t,r],backgroundColor:["rgba(59, 143, 227, 1)","rgba(59, 143, 227, 0.15)"],borderColor:["rgba(255, 255, 255, 1)","rgba(255, 255, 255, 1)"],borderWidth:0},{label:"Deep Work",data:[a,o],backgroundColor:["rgba(83, 230, 88, 1)","rgba(83, 230, 88, 0.15)"],borderColor:["rgba(255, 255, 255, 1)","rgba(255, 255, 255, 1)"],borderWidth:0}]},options:{responsive:!0,animation:{duration:2e3,animateRotate:!0,animateScale:!0},plugins:{legend:{display:!1,position:"bottom",labels:{boxWidth:25,padding:25,usePointStyle:!0,textAlign:"center",generateLabels:function(r){return r.data.datasets.map((e,t)=>({text:e.label,fillStyle:e.backgroundColor[0],hidden:!r.isDatasetVisible(t),lineCap:e.borderCapStyle,lineDash:e.borderDash,lineDashOffset:e.borderDashOffset,lineJoin:e.borderJoinStyle,strokeStyle:e.borderColor[0],pointStyle:e.pointStyle,datasetIndex:t}))}}},tooltip:{filter:function(e){return 0===e.dataIndex},callbacks:{label:function(e){return 0===e.datasetIndex?" Focus Quality: "+t+"%":1===e.datasetIndex?d?" Deep Work: "+i+"s":" Deep Work: "+n+"h "+l+"m":""}}}}}};u.summary&&(u.summary.destroy(),u.summary=null),u.summary=new Chart(e,r)});export{getFocusQuality};