import{dailyDay as n,dailyDate as a,rightDailyArrow as r,rightDailyArrowGray as s,leftDailyArrow as e,miniChartLabels as i,miniChartContainers as j,dailyBlocks as t,calendarIconContainer as o,calendarPopup as l,monthSelection as d,yearSelection as c,calendarHeaderCells as u,leftCalendarArrow as y,rightCalendarArrow as m,rightCalendarArrowGray as f,calendarBody as h,todayBtn as p}from"../modules/dashboard-elements.js";import{dailyContainer as v,general as D,flags as Y,calendarContainer as w}from"../modules/dashboard-objects.js";import{tempCounters as g}from"../modules/index-objects.js";import{sessionState as E}from"../modules/state-objects.js";import{setBounds as C,alterBounds as M,setRightArrowType as O}from"./label-distribution.js";function checkViewportWidth(){865<=window.innerWidth&&window.innerWidth<=1050?(n.style.fontSize="22px",a.style.fontSize="14px",d.style.fontSize="12px",c.style.fontSize="12px",d.style.width="90px",c.style.width="65px",u.forEach(e=>{e.style.fontSize="14px"})):(n.style.fontSize="24px",a.style.fontSize="16px",d.style.fontSize="14px",c.style.fontSize="14px",d.style.width="100px",c.style.width="70px",u.forEach(e=>{e.style.fontSize="16px"}))}function setDailyContainer(){}function W(){var[e,t,n]=v.selectedDate.split("-").map(Number);return new Date(e,t-1,n).getDay()}function F(){var e=moment(v.selectedDate,"YYYY-MM-DD"),t=moment(D.currentDay,"YYYY-MM-DD"),n=e.clone().startOf(v.timeFrame).format("YYYY-MM-DD"),e=e.clone().endOf(v.timeFrame).format("YYYY-MM-DD");v.lowerBound=n,v.upperBound=e,O(v,t,r,s)}function P(e,t,n){return e+`-${t=L(t)?x(t,0):t}-`+(n=L(n)?x(n,0):n)}function x(e,t){return t.toString()+e.toString()}function L(e){return-9<=e&&e<=9}function S(e){var t=z(D.currentDay),n=t.year;"monthChange"===e?(w.month=parseInt(d.value),k(n),b(n)):"yearChange"===e?(parseInt(c.value)>n?c.value=n:parseInt(c.value)<1e3&&(c.value=1e3),w.year=parseInt(c.value),k(n),b(n)):"shiftDown"===e?(1===w.month?(w.month=12,w.year--):w.month--,d.value=w.month,c.value=w.year,k(n)):"shiftUp"===e&&(12===w.month&&w.year<n?(w.month=1,w.year++):w.month++,d.value=w.month,c.value=w.year,b(n)),I(t)}function I(t){var n=w.month,a=w.year,r=U(n,a),s=J(n,a),i=document.querySelectorAll(".calendarCell"),e=z(v.selectedDate),o=e.month,l=e.year,d=e.day;w.selectedCellId=null;let c=0;for(let e=0;e<i.length;e++)i[e].classList="no-select calendarCell",i[e].textContent="",n===o&&a===l&&c+1===d&&(i[e].classList.add("selectedDay"),w.selectedCellId=i[e].id),e<s||c>=r.length?i[e].classList.add("invisible"):(a===t.year&&(n===t.month?c+1===t.day?i[e].classList.add("currentDay"):c+1>t.day&&i[e].classList.add("unselectable"):n>t.month&&i[e].classList.add("unselectable")),i[e].textContent=r[c],c++)}function J(e,t){return new Date(t,e-1,1).getDay()}function U(e,t){var n=new Date(t,e,0).getDate(),a=[];for(let e=1;e<=n;e++)a.push(e);return a}function k(e){(w.month<12||w.year<e)&&(m.style.display="flex",f.style.display="none")}function b(e){12===w.month&&w.year===e&&(m.style.display="none",f.style.display="flex")}function B(e){v.selectedDate=v.weeklyDatesArr[e];e=G();n.innerText=e.dayOfWeek,a.innerText=e.monthDayYear}function G(){var e=v.selectedDate,e=moment(e,"YYYY-MM-DD");return{dayOfWeek:e.format("dddd"),monthDayYear:e.format("MMMM D, YYYY")}}function A(){var t=N();for(let e=0;e<7;e++)i[e].textContent=t[e]}function N(){var e=moment(D.currentDay,"YYYY-MM-DD"),t=moment(v.upperBound,"YYYY-MM-DD"),n=moment(v.lowerBound,"YYYY-MM-DD");let a=[];for(var r=[],s=[];n.isSameOrBefore(t);){var i=n.format("YYYY-MM-DD");s.push(i),r.push($(i)),n.add(1,"days")}return v.weeklyDatesArr=s,a=e.isSameOrBefore(t)?["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]:r}function $(e){var[,e,t]=e.split("-");return parseInt(e)+"/"+parseInt(t)}async function T(){var e=new Date,t=(v.selectedDate=D.currentDay,z(D.currentDay)),t=(w.month=t.month,w.year=t.year,c.value=w.year,c.max=w.year,d.value=w.month,I(t),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()]),e=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]+` ${e.getDate()}, `+e.getFullYear();n.innerText=t,a.innerText=e,await C(v,null,r,s),A(),document.dispatchEvent(new Event("displayMiniCharts"))}function z(e){var[e,t,n]=e.split("-");return{month:parseInt(t),year:parseInt(e),day:parseInt(n)}}document.addEventListener("DOMContentLoaded",function(){window.addEventListener("resize",checkViewportWidth)}),document.addEventListener("stateUpdated",function(){T(),E.loggedIn&&(e.addEventListener("click",function(){M("shiftdown",v,null,r,s),A(),document.dispatchEvent(new Event("displayMiniCharts"))}),r.addEventListener("click",function(){M("shiftup",v,null,r,s),A(),document.dispatchEvent(new Event("displayMiniCharts"))}),t[0].addEventListener("click",function(){B(0)}),t[1].addEventListener("click",function(){B(1)}),t[2].addEventListener("click",function(){B(2)}),t[3].addEventListener("click",function(){B(3)}),t[4].addEventListener("click",function(){B(4)}),t[5].addEventListener("click",function(){B(5)}),t[6].addEventListener("click",function(){B(6)}),o.addEventListener("click",function(){var e=window.innerWidth||document.documentElement.clientWidth;Y.calendarPopupShowing?(Y.calendarPopupShowing=!1,l.style.opacity="0",l.style.transform="scale(0.90)",setTimeout(()=>{l.style.display="none"},150),5===g.dashboardCatIdsArrIndex&&(document.getElementById("dashboardCat6").style.display="flex")):(Y.calendarPopupShowing=!0,l.style.display="flex",setTimeout(()=>{l.style.opacity="1",l.style.transform="scale(1)"},0),e<=670&&(document.getElementById("dashboardCat6").style.display="none"))}),d.addEventListener("change",function(){S("monthChange")}),c.addEventListener("change",function(){S("yearChange")}),y.addEventListener("click",function(){S("shiftDown")}),m.addEventListener("click",function(){S("shiftUp")}),h.addEventListener("click",function(e){var t=e.target.classList.value,e=e.target.id,n=w.selectedCellId;"no-select calendarCell"!==t&&"no-select calendarCell currentDay"!==t||(n&&n!==e&&document.getElementById(n).classList.remove("selectedDay"),document.getElementById(e).classList.add("selectedDay"),w.selectedCellId=e,t=document.getElementById(e).innerText,v.selectedDate=P(w.year,w.month,t),F(),n=W(),A(),B(n),document.dispatchEvent(new Event("displayMiniCharts")),o.click())}),p.addEventListener("click",function(){T(),o.click()}))});export{checkViewportWidth,setDailyContainer};